<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lincity-ng-commit] r1140 - in trunk: . data/gui data/images/gui	src/lincity-ng
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/lincity-ng-commit/2007-February/index.html" >
   <LINK REL="made" HREF="mailto:lincity-ng-commit%40lists.berlios.de?Subject=Re%3A%20%5BLincity-ng-commit%5D%20r1140%20-%20in%20trunk%3A%20.%20data/gui%20data/images/gui%0A%09src/lincity-ng&In-Reply-To=%3C200702232039.l1NKdowL022398%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000068.html">
   <LINK REL="Next"  HREF="000070.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lincity-ng-commit] r1140 - in trunk: . data/gui data/images/gui	src/lincity-ng</H1>
    <B>wolfgangb at BerliOS</B> 
    <A HREF="mailto:lincity-ng-commit%40lists.berlios.de?Subject=Re%3A%20%5BLincity-ng-commit%5D%20r1140%20-%20in%20trunk%3A%20.%20data/gui%20data/images/gui%0A%09src/lincity-ng&In-Reply-To=%3C200702232039.l1NKdowL022398%40sheep.berlios.de%3E"
       TITLE="[Lincity-ng-commit] r1140 - in trunk: . data/gui data/images/gui	src/lincity-ng">wolfgangb at mail.berlios.de
       </A><BR>
    <I>Fri Feb 23 21:39:50 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000068.html">[Lincity-ng-commit] r1139 - in trunk: . data/help/de
</A></li>
        <LI>Next message: <A HREF="000070.html">[Lincity-ng-commit] r1141 - in trunk: . src/lincity/modules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69">[ date ]</a>
              <a href="thread.html#69">[ thread ]</a>
              <a href="subject.html#69">[ subject ]</a>
              <a href="author.html#69">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: wolfgangb
Date: 2007-02-23 21:39:49 +0100 (Fri, 23 Feb 2007)
New Revision: 1140

Added:
   trunk/data/images/gui/back.png
Modified:
   trunk/RELNOTES
   trunk/configure.ac
   trunk/data/gui/helpwindow.xml
   trunk/src/lincity-ng/HelpWindow.cpp
   trunk/src/lincity-ng/HelpWindow.hpp
Log:
History for help window.


Modified: trunk/RELNOTES
===================================================================
--- trunk/RELNOTES	2007-02-19 20:48:20 UTC (rev 1139)
+++ trunk/RELNOTES	2007-02-23 20:39:49 UTC (rev 1140)
@@ -1,5 +1,9 @@
-*** LincityNG 1.1.0 *** [1139 in svn]
+*** LincityNG 1.1.1 ***
 
+* History in online help
+
+*** LincityNG 1.1.0 *** [r1139 in svn]
+
 * Display correct values for unemployment rate.
 * Port connects on all land parts.
 * Change background music in menu.

Modified: trunk/configure.ac
===================================================================
--- trunk/configure.ac	2007-02-19 20:48:20 UTC (rev 1139)
+++ trunk/configure.ac	2007-02-23 20:39:49 UTC (rev 1140)
@@ -4,7 +4,7 @@
 #----------------------------------------------------------------------------
 AC_PREREQ([2.54])
 
-AC_INIT([lincity-ng], [1.1.0], [<A HREF="https://lists.berlios.de/mailman/listinfo/lincity-ng-commit">matze at braunis.de</A>])
+AC_INIT([lincity-ng], [1.1.1pre], [<A HREF="https://lists.berlios.de/mailman/listinfo/lincity-ng-commit">matze at braunis.de</A>])
 AC_CONFIG_SRCDIR([mk/jam/build.jam])
 AC_CONFIG_AUX_DIR([mk/autoconf])
 

Modified: trunk/data/gui/helpwindow.xml
===================================================================
--- trunk/data/gui/helpwindow.xml	2007-02-19 20:48:20 UTC (rev 1139)
+++ trunk/data/gui/helpwindow.xml	2007-02-23 20:39:49 UTC (rev 1140)
@@ -1,8 +1,21 @@
 &lt;?xml version=&quot;1.0&quot;?&gt;
 &lt;Window width=&quot;500&quot; height=&quot;400&quot; border=&quot;5&quot; titlesize=&quot;30&quot; name=&quot;HelpWindow&quot;&gt;
 	&lt;title&gt;
-		&lt;Paragraph halign=&quot;center&quot; color=&quot;white&quot; name=&quot;HelpWindowTitle&quot;
-		height=&quot;30&quot; font-size=&quot;20&quot;&gt;Help&lt;/Paragraph&gt;
+        &lt;TableLayout rows=&quot;1&quot; cols=&quot;2&quot;&gt;
+            &lt;colsize col=&quot;1&quot; fixed=&quot;25&quot;/&gt;
+            &lt;cell row=&quot;1&quot; col=&quot;1&quot;  halign=&quot;right&quot;&gt;
+                &lt;Button name=&quot;HistoryBack&quot;&gt;
+		    		&lt;image src=&quot;images/gui/buttons/round/button-round-20.png&quot;/&gt;
+	    			&lt;image-hover src=&quot;images/gui/buttons/round/button-round-hover-20.png&quot;/&gt;
+    				&lt;image-clicked src=&quot;images/gui/buttons/round/button-round-checked-20.png&quot;/&gt;
+				    &lt;image-caption src=&quot;images/gui/back.png&quot;/&gt;
+                &lt;/Button&gt;
+            &lt;/cell&gt;
+            &lt;cell row=&quot;1&quot; col=&quot;2&quot;&gt;
+		        &lt;Paragraph halign=&quot;center&quot; color=&quot;white&quot; name=&quot;HelpWindowTitle&quot;
+    		    height=&quot;30&quot; font-size=&quot;20&quot;&gt;Help&lt;/Paragraph&gt;
+            &lt;/cell&gt;
+        &lt;/TableLayout&gt;
 	&lt;/title&gt;
 	&lt;title-background&gt;
 		&lt;Gradient from=&quot;#ff0000ff&quot; to=&quot;#88776655&quot; direction=&quot;left-right&quot;/&gt;

Added: trunk/data/images/gui/back.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/gui/back.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/src/lincity-ng/HelpWindow.cpp
===================================================================
--- trunk/src/lincity-ng/HelpWindow.cpp	2007-02-19 20:48:20 UTC (rev 1139)
+++ trunk/src/lincity-ng/HelpWindow.cpp	2007-02-23 20:39:49 UTC (rev 1140)
@@ -31,6 +31,7 @@
 #include &quot;gui/Desktop.hpp&quot;
 #include &quot;gui/ComponentLoader.hpp&quot;
 #include &quot;gui/callback/Callback.hpp&quot;
+#include &quot;Util.hpp&quot;
 
 HelpWindow::HelpWindow(Desktop* desktop)
 {
@@ -57,6 +58,10 @@
         if(helpWindow == 0) {
             helpWindow = loadGUIFile(&quot;gui/helpwindow.xml&quot;);
             desktop-&gt;addChildComponent(helpWindow);
+            // connect history back button
+            historyBackButton = getButton(*helpWindow, &quot;HistoryBack&quot;);
+            historyBackButton-&gt;clicked.connect(
+                makeCallback(*this, &amp;HelpWindow::historyBackClicked));
         }
         // load new contents
         std::string filename = getHelpFile(topic);
@@ -76,6 +81,7 @@
         if(scrollView == 0)
             throw std::runtime_error(&quot;HelpScrollView is not a ScrollView&quot;);
         scrollView-&gt;replaceContents(contents.release());
+        topicHistory.push(topic);
     } catch(std::exception&amp; e) {
         std::cerr &lt;&lt; &quot;Couldn't open HelpWindow: &quot;
             &lt;&lt; e.what() &lt;&lt; &quot;\n&quot;;
@@ -111,3 +117,13 @@
 {
     nextTopic = href;
 }
+
+void
+HelpWindow::historyBackClicked(Button*)
+{
+    if(topicHistory.size() &gt; 1) {
+        topicHistory.pop(); //the current page is on the top, remove it.
+        nextTopic = topicHistory.top();
+        topicHistory.pop();
+    }
+}

Modified: trunk/src/lincity-ng/HelpWindow.hpp
===================================================================
--- trunk/src/lincity-ng/HelpWindow.hpp	2007-02-19 20:48:20 UTC (rev 1139)
+++ trunk/src/lincity-ng/HelpWindow.hpp	2007-02-23 20:39:49 UTC (rev 1140)
@@ -19,6 +19,8 @@
 #define __HELPWINDOW_HPP__
 
 #include &lt;string&gt;
+#include &lt;stack&gt;
+#include &quot;gui/Button.hpp&quot;
 
 class Desktop;
 class Paragraph;
@@ -34,10 +36,13 @@
 
 private:
     void linkClicked(Paragraph* paragraph, const std::string&amp; href);
+    void historyBackClicked(Button*);
     std::string getHelpFile(const std::string&amp; topic);
 
     Desktop* desktop;
     std::string nextTopic;
+    std::stack&lt;std::string&gt; topicHistory;
+    Button* historyBackButton;
 };
 
 #endif


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000068.html">[Lincity-ng-commit] r1139 - in trunk: . data/help/de
</A></li>
	<LI>Next message: <A HREF="000070.html">[Lincity-ng-commit] r1141 - in trunk: . src/lincity/modules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69">[ date ]</a>
              <a href="thread.html#69">[ thread ]</a>
              <a href="subject.html#69">[ subject ]</a>
              <a href="author.html#69">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/lincity-ng-commit">More information about the Lincity-ng-commit
mailing list</a><br>
</body></html>
