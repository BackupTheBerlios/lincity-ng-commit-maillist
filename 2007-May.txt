From alainb at mail.berlios.de  Tue May  1 11:28:52 2007
From: alainb at mail.berlios.de (alainb at BerliOS)
Date: Tue, 1 May 2007 11:28:52 +0200
Subject: [Lincity-ng-commit] r1210 - in trunk: data/messages src/lincity
	src/lincity-ng
Message-ID: <200705010928.l419Sq8u015446@sheep.berlios.de>

Author: alainb
Date: 2007-05-01 11:28:52 +0200 (Tue, 01 May 2007)
New Revision: 1210

Added:
   trunk/data/messages/warning.mes
Modified:
   trunk/src/lincity-ng/MapEdit.cpp
   trunk/src/lincity-ng/ScreenInterface.cpp
   trunk/src/lincity/engine.cpp
Log:
removed the rare dialog_box from NG, and instead use ok_dial_box.

Added: trunk/data/messages/warning.mes
===================================================================
--- trunk/data/messages/warning.mes	2007-04-30 17:47:10 UTC (rev 1209)
+++ trunk/data/messages/warning.mes	2007-05-01 09:28:52 UTC (rev 1210)
@@ -0,0 +1,2 @@
+Warning
+

Modified: trunk/src/lincity/engine.cpp
===================================================================
--- trunk/src/lincity/engine.cpp	2007-04-30 17:47:10 UTC (rev 1209)
+++ trunk/src/lincity/engine.cpp	2007-05-01 09:28:52 UTC (rev 1210)
@@ -27,7 +27,10 @@
 
 extern int selected_type_cost;
 static void bulldoze_mappoint (short fill, int x, int y);
+int is_real_river (int x, int y);
 
+int last_warning_message_group = 0;
+
 void
 fire_area (int x, int y)
 {
@@ -50,8 +53,6 @@
     return total_money;
 }
 
-int is_real_river (int x, int y);
-
 int
 no_credit_build (int selected_group)
 {
@@ -90,26 +91,69 @@
   return (0);
 }
 
+void 
+no_credit_build_msg_ng (int selected_group)
+{
+  if (last_warning_message_group == selected_group)
+        return;
+  last_warning_message_group = selected_group;
+
+#ifdef GROUP_SOLAR_POWER_NO_CREDIT
+  if (selected_group == GROUP_SOLAR_POWER) {
+    ok_dial_box ("no-credit-solar-power.mes", BAD, 0L);
+    return;
+  }
+#endif
+#ifdef GROUP_UNIVERSITY_NO_CREDIT
+  if (selected_group == GROUP_UNIVERSITY) {
+    ok_dial_box ("no-credit-university.mes", BAD, 0L);
+    return;
+  }
+#endif
+#ifdef GROUP_PARKLAND_NO_CREDIT
+  if (selected_group == GROUP_PARKLAND) {
+    ok_dial_box ("no-credit-parkland.mes", BAD, 0L);
+    return;
+  }
+#endif
+#ifdef GROUP_RECYCLE_NO_CREDIT
+  if (selected_group == GROUP_RECYCLE) {
+    ok_dial_box ("no-credit-recycle.mes", BAD, 0L);
+    return;
+  }
+#endif
+#ifdef GROUP_ROCKET
+  if (selected_group == GROUP_ROCKET) {
+    ok_dial_box ("no-credit-rocket.mes", BAD, 0L);
+    return;
+  }
+#endif
+  return;
+}
+
 int 
 place_item (int x, int y, short type)
 {
-#ifdef DEBUG
-/* Al1: my ugly workaround. Debug should not be the same as oldgui */
-#define OLDGUI
-#endif
-
     int i,j;
     int prev_tip = 0;
     int group;
     int size;
 
     group = get_group_of_type(type);
-    if (group < 0) return -1;
+    if (group < 0) {
+#ifdef DEBUG
+        fprintf(stderr,"Error: group does not exist %i\n", group);
+#endif
+        ok_dial_box ("warning.mes", BAD,
+                _("ERROR: group does not exist. This should not happen! Please consider filling a bug report to lincity-ng team, with the saved game and what you did :-) "));
+        return -1000;
+    }
 
     size = main_groups[group].size;
 
     /* You can't build because credit not available. */
     if (no_credit_build (group) != 0) {
+        no_credit_build_msg_ng (group);
 	return -1;
     }
 
@@ -124,23 +168,24 @@
         break;
     case GROUP_PORT:
 	if (is_real_river (x + 4, y) != 1 
-	    || is_real_river (x + 4, y + 1) != 1
-	    || is_real_river (x + 4, y + 2) != 1 
-	    || is_real_river (x + 4, y + 3) != 1) {
-	    return -2;
-	}
+	        || is_real_river (x + 4, y + 1) != 1
+	        || is_real_river (x + 4, y + 2) != 1 
+	        || is_real_river (x + 4, y + 3) != 1) {
+            if (last_warning_message_group != group)
+                ok_dial_box ("warning.mes", BAD,
+                    _("Port must be connected to river all along right side."));
+            last_warning_message_group = group;
+            return -2;
+        }
         break;
     case GROUP_SUBSTATION:
     case GROUP_WINDMILL:
 	if (add_a_substation (x, y) == 0) {
             /* Not enough slots in the substation array */
-#ifdef OLDGUI
-            dialog_box(red(12),3,
-		       0,0,_("Too many windmills + substations"),
-		       0,0,_("You cannot build one more"),
-		       2,' ',_("OK"));
-#endif
-            /* FIXME launch a message. dialog_box is broken in NG-1.1*/
+            if (last_warning_message_group != group)
+                ok_dial_box ("warning.mes", BAD,
+                    _("Too many substations + windmills. You cannot build one more"));
+            last_warning_message_group = group;
 	    return -3;
         }
         MP_INFO(x,y).int_2 = tech_level;
@@ -170,13 +215,10 @@
     case GROUP_MARKET:
 	/* Test for enough slots in the market array */
 	if (add_a_market (x, y) == 0) {
-#ifdef OLDGUI
-            dialog_box(red(12),3,
-		       0,0,_("Too many markets"),
-		       0,0,_("You cannot build one more"),
-		       2,' ',_("OK"));
-#endif
-            /* FIXME launch a message. dialog_box is broken in NG-1.1*/
+            if (last_warning_message_group != group)
+                ok_dial_box ("warning.mes", BAD,
+                        _("Too many markets. You cannot build one more"));
+            last_warning_message_group = group;
 	    return -4;
         }
 	MP_INFO(x,y).flags += (FLAG_MB_FOOD | FLAG_MB_JOBS
@@ -199,13 +241,8 @@
 		    break;
 		}
 	if (prev_tip) {
-#ifdef OLDGUI
-	    dialog_box(red(12),3,
-		       0,0,_("You can't build a tip here"),
-		       0,0,_("This area was once a landfill"),
-		       2,' ',_("OK"));
-#endif
-            /* FIXME launch a message. dialog_box is broken in NG-1.1*/
+	    ok_dial_box ("warning.mes", BAD,
+                    _("You can't build a tip here: this area was once a landfill"));
 	    return -5;
 	} else {
 	    for (i=0; i < size; i++)
@@ -229,26 +266,17 @@
 	    }
 	}
 	if (prev_tip) {
-#ifdef OLDGUI
-	    dialog_box(red(12),3,
-		       0,0,_("You can't build a mine here"),
-		       0,0,_("This area was once a landfill"),
-		       2,' ',_("OK"));
-#endif
-            /* FIXME launch a message. dialog_box is broken in NG-1.1*/
+	    ok_dial_box ("warning.mes", BAD,
+                    _("You can't build a mine here: This area was once a landfill"));
 	    return -6;
 	}
 	if (total_ore < MIN_ORE_RESERVE_FOR_MINE) {
-#ifdef OLDGUI
-	    dialog_box(red(12),3,
-		       0,0,_("You can't build a mine here"),
-		       0,0,_("There is no ore left at this site"),
-		       2,' ',_("OK"));
-#endif
-            /* FIXME launch a message. dialog_box is broken in NG-1.1*/
+	    ok_dial_box("warning.mes", BAD,
+                    _("You can't build a mine here: there is no ore left at this site"));
 	    return -7;
 	}
     } /* end case */
+    last_warning_message_group = 0;
 
     /* Store last_built for refund on "mistakes" */
     last_built_x = x;

Modified: trunk/src/lincity-ng/MapEdit.cpp
===================================================================
--- trunk/src/lincity-ng/MapEdit.cpp	2007-04-30 17:47:10 UTC (rev 1209)
+++ trunk/src/lincity-ng/MapEdit.cpp	2007-05-01 09:28:52 UTC (rev 1210)
@@ -56,46 +56,6 @@
     new Dialog( EDIT_MARKET, x, y );
 }
 
-void 
-no_credit_build_msg (int selected_group)
-{
-    if( last_message_group == selected_group ){
-        return;
-    }
-    last_message_group = selected_group;
-#ifdef GROUP_SOLAR_POWER_NO_CREDIT
-  if (selected_group == GROUP_SOLAR_POWER) {
-    ok_dial_box ("no-credit-solar-power.mes", BAD, 0L);
-    return;
-  }
-#endif
-#ifdef GROUP_UNIVERSITY_NO_CREDIT
-  if (selected_group == GROUP_UNIVERSITY) {
-    ok_dial_box ("no-credit-university.mes", BAD, 0L);
-    return;
-  }
-#endif
-#ifdef GROUP_PARKLAND_NO_CREDIT
-  if (selected_group == GROUP_PARKLAND) {
-    ok_dial_box ("no-credit-parkland.mes", BAD, 0L);
-    return;
-  }
-#endif
-#ifdef GROUP_RECYCLE_NO_CREDIT
-  if (selected_group == GROUP_RECYCLE) {
-    ok_dial_box ("no-credit-recycle.mes", BAD, 0L);
-    return;
-  }
-#endif
-#ifdef GROUP_ROCKET
-  if (selected_group == GROUP_ROCKET) {
-    ok_dial_box ("no-credit-rocket.mes", BAD, 0L);
-    return;
-  }
-#endif
-  return;
-}
-
 void
 check_bulldoze_area (int x, int y)
 {
@@ -295,25 +255,20 @@
             selected_module_type = CST_PARKLAND_PLANE;
     }
 
-    /* Place the selected item */
-    switch (place_item (x, y, selected_module_type))
+    /* Place the selected item . Warning messages are managed by place_item(...) */
+    last_message_group = place_item (x, y, selected_module_type);
+    switch (last_message_group)
     {
         case 0:
             /* Success */
             getSound()->playSound( "Build" );
-            last_message_group = 0;
             break;
+        case -1000:
+            /* ouch group does not exist */
         case -1:
             /* Not enough money */
-            no_credit_build_msg (selected_module_group);
-            break;
         case -2:
             /* Improper port placement */
-            // WolfgangB: The correct placement for the port (river to the east)
-            // is shown by red/blue cursor in GameView. So we don't need    
-            // a dialog here.
-            last_message_group = 0;
-            break;
         case -3:
             /* too many windmills/substations */
         case -4:
@@ -324,10 +279,8 @@
             /* previous tip here, cannot build oremine */
         case -7:
             /* no ore reserve. cannot build oremine here */
-            /* FIXME messages are supposed to be launched by place_item 
-             * FIXME but dialog_box is broken with NG 1.1
-             * FIXME no message appears 
-             */
-            ;
+        default:
+            /* warning messages are managed by place item */
+            last_message_group = 0;
     }
 }

Modified: trunk/src/lincity-ng/ScreenInterface.cpp
===================================================================
--- trunk/src/lincity-ng/ScreenInterface.cpp	2007-04-30 17:47:10 UTC (rev 1209)
+++ trunk/src/lincity-ng/ScreenInterface.cpp	2007-05-01 09:28:52 UTC (rev 1210)
@@ -149,15 +149,18 @@
  * 
  * see oldgui/screen.cpp: ok_dial_box (char *fn, int good_bad, char *xs)
  *
- * good_bad influences the color: GOOD, RESULTS in green
+ * in oldgui good_bad influences the color:
+ *                                GOOD, RESULTS in green
  *                                BAD in red
  *                                default white
+ * in NG good_bad is reseted to void !!!
+ *
  * fn is the FileName of the message
  *   if good_bad is RESULTS the fn is an absolute filename else
  *   it is a File in message_path.                              
  * 
  * xs is some additional Text, that is shown after the Message
- *    from the File. (maybe XtraString?)  
+ *    from the File. ( XtraString )  
  */
 void ok_dial_box (const char *fn, int good_bad, const char *xs)
 {
@@ -167,7 +170,7 @@
     } catch(std::exception& e) {
         std::cerr << "Problem with ok_dial_box: " << e.what() << "\n";
         std::ostringstream text;
-        text << "ok_dial_box:'" << fn << "' + \"" << (xs ? xs : "") << "\"\n";
+        text << "Problem with ok_dial_box: '" << fn << "' + \"" << (xs ? xs : "") << "\"\n";
         updateMessageText( text.str() );
     }
 }
@@ -285,50 +288,6 @@
 }
 
 /*
- *  Draw a Dialogbox, in oldgui/screen.cpp it is called from the 
- *  other Dialog Functions to do the actual drawing.
- *  TODO: at the moment we just dump the Text in the MessageArea...
- *
- *  see oldgui/dialbox.cpp 
- *  -there must be just one DialogBox at a time.
- *  colour is the color of the Background of the Dialog
- *
- *  Do we use dialog_box at all? Unfortunately yes. There is a lot of legacy code...
- *  Al1: in NG 1.1 only used in engine.cpp for 5 messages, and it is broken ;-)
- *  
- *  argc is the number of following argument triplets.
- *  Each triplet consists of
- *      type, key, string
- *      type is an integer that describes this entry
- *          0 = it is a text to display
- *          2 = a button 
- *      key 
- *        a char as hotkey for the button
- *        10 (LF), 13(CR) or ' '(blank)
- *        are used to mark the default button
- *        also key is returned as result of the Dialog if the corespondending Button is pressed.
- *           
- *      string is the text
- */
-
-int dialog_box(int colour, int argc, ...)
-{
-    (void) colour;
-
-    std::ostringstream text;
-    va_list arg;
-    va_start( arg, argc );
-     for( int i = 0; i < argc; i++ ) {
-        text << std::cout <<  va_arg( arg, int ) << " '"<<  va_arg( arg, int )  << "' " << va_arg( arg, char* ) <<"\n";
-     }
-    va_end( arg );    
-    
-    updateMessageText(  text.str() );
-    
-    return 0;
-}
-
-/*
  *  A DialogBox with a Progressbar.
  *  see oldgui/screen.cpp: prog_box (char *title, int percent)
  *  is used to open a Dialog with given Title an a Progressbar,



From alainb at mail.berlios.de  Tue May  1 12:38:05 2007
From: alainb at mail.berlios.de (alainb at BerliOS)
Date: Tue, 1 May 2007 12:38:05 +0200
Subject: [Lincity-ng-commit] r1211 - in trunk/data/gui: . dialogs
Message-ID: <200705011038.l41Ac5vd003560@sheep.berlios.de>

Author: alainb
Date: 2007-05-01 12:38:03 +0200 (Tue, 01 May 2007)
New Revision: 1211

Added:
   trunk/data/gui/dialogs/warning.xml
   trunk/data/gui/warning.xml
Log:
add forgotten files for ok_dial_box

Added: trunk/data/gui/dialogs/warning.xml
===================================================================
--- trunk/data/gui/dialogs/warning.xml	2007-05-01 09:28:52 UTC (rev 1210)
+++ trunk/data/gui/dialogs/warning.xml	2007-05-01 10:38:03 UTC (rev 1211)
@@ -0,0 +1,7 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<OkDialog>
+	<title>Warning</title>
+	<image>warning.png</image>	
+	<bold>Warning</bold>
+	<p> </p>
+</OkDialog>

Added: trunk/data/gui/warning.xml
===================================================================
--- trunk/data/gui/warning.xml	2007-05-01 09:28:52 UTC (rev 1210)
+++ trunk/data/gui/warning.xml	2007-05-01 10:38:03 UTC (rev 1211)
@@ -0,0 +1,49 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+WARNING: This file is automatically generated. Do not edit!
+-->
+<Window xmlns="http://lincity-ng.berlios.de/gui" border="5" titlesize="25" width="700" height="200">
+  <title>
+    <Document>
+      <Paragraph style="title" translatable="yes" halign="center" name="DialogTitle">Not Allowed</Paragraph>
+    </Document>
+  </title>
+  <title-background>
+    <Gradient from="#ff0000ff" to="#88776655" direction="left-right"/>
+  </title-background>
+  <background>
+    <FilledRectangle color="#ffffffbb"/>
+  </background>
+  <contents>
+    <TableLayout rows="2" cols="1">
+      <rowsize row="2" fixed="50"/>
+      <cell row="1" col="1">
+        <TableLayout xmlns:xsd="http://www.w3.org/2001/XMLSchema" rows="1" cols="2">
+          <colsize col="1" fixed="95"/>
+          <cell row="1" col="1">
+            <Image src="images/gui/dialogs/warning.png"/>
+          </cell>
+          <cell row="1" col="2">
+            <Document style="message">
+              <p style="messagebold" translatable="yes">Warning</p>
+              <p xmlns="" translatable="yes"> </p>
+              <p name="ExtraText"/>
+            </Document>
+          </cell>
+        </TableLayout>
+      </cell>
+      <cell row="2" col="1">
+        <TableLayout xmlns:xsd="http://www.w3.org/2001/XMLSchema" rows="1" cols="1">
+          <cell row="1" col="1">
+            <Button name="Ok">
+              <text-caption style="dialogbutton" translatable="yes">Ok</text-caption>
+              <image src="images/gui/dialogs/yesbutton.png"/>
+              <image-hover src="images/gui/dialogs/yesbutton-hover.png"/>
+              <image-clicked src="images/gui/dialogs/yesbutton-clicked.png"/>
+            </Button>
+          </cell>
+        </TableLayout>
+      </cell>
+    </TableLayout>
+  </contents>
+</Window>



From alainb at mail.berlios.de  Thu May  3 16:57:31 2007
From: alainb at mail.berlios.de (alainb at BerliOS)
Date: Thu, 3 May 2007 16:57:31 +0200
Subject: [Lincity-ng-commit] r1212 - in branches/waterwell: . data/gui
	data/gui/dialogs data/help/nl data/messages src/lincity
	src/lincity/modules src/lincity-ng
Message-ID: <200705031457.l43EvVFZ010883@sheep.berlios.de>

Author: alainb
Date: 2007-05-03 16:57:28 +0200 (Thu, 03 May 2007)
New Revision: 1212

Added:
   branches/waterwell/data/gui/dialogs/warning.xml
   branches/waterwell/data/gui/warning.xml
   branches/waterwell/data/messages/warning.mes
Modified:
   branches/waterwell/data/help/nl/blacksmith.xml
   branches/waterwell/data/help/nl/button-index.xml
   branches/waterwell/data/help/nl/coal.xml
   branches/waterwell/data/help/nl/commune.xml
   branches/waterwell/data/help/nl/cricket.xml
   branches/waterwell/data/help/nl/economy.xml
   branches/waterwell/data/help/nl/index.xml
   branches/waterwell/data/help/nl/market.xml
   branches/waterwell/data/help/nl/msb-coal.xml
   branches/waterwell/data/help/nl/ore.xml
   branches/waterwell/data/help/nl/park.xml
   branches/waterwell/data/help/nl/pbar.xml
   branches/waterwell/data/help/nl/pollution.xml
   branches/waterwell/data/help/nl/port.xml
   branches/waterwell/data/help/nl/pottery.xml
   branches/waterwell/data/help/nl/powerline.xml
   branches/waterwell/data/help/nl/powerscoal.xml
   branches/waterwell/data/help/nl/road.xml
   branches/waterwell/data/help/nl/rocket.xml
   branches/waterwell/data/help/nl/steel.xml
   branches/waterwell/data/help/nl/substation.xml
   branches/waterwell/data/help/nl/track.xml
   branches/waterwell/data/help/nl/tutorial-aim.xml
   branches/waterwell/data/help/nl/tutorial-basics.xml
   branches/waterwell/data/help/nl/tutorial.xml
   branches/waterwell/runoldgui
   branches/waterwell/src/lincity-ng/MainLincity.cpp
   branches/waterwell/src/lincity-ng/MapEdit.cpp
   branches/waterwell/src/lincity-ng/ScreenInterface.cpp
   branches/waterwell/src/lincity/engine.cpp
   branches/waterwell/src/lincity/ldsvguts.cpp
   branches/waterwell/src/lincity/lin-city.h
   branches/waterwell/src/lincity/modules/market.cpp
   branches/waterwell/src/lincity/modules/oremine.cpp
   branches/waterwell/src/lincity/modules/port.cpp
   branches/waterwell/src/lincity/modules/rocket_pad.cpp
   branches/waterwell/src/lincity/modules/shanty.cpp
   branches/waterwell/src/lincity/modules/shanty.h
   branches/waterwell/src/lincity/simulate.cpp
Log:
MERGED trunk -r1203:1211

Copied: branches/waterwell/data/gui/dialogs/warning.xml (from rev 1211, trunk/data/gui/dialogs/warning.xml)

Copied: branches/waterwell/data/gui/warning.xml (from rev 1211, trunk/data/gui/warning.xml)

Modified: branches/waterwell/data/help/nl/blacksmith.xml
===================================================================
--- branches/waterwell/data/help/nl/blacksmith.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/blacksmith.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -13,7 +13,7 @@
 	<p style="hsubtitle">Lees ook:</p>
 	<li><a href="market">Markt</a></li>
 	<li><a href="ore">IJzererts</a></li>
-	<li><a href="commune">Communie</a></li>
+	<li><a href="commune">Houtskoolbranderij</a></li>
 	<li><a href="steel">Staal</a></li>
 	<li><a href="jobs">Werk</a></li>
 </Document>

Modified: branches/waterwell/data/help/nl/button-index.xml
===================================================================
--- branches/waterwell/data/help/nl/button-index.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/button-index.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -56,7 +56,7 @@
 
 	<!--<p style="subtitle">Mining</p>-->
 	<img src="images/gui/buttonpanel/mining/commune.png"/>
-	<p><a href="commune">Communie</a></p>
+	<p><a href="commune">Houtskoolbranderij</a></p>
 	<img src="images/gui/buttonpanel/mining/oremine.png"/>
 	<p><a href="oremine">IJzerertsmijn</a></p>
 

Modified: branches/waterwell/data/help/nl/coal.xml
===================================================================
--- branches/waterwell/data/help/nl/coal.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/coal.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -3,12 +3,12 @@
 	<p style="htitle">Steenkool</p>
 	<p style="hp">Steenkool wordt gebruikt door steenkoolcentrales om electriciteit te maken. Het wordt ook gebruikt door pottenbakkerijen, textielfabrieken en smidsen, bij het proces van goederen maken. Zware industrie (staalfabrieken) gebruiken steenkool als er geen electriciteit beschikbaar is.</p>
 	<p style="hp">Steenkool wordt opgegraven uit de grond door steenkoolmijnen. Er is een beperkte reserve, u kunt raadplegen door gebruik van de steenkoolreserve knop lees meer:(<a href="coalmine">steenkoolmijn</a>).</p>
-	<p style="hp">Communies leveren ook een kleine hoeveelheid steenkool. Eigenlijk is dit houtskool gemaakt van verbrand hout. Communies leveren alleen kleine hoeveelheden, genoeg voor een paar pottenbakkerijen en smidsen. </p>
+	<p style="hp">Houtskoolbranderijen leveren ook een kleine hoeveelheid steenkool. Eigenlijk is dit houtskool gemaakt van verbrand hout. Houtskoolbranderijen leveren alleen kleine hoeveelheden, genoeg voor een paar pottenbakkerijen en smidsen. </p>
 
 	<p style="hsubtitle">Lees ook:</p>
 	<li><a href="coalmine">Steenkoolmijn</a></li>
 	<li><a href="powerscoal">Steenkoolcentrale</a></li>
-	<li><a href="commune">Communie</a></li>
+	<li><a href="commune">Houtskoolbranderij</a></li>
 	<li><a href="pottery">Pottenbakkerij</a></li>
 	<li><a href="blacksmith">Smidse</a></li>
 	<li><a href="msb-coal">Steenkool gebieden</a></li>

Modified: branches/waterwell/data/help/nl/commune.xml
===================================================================
--- branches/waterwell/data/help/nl/commune.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/commune.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -1,12 +1,12 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <Document style="helpdocument">
-	<p style="htitle">Communie</p>
-	<p style="hp">Communies zijn gebieden waar houtskool (gelijk aan steenkool in dit spel) gemaakt wordt. Ze produceren ook kleine hoeveelheden ijzererts en staal.</p>
-	<p style="hp">U zult mogelijk een aantal communies nodig hebben om genoeg steenkool en staal te leveren voor pottenbakkerijen, smidsen en textielfabrieken.</p>
-	<p style="hp">Communies moeten verbonden zijn met transport.</p>
-	<p style="hp">Als een communie gedurende 10 jaar niets produceert, wordt het gesloten en omgevormd tot een park.</p>
+	<p style="htitle">Houtskoolbranderij</p>
+	<p style="hp">Houtskoolbranderijen zijn gebieden waar houtskool (gelijk aan steenkool in dit spel) gemaakt wordt. Ze produceren ook kleine hoeveelheden ijzererts en staal.</p>
+	<p style="hp">U zult mogelijk een aantal houtskoolbranderijen nodig hebben om genoeg steenkool en staal te leveren voor pottenbakkerijen, smidsen en textielfabrieken.</p>
+	<p style="hp">Houtskoolbranderijen moeten verbonden zijn met transport.</p>
+	<p style="hp">Als een houtskoolbranderij gedurende 10 jaar niets produceert, wordt het gesloten en omgevormd tot een park.</p>
 	
-	<p style="hp">Dit is een communie</p>
+	<p style="hp">Dit is een houtskoolbranderij</p>
 	<img src="images/tiles/commune1.png" halign="center"/>
 	<p style="hp">en dit is het icoontje</p>
 	<img src="images/gui/buttonpanel/mining/commune.png" halign="center"/>

Modified: branches/waterwell/data/help/nl/cricket.xml
===================================================================
--- branches/waterwell/data/help/nl/cricket.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/cricket.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <Document style="helpdocument">
 	<p style="htitle">Basketbalveld</p>
-	<p style="hp">Basketbalevelden leveren sport en vermaak aan de inwoners van uw stad. Ze hebben goederen en werk nodig om te werken. Er hoeft geen verbinding te zijn met verkeer, maar als het niet is verbonden met een weg, moet wel in de buurt liggen van een markt die werk en goederen kan leveren. Ze kosten ook geld om te onderhouden.</p>
+	<p style="hp">Basketbalvelden leveren sport en vermaak aan de inwoners van uw stad. Ze hebben goederen en werk nodig om te werken. Er hoeft geen verbinding te zijn met verkeer, maar als het niet is verbonden met een weg, moet wel in de buurt liggen van een markt die werk en goederen kan leveren. Ze kosten ook geld om te onderhouden.</p>
 	<p style="hp">Wanneer u een basketbalveld bouwt, kan deze niet meteen gebruikt worden, normaal duurt het 3 maanden voordat er gespeeld wordt.</p>
 	<p style="hp">Om te zien welk bereik uw basketbalvelden hebben, kunt u klikken op de sportbereik-knop onder de mini-kaart. Gebieden die in de buurt liggen, worden getoond als normaal, andere zijn donkergroen.</p>
 	<p style="hp">Basketbalvelden verhogen het welzijn van woonwijken in hun bereik.</p>

Modified: branches/waterwell/data/help/nl/economy.xml
===================================================================
--- branches/waterwell/data/help/nl/economy.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/economy.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -9,7 +9,7 @@
 	</li>
 	<li>
 		<span color="blue">Daklozen</span>
-        De blauwe lijn lijn toont de vraag naar huizen. De hoogte van de grafiek is komt overeen met de hoeveelheid daklozen.
+        De blauwe lijn toont de vraag naar huizen. De hoogte van de grafiek is komt overeen met de hoeveelheid daklozen.
 	</li>
 	<li>
 		<span color="yellow">Werkzoekende</span>

Modified: branches/waterwell/data/help/nl/index.xml
===================================================================
--- branches/waterwell/data/help/nl/index.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/index.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -7,7 +7,6 @@
 <li><a href="farm">Boerderij</a></li>
 <li><a href="msb-fire">Brand kaart</a></li>
 <li><a href="firestation">Brandweerkazerne</a></li>
-<li><a href="commune">Communie</a></li>
 <li><a href="dialogs">Dialogvenster</a></li>
 <li><a href="other-costs">Diverse kosten</a></li>
 <li><a href="tutorial-aim">Doel van het spel</a></li>
@@ -19,6 +18,7 @@
 <li><a href="goods">Goederen</a></li>
 <li><a href="port">Havens</a></li>
 <li><a href="fast">Hoge snelheid</a></li>
+<li><a href="commune">Houtskoolbranderij</a></li>
 <li><a href="button-index">Icoon index</a></li>
 <li><a href="export">Import en export gebieden</a></li>
 <li><a href="query">Informatie</a></li>

Modified: branches/waterwell/data/help/nl/market.xml
===================================================================
--- branches/waterwell/data/help/nl/market.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/market.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -13,7 +13,7 @@
 	<p style="hp">Als er geen markt in de buurt is, dan moeten deze gebouwen verbinding hebben met <a href="transport">verkeer</a>.</p>
 	<p style="hp">Rechtsonder, onder de tweede knop van het mini-venster is een overzicht zien van <b>alle marktvoorraden</b>,ook is te zien hoe dit verandert via een progres bar. Samen met de kleine kaartjes (kleine icoontjes onder het minivenster) zal het veel helpen inzicht te krijgen in de veranderingen van grondstoffen (voedsel, werk...).</p>
 		 
-	<p style="hp">Binnen het bereik van een markt of kan alles geruild worden <b>zonder gebruik te maken van verkeer</b>, behalve wanneer dat duidelijk is aangegeven. Rechtsonder is het kleine icoontje "verkeer kaart", op deze kaart is te zie  hoeveel verkeer er is en in het blauw wat het bereik van is van een markt. Controleer hier of een gebouw binnen het bereik van een markt is.Deze informatie kan ook op het grote scherm getoond worden door op het grote overlay icoon te klikken of door de "V"-toets in te drukken.</p>
+	<p style="hp">Binnen het bereik van een markt kan alles geruild worden <b>zonder gebruik te maken van verkeer</b>, behalve wanneer dat duidelijk is aangegeven. Rechtsonder is het kleine icoontje "verkeer kaart", op deze kaart is te zien  hoeveel verkeer er is en in het blauw wat het bereik van is van een markt. Controleer hier of een gebouw binnen het bereik van een markt is.Deze informatie kan ook op het grote scherm getoond worden door op het grote overlay icoon te klikken of door de "V"-toets in te drukken.</p>
 	
 	<p style="hsubtitle">Controleer wat markten kopen en verkopen</p>
 	<p style="hp">U kan de werking van de markt bepalen door selectie's te maken van wat kan worden gekocht en verkocht van het verkeer. Klik twee keer op een markt (niet de selecteer-knop) en linksboven komt een scherm zichtbaar waarmee bepaalt kan worden wat wordt verhandeld. Standaard wordt alles verhandeld.</p>

Modified: branches/waterwell/data/help/nl/msb-coal.xml
===================================================================
--- branches/waterwell/data/help/nl/msb-coal.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/msb-coal.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -3,7 +3,7 @@
 	<p style="htitle">Steenkoolkaart</p>
 	<img src="images/gui/mapview/roundbuttons/round_coal.png" halign="center"/>
 	<p style="hp">De steenkoolkaart laat u de steenkoolvooraad onder de grond zien. De steenkoolreserves zijn wit op een zwarte achtergrond. U kan een steenkoolmijn vlakbij een van deze steenkoolreserves bouwen.</p>
-	<p style="hp">De eerste keer dat u deze informatie opvraagt zal u gevraagd worden om een steenkoolonderzoek te houden wat u eenmalig 1 milloen zal kosten. Hierna is het gratis om deze informatie opnieuw op te roepen.</p>
+	<p style="hp">De eerste keer dat u deze informatie opvraagt zal u gevraagd worden om een steenkoolonderzoek te houden wat u eenmalig 1 miljoen zal kosten. Hierna is het gratis om deze informatie opnieuw op te roepen.</p>
 	<p style="hp">Links klikken op de minikaart om de kaart te centreren op de plek van uw muiscursor. U kunt wisselen tussen verschillende kaartmodi door de knop 'v' in te drukken.</p>
 
 	<p style="hsubtitle">Lees ook:</p>

Modified: branches/waterwell/data/help/nl/ore.xml
===================================================================
--- branches/waterwell/data/help/nl/ore.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/ore.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -1,11 +1,11 @@
 <?xml version="1.0"?>
 <Document style="helpdocument">
 	<p style="htitle">IJzererts</p>
-	<p style="hp">IJzererts is een van de basis ruwe materialen. Communies, ijzerertsmijnen en recycleercentra prodceren ijzererts.</p>
+	<p style="hp">IJzererts is een van de basis ruwe materialen. Houtskoolbranderijen, ijzerertsmijnen en recycleercentra prodceren ijzererts.</p>
 	<p style="hp">Pottenbakkerijen, lichte industrie en zware industrie verbruiken ijzererts.</p>
 
 	<p style="hsubtitle">Lees ook:</p>
-	<li><a href="commune">Communie</a></li>
+	<li><a href="commune">Houtskoolbranderij</a></li>
 	<li><a href="oremine">IJzerertsmijn</a></li>
 	<li><a href="recycle">Recycleren</a></li>
 	<li><a href="pottery">Pottenbakkerij</a></li>

Modified: branches/waterwell/data/help/nl/park.xml
===================================================================
--- branches/waterwell/data/help/nl/park.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/park.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -4,7 +4,7 @@
 	<p style="hp">Het idee van parken is simpel: het vermindert de vervuiling</p>
 	<p style="hp">Een aantal gebouwen verhogen de vervuiling. Dit zijn straten, spoorwegen, steenkoolmijnen en lichte en zware industrie. Sommige soorten gebouwen vervuilen meer dan andere.</p>
 	<p style="hp">U kunt parken gebruiken als schild voor woonwijken of om de vervuiling te beletten te ontsnappen van de bron.</p>
-	<p style="hp">De wind komt <b>van</b> het zuidwesten dus bouw u parken ook op een zo effectieve manier.</p>
+	<p style="hp">De wind komt <b>van</b> het zuidwesten dus bouw uw parken ook op een zo effectieve manier.</p>
 	
 	<p style="hp">Dit is een park</p>
 	<img src="images/tiles/parkland-plane.png" halign="center"/>

Modified: branches/waterwell/data/help/nl/pbar.xml
===================================================================
--- branches/waterwell/data/help/nl/pbar.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/pbar.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <Document style="helpdocument">
 	<p style="htitle">PBar</p>
-	<p style="hp">Dit is de tweede tab van het minivensterThis is the second tab of the miniwindow</p>
-	<p style="hp">Het toont de totale voorrad op alle markten samen zien, en hoe dat verandert.</p>
+	<p style="hp">Dit is de tweede tab van het minivenster</p>
+	<p style="hp">Het laat de totale voorraad op alle markten samen zien, en hoe dat verandert.</p>
 	<p style="hp">Het getal rechts duidt de totale hoeveelheid aan.</p>
 </Document>

Modified: branches/waterwell/data/help/nl/pollution.xml
===================================================================
--- branches/waterwell/data/help/nl/pollution.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/pollution.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -9,7 +9,7 @@
 	<li>Markten die veel verspilling hebben.</li>
 	<li>Straten/Spoorwegen, zeker diegenen die veel verspilling hebben..</li>
 	<p style="hp">Mensen houden er niet van om in vervuilde gebieden te leven. Ze zullen verhuizen, of worden ziek en sterven.</p>
-	<p style="hp">De overheersende wind komt uit het zuidwesten (de linker benedenhoek). Daardoor wordt de vervuiling naar het noordoosten geblazen (de linkerbovenhoek).</p>
+	<p style="hp">De overheersende wind komt uit het zuidwesten (de linker benedenhoek). Daardoor wordt de vervuiling naar het noordoosten geblazen (de rechterbovenhoek).</p>
 	<p style="hp">In het algemeen wilt u woonwijken bouwen zodat die geen last hebben van vervuiling. Dit is spijtig genoeg niet altijd mogelijk, u zal dan parken moeten bouwen om een schild te vormen. Hoe meer parken hoe groter de bescherming.</p>
 
 	<p style="hsubtitle">Lees ook:</p>

Modified: branches/waterwell/data/help/nl/port.xml
===================================================================
--- branches/waterwell/data/help/nl/port.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/port.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -6,7 +6,7 @@
 	<p style="hp">Een haven <b>moet</b> zo met een rivier verbonden zijn dat rechts van de haven water is.</p>
 	<p style="hp">Er wordt niets ge?mporteerd totdat u dat heeft gekozen in de checkbox.</p>
 	<p style="hp">De haven probeert om zoveel mogelijk te exporteren. Als u moet exporteren (om geld te verdienen), maar de export-hoeveelheid wilt beperken, zult u een slechter verbindingsweggetje moeten bouwen, een lange verbindingsweg gebruiken of langs een markt moeten gaan. U zult een beetje moeten experimenteren om het juiste resultaat te krijgen.</p>
-	<p style="hp">Letop: Exporters discount large exports.</p>
+	<p style="hp">Letop: Exporterbedrijven willen veel exporteren.</p>
 
 	<p style="hp">Dit is een haven</p>
 	<img src="images/tiles/ex_port.png" halign="center"/>

Modified: branches/waterwell/data/help/nl/pottery.xml
===================================================================
--- branches/waterwell/data/help/nl/pottery.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/pottery.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -1,7 +1,7 @@
 <?xml version="1.0"?>
 <Document style="helpdocument">
 	<p style="htitle">Pottenbakkerij</p>
-	<p style="hp">Pottenbakkerijen gebruiken ijzererts, steenkool en werk om goederen te produceren. Ze hoeven niet verbonden te zijn met transport, maar ze moeten wel in de buurt van een markt liggen, om ijzererts steenkool en werk te kunnen ontvangen.</p>
+	<p style="hp">Pottenbakkerijen gebruiken ijzererts, steenkool en werk om goederen te produceren. Ze hoeven niet verbonden te zijn met transport, maar ze moeten wel in de buurt van een markt liggen, om ijzererts, steenkool en werk te kunnen ontvangen.</p>
 	<p style="hp">U kunt zien of dat pottenbakkerijen werken door te kijken naar de ovens. Als de onderste oven geen rook produceert dan produceert de pottenbakkerij minder dan 100% van zijn mogelijke output.</p>
 	
 	<p style="hp">Dit is een pottenbakkerij</p>

Modified: branches/waterwell/data/help/nl/powerline.xml
===================================================================
--- branches/waterwell/data/help/nl/powerline.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/powerline.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -1,8 +1,8 @@
 <?xml version="1.0"?>
 <Document style="helpdocument">
 	<p style="htitle">Electriciteitsdraad</p>
-	<p style="hp">Electriciteitsdraden vervoeren electriciteit van energiecentrales (zonne-energiecentrales en steenkoolcentrales) naar transformatorhuisjes. <!-- outdated Power lines carry power from solar and coal power stations to substations. Power lines connect to the top left corner of each of the three types of icons, solar and coal power stations and substations..--></p>
-	<p style="hp">Electriciteitsdraden kruisen <b>onder</b> wegen, straten, spoorwegen en rivieren, als deze maar 1 breed zijn. Als een elctriciteitsdraad geplaatst wordt aan beide zijden van een verkeersweg of een riviergebied zijn deze draden verbonden. Vaak zult u een stuk rivier moeten afbreken, spijtig genoeg is dit duur. De electriciteitsdraden zijn verbonden als ze in een rechte lijn liggen.</p>
+	<p style="hp">Electriciteitsdraden vervoeren electriciteit van energiecentrales (zonne-energiecentrales en steenkoolcentrales) naar transformatorhuisjes. </p>
+	<p style="hp">Electriciteitsdraden kruisen <b>onder</b> wegen, straten, spoorwegen en rivieren, als deze maar 1 breed zijn. Als een electriciteitsdraad geplaatst wordt aan beide zijden van een verkeersweg of een riviergebied zijn deze draden verbonden. Vaak zult u een stuk rivier moeten afbreken, spijtig genoeg is dit duur. De electriciteitsdraden zijn verbonden als ze in een rechte lijn liggen.</p>
 
 	<p style="hp">Dit is een electriciteitsdraad</p>
 	<img src="images/tiles/powerlvd.png" halign="center"/>

Modified: branches/waterwell/data/help/nl/powerscoal.xml
===================================================================
--- branches/waterwell/data/help/nl/powerscoal.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/powerscoal.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -2,7 +2,6 @@
 <Document style="helpdocument">
 	<p style="htitle">Steenkoolcentrale</p>
 	<p style="hp">Steenkoolcentrales produceren van steenkool electriciteit die geplaatst worden op electriciteitsdraden.</p>
-	<!--Outdated<p style="hp">Power lines connect at the top left corner of the station, transport connects to the next possition in. See the example.</p>-->
 	<p style="hp">De effectiviteit van de productie gebruikt de technologie nivo <b>van de bouwdatum</b>. U kunt, wanneer uw technologie nivo veel gestegen is, een oude steenkoolcentrale afbreken en die herbouwen met een nieuwere, meer efficientere.</p>
 	
 	<p style="hp">Dit is Steenkoolcentrale</p>

Modified: branches/waterwell/data/help/nl/road.xml
===================================================================
--- branches/waterwell/data/help/nl/road.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/road.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -10,6 +10,6 @@
 	
 	<p style="hsubtitle">Lees ook:</p>
 	<li><a href="transport">Verkeer</a></li>
-	<li><a href="commune">Communie</a></li>
+	<li><a href="commune">Houtskoolbranderij</a></li>
 	<li><a href="pollution">Vervuiling</a></li>
 </Document>

Modified: branches/waterwell/data/help/nl/rocket.xml
===================================================================
--- branches/waterwell/data/help/nl/rocket.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/rocket.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -15,7 +15,7 @@
 	<p style="hsubtitle">Lees ook:</p>
 	<li><a href="market">Markt</a></li>
 	<li><a href="ore">IJzererts</a></li>
-	<li><a href="commune">Communie</a></li>
+	<li><a href="commune">Houtkoolbranderij</a></li>
 	<li><a href="steel">Staal</a></li>
 	<li><a href="jobs">Werk</a></li>
 </Document>

Modified: branches/waterwell/data/help/nl/steel.xml
===================================================================
--- branches/waterwell/data/help/nl/steel.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/steel.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -1,14 +1,14 @@
 <?xml version="1.0"?>
 <Document style="helpdocument">
 	<p style="htitle">Staal</p>
-	<p style="hp">Het meeste staal wordt gemaakt door zware industrie (staalfabriek). U moet een voldoende technische ontwikkeling bereikt hebben (er moeten voldoende nieuwe ontdekkingen gedaan zijn) om een staalfabriek te kunnen bouwen. Daarvoor kunnen alleen communies een klein beetje staal van ijzererts maken, meestal heeft u daarom een aantal communies nodig om voldoende staal te maken.</p>
-	<p style="hp">Staal wordt door smiderijen gebruikt om goederen te maken. Staal wordt ook gebruikt door lichte industrie voor gereedschap en producten (goederen). Lichte industrie kan ook zonder staal werken, maar produceert dan veel minder.</p>
+	<p style="hp">Het meeste staal wordt gemaakt door zware industrie (staalfabriek). U moet een voldoende technische ontwikkeling bereikt hebben (er moeten voldoende nieuwe ontdekkingen gedaan zijn) om een staalfabriek te kunnen bouwen. Daarvoor kunnen alleen houtskoolbranderijen een klein beetje staal van ijzererts maken, meestal heeft u daarom een aantal houtskoolbranderijen nodig om voldoende staal te maken.</p>
+	<p style="hp">Staal wordt door smederijen gebruikt om goederen te maken. Staal wordt ook gebruikt door lichte industrie voor gereedschap en producten (goederen). Lichte industrie kan ook zonder staal werken, maar produceert dan veel minder.</p>
 	<p style="hp">Raketten gebruiken veel staal, voornamelijk voor het lanceerplatform, (het lijkt erop dat er geen aluminium of titanium bestaat, 'staal' wordt ook gebruikt voor om de raketten te maken - maakt u daarover geen zorgen, dat doe ik ook niet).</p>
 	<p style="hp">Voor de onderhoud en reparatie van spoorwegen is ook staal nodig.</p>
 	<p style="hp">Op staal zit belasting.</p>
 
 	<p style="hsubtitle">Lees ook:</p>
-	<li><a href="commune">Communie</a></li>
+	<li><a href="commune">Houtskoolbranderij</a></li>
 	<li><a href="blacksmith">Smidse</a></li>
 	<li><a href="goods">Goederen</a></li>
 	<li><a href="industryh">Zware Industrie</a></li>

Modified: branches/waterwell/data/help/nl/substation.xml
===================================================================
--- branches/waterwell/data/help/nl/substation.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/substation.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -11,7 +11,7 @@
 	<p style="hsubtitle">Lees ook:</p>
 	<li><a href="powerline">Electriciteitsdraden</a></li>
 	<li><a href="powerssolar">Zonne-energiecentrale</a></li>
-	<li><a href="commune">Communie</a></li>
+	<li><a href="commune">Houtskoolbranderij</a></li>
 	<li><a href="steel">Staal</a></li>
 	<li><a href="jobs">Werk</a></li>
 </Document>

Modified: branches/waterwell/data/help/nl/track.xml
===================================================================
--- branches/waterwell/data/help/nl/track.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/track.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -10,5 +10,5 @@
 	
 	<p style="hsubtitle">Lees ook:</p>
 	<li><a href="transport">Verkeer</a></li>
-	<li><a href="commune">Communie</a></li>
+	<li><a href="commune">Houtskoolbranderij</a></li>
 </Document>

Modified: branches/waterwell/data/help/nl/tutorial-aim.xml
===================================================================
--- branches/waterwell/data/help/nl/tutorial-aim.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/tutorial-aim.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -2,7 +2,7 @@
 <Document style="helpdocument">
 <p style="htitle">Doel van het spel </p>
 <p style="hp">Er zijn 2 manieren om het spel te "winnen":</p>
-<li>Het bereiken van een Reach <a href="sustain">duurzame economie </a> (er kan daarna gewoon verder gespeeld worden) </li>
+<li>Het bereiken van een <a href="sustain">duurzame economie </a> (er kan daarna gewoon verder gespeeld worden) </li>
 <li>Evacueer alle inwoners met <a href="rocket">raketten </a> naar een andere planeet, het spel stopt dan. </li>
 <p style="hp"/>
 

Modified: branches/waterwell/data/help/nl/tutorial-basics.xml
===================================================================
--- branches/waterwell/data/help/nl/tutorial-basics.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/tutorial-basics.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -4,7 +4,7 @@
 	<p style="hp">Kies "new game " &gt; "willekeurig dorp". Andere scenario's zijn voor min of meer ervaren spelers. </p>
 	<p style="hp">Merk op dat het willekeurige dorp basis-benodigheden heeft:</p>
 	<li><a href="farm">Boerderijen</a> maken voedsel voor markten</li>
-	<li><a href="commune">Communies</a> die houtskool en kleine hoeveelheden ijzererts en staal maken </li>
+	<li><a href="commune">Hoyskoolbranderijen</a> die houtskool en kleine hoeveelheden ijzererts en staal maken </li>
 	<li><a href="residential">Woonwijken</a></li>
 	<li><a href="pottery">Pottebakkerijen</a></li>
 	<li><a href="track">Landweggetjes</a></li>
@@ -12,22 +12,22 @@
 	<p style="hp">Klik op een gebouw (in het hoofdvenster) en er wordt informatie getoond in het kleine venstertje rechtsonder.</p>
 
 	<p style="hsubtitle">Markt </p>
-	<p style="hp">De markt is een belangrijk gebouw in Lincity. Ze zijn noodzakelijk voor bijna alle plaatselijke in- en verkopen. De help-pagina's op <a href="market">markt </a> <b>moeten</b> gelezen worden :-). <i>, wanneer iets niet op een markt aanwezig is, dan kan het ook niet niet verhandeld worden, en wanneer een markt vol met een soort product is, dan zal dat ook niet meer ingekocht worden. Dit kan mischien een beetje helpen om te begrijpen waarom sommige gebouwen niet werken (waarschijnlijk kan iets war dringend nodig is niet gekocht worden, of ze kunnen de spulletjes die ze gemaakt hebben niet verkopen)</i> </p>
+	<p style="hp">De markt is een belangrijk gebouw in Lincity. Ze zijn noodzakelijk voor bijna alle plaatselijke in- en verkopen. De help-pagina's op <a href="market">markt </a> <b>moeten</b> gelezen worden :-). <i>, wanneer iets niet op een markt aanwezig is, dan kan het ook niet niet verhandeld worden, en wanneer een markt vol met een soort product is, dan zal dat ook niet meer ingekocht worden. Dit kan mischien een beetje helpen om te begrijpen waarom sommige gebouwen niet werken (waarschijnlijk kan iets wat dringend nodig is niet gekocht worden, of ze kunnen de spulletjes die ze gemaakt hebben niet verkopen)</i> </p>
 
 	<p style="hsubtitle">Verkeer </p>
 	<p style="hp"><a href="transport">Verkeer </a> is nodig voor lange afstand vervoer van goederen, en voor sommige met name genoemde activiteiten (het wordt dan beschreven in het bijbehorende help-pagina, zoals lichte industrie). Net zoals markten hebben ook wegen een beperkte capaciteit en kunnen vol raken.</p>
 
 	<p style="hp">Wanneer een "normaal" gebouw niet in het bereik van een markt is, moet het verbonden worden met verkeer. Vergeet niet dat wegen en spoorwegen ieder jaar geld kosten, daarom is het handiger (en goedkoper) om wanneer nodig markten te gebruiken (tenzij een gebouw zoals een monument werkelijk apart moet staan). </p>
 
-	<p style="hp">Als een dorp net is gestart, zijn landweggetjes alleen nodig voor de produktie van communes. Alle andere aktiviteiten hebben alleen een markt nodig. </p>
+	<p style="hp">Als een dorp net is gestart, zijn landweggetjes alleen nodig voor de produktie van houtskoolbranderijen. Alle andere aktiviteiten hebben alleen een markt nodig. </p>
 
 	<p style="hsubtitle">Geld </p>
 	<p style="hp">Er zit belasting op produktie en daarmee verdien je geld. In de minikaart is de derde tab <a href="finance">het financi?le kaartje</a>. Zorg ervoor dat er niet te snel, te veel geld wordt uitgegeven: wanneer er een geldtekoort is, kan er niets gebouwd worden en moet er rente betaald worden. Dit kan leiden tot een faillisement (lees ook <a href="tutorial-scenario"> Moeilijke scenario </a>). </p>
 
 	<p style="hsubtitle">De stad ontwikkelen </p>
 	<p style="hp">Vergeet niet dat mensen sterven als ze niet eten. Om controle te houden over de groei van de stad, moet er een balans gevonden in de soort gebouwde huizen  (Er worden meer of minder kinderen geboren en er sterven meer of minder mensen in verschillende soorten huizen) . De nieuwe bevolking kan meer werk verrichten, maar eten ook meer, en gebruiken meer goederen en hebben meer banen nodig...</p>
-	<p style="hp">De produktie moet vergroot worden (voeg pottebakkerijen en smederijen toe) en er moet voor gezorgd worden dat deze ook materialen krijgen. Er moet daarom ook communes bijgemaakt worden. </p>
-	<p style="hp">Om nieuwe soorten gebouwen te kunnen bouwen moet het <a href="tech-level"> Technologie nivo </a> verhoogt worden.</p>
+	<p style="hp">De produktie moet vergroot worden (voeg pottebakkerijen en smederijen toe) en er moet voor gezorgd worden dat deze ook materialen krijgen. Er moet daarom ook houtskoolbranderijen bijgemaakt worden. </p>
+	<p style="hp">Om nieuwe soorten gebouwen te kunnen bouwen moet het <a href="tech-level"> technologie nivo </a> verhoogt worden.</p>
 	<p style="hp">Op een gegeven moment moet er een speeldoel gekozen worden:of een <a href="sustain"> duurzame economie </a> of evacuatie met <a href="rocket"> raketten</a>.</p>
 
 	<p style="hp">Het statistieken venstertje toont de totale hoeveelheid voorraden beschikbaar in markten, en hoe dit zich ontwikkelt. Dit moet vaak gecontroleerd worden. De minikaartjes geven een beter inzicht de economie van dit spel.</p>

Modified: branches/waterwell/data/help/nl/tutorial.xml
===================================================================
--- branches/waterwell/data/help/nl/tutorial.xml	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/data/help/nl/tutorial.xml	2007-05-03 14:57:28 UTC (rev 1212)
@@ -33,7 +33,7 @@
 <p style="hp">Merk op dat het willekeurige dorp de basis-benodigheden heeft: </p>
 <li><a href="farm">Boerderijen</a> maken voedsel voor markten</li>
 <li><a href="market">Markten</a>zijn plaatsen waar alles gevonden kan worden wat mensen nodig zoals eten en werk, en ze kunnen hun afval erheen sturen. </li>
-<li><a href="commune">Communies</a> die houtskool en kleine hoeveelheden ijzererts en staal maken </li>
+<li><a href="commune">Houtskoolbranderijen</a> die houtskool en kleine hoeveelheden ijzererts en staal maken </li>
 <li><a href="residential">Woonwijken</a></li>
 <li><a href="pottery">Pottebakkerijen</a></li>
 <li><a href="track">Landweggetjes</a></li>

Copied: branches/waterwell/data/messages/warning.mes (from rev 1211, trunk/data/messages/warning.mes)

Modified: branches/waterwell/runoldgui
===================================================================
--- branches/waterwell/runoldgui	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/runoldgui	2007-05-03 14:57:28 UTC (rev 1212)
@@ -1,4 +1,5 @@
 #!/bin/bash
 export LINCITY_HOME=./data
-./lincity_oldgui
+#set dummy default language, and let oldgui manage it correctly
+LANG=zz ./lincity_oldgui
 

Modified: branches/waterwell/src/lincity/engine.cpp
===================================================================
--- branches/waterwell/src/lincity/engine.cpp	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity/engine.cpp	2007-05-03 14:57:28 UTC (rev 1212)
@@ -27,7 +27,10 @@
 
 extern int selected_type_cost;
 static void bulldoze_mappoint (short fill, int x, int y);
+int is_real_river (int x, int y);
 
+int last_warning_message_group = 0;
+
 void
 fire_area (int x, int y)
 {
@@ -50,8 +53,6 @@
     return total_money;
 }
 
-int is_real_river (int x, int y);
-
 int
 no_credit_build (int selected_group)
 {
@@ -90,94 +91,174 @@
   return (0);
 }
 
+void 
+no_credit_build_msg_ng (int selected_group)
+{
+  if (last_warning_message_group == selected_group)
+        return;
+  last_warning_message_group = selected_group;
+
+#ifdef GROUP_SOLAR_POWER_NO_CREDIT
+  if (selected_group == GROUP_SOLAR_POWER) {
+    ok_dial_box ("no-credit-solar-power.mes", BAD, 0L);
+    return;
+  }
+#endif
+#ifdef GROUP_UNIVERSITY_NO_CREDIT
+  if (selected_group == GROUP_UNIVERSITY) {
+    ok_dial_box ("no-credit-university.mes", BAD, 0L);
+    return;
+  }
+#endif
+#ifdef GROUP_PARKLAND_NO_CREDIT
+  if (selected_group == GROUP_PARKLAND) {
+    ok_dial_box ("no-credit-parkland.mes", BAD, 0L);
+    return;
+  }
+#endif
+#ifdef GROUP_RECYCLE_NO_CREDIT
+  if (selected_group == GROUP_RECYCLE) {
+    ok_dial_box ("no-credit-recycle.mes", BAD, 0L);
+    return;
+  }
+#endif
+#ifdef GROUP_ROCKET
+  if (selected_group == GROUP_ROCKET) {
+    ok_dial_box ("no-credit-rocket.mes", BAD, 0L);
+    return;
+  }
+#endif
+  return;
+}
+
 int 
 place_item (int x, int y, short type)
 {
+    int i,j;
+    int prev_tip = 0;
     int group;
     int size;
 
     group = get_group_of_type(type);
-    if (group < 0) return -1;
+    if (group < 0) {
+#ifdef DEBUG
+        fprintf(stderr,"Error: group does not exist %i\n", group);
+#endif
+        ok_dial_box ("warning.mes", BAD,
+                _("ERROR: group does not exist. This should not happen! Please consider filling a bug report to lincity-ng team, with the saved game and what you did :-) "));
+        return -1000;
+    }
 
     size = main_groups[group].size;
 
     /* You can't build because credit not available. */
     if (no_credit_build (group) != 0) {
+        no_credit_build_msg_ng (group);
 	return -1;
     }
 
-    /* Not enough slots in the substation array */
-
     switch (group) {
+    case GROUP_ORGANIC_FARM:
+	MP_INFO(x,y).int_1 = tech_level;
+        break;
+    case GROUP_TRACK:
+    case GROUP_ROAD:
+    case GROUP_RAIL:
+	MP_INFO(x,y).flags |= FLAG_IS_TRANSPORT;
+        break;
+    case GROUP_PORT:
+	if (is_real_river (x + 4, y) != 1 
+	        || is_real_river (x + 4, y + 1) != 1
+	        || is_real_river (x + 4, y + 2) != 1 
+	        || is_real_river (x + 4, y + 3) != 1) {
+            if (last_warning_message_group != group)
+                ok_dial_box ("warning.mes", BAD,
+                    _("Port must be connected to river all along right side."));
+            last_warning_message_group = group;
+            return -2;
+        }
+        break;
     case GROUP_SUBSTATION:
     case GROUP_WINDMILL:
-    {
-	if (add_a_substation (x, y) == 0)
+	if (add_a_substation (x, y) == 0) {
+            /* Not enough slots in the substation array */
+            if (last_warning_message_group != group)
+                ok_dial_box ("warning.mes", BAD,
+                    _("Too many substations + windmills. You cannot build one more"));
+            last_warning_message_group = group;
 	    return -3;
-    } break;
-    case GROUP_PORT:
-    {
-	if (is_real_river (x + 4, y) != 1 
-	    || is_real_river (x + 4, y + 1) != 1
-	    || is_real_river (x + 4, y + 2) != 1 
-	    || is_real_river (x + 4, y + 3) != 1) {
-	    return -2;
-	}
-    } break;
+        }
+        MP_INFO(x,y).int_2 = tech_level;
+        MP_INFO(x,y).int_1 = (int)(WINDMILL_POWER
+	        + (((double) MP_INFO(x,y).int_2 * WINDMILL_POWER) / MAX_TECH_LEVEL));
+        /* Make sure that the correct windmill graphic shows up */
+	if (tech_level > MODERN_WINDMILL_TECH)
+	    type = CST_WINDMILL_1_R;
+	else 
+	    type = CST_WINDMILL_1_W;
+        break;
+    case (GROUP_COAL_POWER):
+        MP_INFO(x,y).int_4 = tech_level;
+        MP_INFO(x,y).int_1 = (int)(POWERS_COAL_OUTPUT
+	        + (((double) MP_INFO(x,y).int_4 * POWERS_COAL_OUTPUT)
+	                / MAX_TECH_LEVEL));
+        break;
+    case (GROUP_SOLAR_POWER):
+ 	MP_INFO(x,y).int_2 = tech_level;
+        MP_INFO(x,y).int_3 = (int)(POWERS_SOLAR_OUTPUT
+	        + (((double) MP_INFO(x,y).int_2 * POWERS_SOLAR_OUTPUT)
+	                / MAX_TECH_LEVEL));
+        break;
     case GROUP_COMMUNE:
-    {
 	numof_communes++;
-    } break;
+        break;
     case GROUP_MARKET:
-    {
 	/* Test for enough slots in the market array */
-	if (add_a_market (x, y) == 0)
-	    return -3;
+	if (add_a_market (x, y) == 0) {
+            if (last_warning_message_group != group)
+                ok_dial_box ("warning.mes", BAD,
+                        _("Too many markets. You cannot build one more"));
+            last_warning_message_group = group;
+	    return -4;
+        }
 	MP_INFO(x,y).flags += (FLAG_MB_FOOD | FLAG_MB_JOBS
 			       | FLAG_MB_COAL | FLAG_MB_ORE | FLAG_MB_STEEL
 			       | FLAG_MB_GOODS | FLAG_MS_FOOD | FLAG_MS_JOBS
 			       | FLAG_MS_COAL | FLAG_MS_GOODS | FLAG_MS_ORE
 			       | FLAG_MS_STEEL);
-    } break;
+        break;
+    case GROUP_RECYCLE:
+        MP_INFO(x,y).int_4 = tech_level;
+        break;
     case GROUP_TIP:
-    {
 	/* Don't build a tip if there has already been one.  If we succeed,
 	   mark the spot permanently by "doubling" the ore reserve */
-	/* AL1: in NG 1.1 tip cannot be bulldozed, so it seems impossible that this case happens */
-	int i,j;
-	int prev_tip = 0;
-	for (i=0;i<3;i++) {
-	    for (j=0;j<3;j++) {
+	prev_tip = 0;
+	for (i=0; i < size; i++)
+	    for (j=0; j < size; j++)
 		if (MP_INFO(x+i,y+j).ore_reserve > ORE_RESERVE) {
 		    prev_tip = 1;
 		    break;
 		}
-	    }
-	}
 	if (prev_tip) {
-	    dialog_box(red(12),3,
-		       0,0,_("You can't build a tip here"),
-		       0,0,_("This area was once a landfill"),
-		       2,' ',_("OK"));
-	    return -4;
+	    ok_dial_box ("warning.mes", BAD,
+                    _("You can't build a tip here: this area was once a landfill"));
+	    return -5;
 	} else {
-	    for (i=0;i<3;i++) {
-		for (j=0;j<3;j++) {
+	    for (i=0; i < size; i++)
+		for (j=0; j < size; j++)
 		    MP_INFO(x+i,y+j).ore_reserve = ORE_RESERVE * 2;
-		}
-	    }
 	}
-    } break;
+        break;
     case GROUP_OREMINE:
     {
 	/* Don't allow new mines on old mines or old tips */
 	/* GCS: mines over old mines is OK if there is enough remaining 
 	        ore, as is the case when there is partial overlap. */
-	int i,j;
-	int prev_tip = 0;
 	int total_ore = 0;
-	for (i=0;i<3;i++) {
-	    for (j=0;j<3;j++) {
+	prev_tip = 0;
+	for (i=0;i<size;i++) {
+	    for (j=0;j<size;j++) {
 		total_ore += MP_INFO(x+i,y+j).ore_reserve;
 		if (MP_INFO(x+i,y+j).ore_reserve > ORE_RESERVE) {
 		    prev_tip = 1;
@@ -186,63 +267,30 @@
 	    }
 	}
 	if (prev_tip) {
-	    dialog_box(red(12),3,
-		       0,0,_("You can't build a mine here"),
-		       0,0,_("This area was once a landfill"),
-		       2,' ',_("OK"));
-	    return -4;
+	    ok_dial_box ("warning.mes", BAD,
+                    _("You can't build a mine here: This area was once a landfill"));
+	    return -6;
 	}
 	if (total_ore < MIN_ORE_RESERVE_FOR_MINE) {
-	    dialog_box(red(12),3,
-		       0,0,_("You can't build a mine here"),
-		       0,0,_("There is no ore left at this site"),
-		       2,' ',_("OK"));
-	    return -4;
+	    ok_dial_box("warning.mes", BAD,
+                    _("You can't build a mine here: there is no ore left at this site"));
+	    return -7;
 	}
-    }
+        break;
+    } 
     case GROUP_WATERWELL:
-    {
 	numof_waterwell++;
-    } break;
+        break;
 
     } /* end case */
+    last_warning_message_group = 0;
 
     /* Store last_built for refund on "mistakes" */
     last_built_x = x;
     last_built_y = y;
 
-    /* Make sure that the correct windmill graphic shows up */
-    if (group == GROUP_WINDMILL) {
-	if (tech_level > MODERN_WINDMILL_TECH) {
-	    type = CST_WINDMILL_1_R;
-	} else {
-	    type = CST_WINDMILL_1_W;
-	}
-    }
-
-    if (group == GROUP_SOLAR_POWER || group == GROUP_WINDMILL) {
-	MP_INFO(x,y).int_2 = tech_level;
-	// FIXME: what is this for:	let_one_through = 1;
-    }
-    else if (group == GROUP_RECYCLE || group == GROUP_COAL_POWER)
-	MP_INFO(x,y).int_4 = tech_level;
-    else if (group == GROUP_ORGANIC_FARM)
-	MP_INFO(x,y).int_1 = tech_level;
-    else if (group == GROUP_TRACK
-	     || group == GROUP_ROAD
-	     || group == GROUP_RAIL)
-	MP_INFO(x,y).flags |= FLAG_IS_TRANSPORT;
-    else if (group == GROUP_COALMINE
-	     || group == GROUP_OREMINE)
-      {
-	// FIXME: what is this for:	let_one_through = 1;
-	//	let_one_through = 1;
-      }
-
     set_mappoint (x, y, type);
 
-    update_tech_dep (x, y);
-
     if (group == GROUP_RIVER)
 	connect_rivers ();
 
@@ -260,6 +308,9 @@
 
     if (MP_TYPE(x,y) == CST_USED) {
 	/* This is considered "improper" input.  Silently ignore. */
+#ifdef DEBUG
+        fprintf(stderr," try to improperly bulldoze_item CST_USED\n");
+#endif
 	return -1;
     }
 
@@ -272,7 +323,7 @@
 	return -1;
     }
     else if (g == GROUP_SHANTY) {
-	fire_area (x, y);
+	remove_a_shanty(x, y);
 	adjust_money(-GROUP_SHANTY_BUL_COST);
         numof_shanties--;
     }
@@ -286,30 +337,29 @@
     }
     else {
 	adjust_money(-main_groups[g].bul_cost);
-	/* A little ugly hack to keep compatibility when saving pre_waterwell loaded game
-	 * This should be temporary as compatibility will probably be lost for sure later
-	 */
-	if (use_waterwell)
-		do_bulldoze_area (CST_DESERT, x, y);
-	else
-		do_bulldoze_area (CST_GREEN, x, y);
-
+         
         if (g == GROUP_COMMUNE)
-            numof_communes--;
+             numof_communes--;
 
         if (g == GROUP_MARKET)
             remove_a_market (x, y);
-
+ 
         if (g == GROUP_SUBSTATION || g == GROUP_WINDMILL)
-            remove_a_substation (x, y);
-
-	if (g == GROUP_OREMINE) {
+             remove_a_substation (x, y);
+ 
+	if (g == GROUP_OREMINE)	{
 	    int i, j;
 	    for (j = 0; j < 4; j++)
 		for (i = 0; i < 4; i++)
 		    if (MP_INFO(x + i,y + j).ore_reserve < ORE_RESERVE / 2)
 			do_bulldoze_area (CST_WATER, x + i, y + j);
-	}
+	} else {
+            /* keep compatibility for saving pre_waterwell loaded game */
+            if (use_waterwell)
+                do_bulldoze_area (CST_DESERT, x, y);
+            else
+                do_bulldoze_area (CST_GREEN, x, y);
+        }
     }
 
     /* Tell mps about it, in case its selected */
@@ -384,173 +434,6 @@
     }
 }
 
-
-int
-buy_food (int xt, int yt)
-{
-  int i = 0;
-  if (MP_GROUP(xt,yt) == GROUP_TRACK)
-    {
-      if (MP_INFO(xt,yt).int_1 < MAX_FOOD_ON_TRACK)
-	i = MAX_FOOD_ON_TRACK - MP_INFO(xt,yt).int_1;
-    }
-  else if (MP_GROUP(xt,yt) == GROUP_ROAD)
-    {
-      if (MP_INFO(xt,yt).int_1 < MAX_FOOD_ON_ROAD)
-	i = MAX_FOOD_ON_ROAD - MP_INFO(xt,yt).int_1;
-    }
-  else if (MP_GROUP(xt,yt) == GROUP_RAIL)
-    {
-      if (MP_INFO(xt,yt).int_1 < MAX_FOOD_ON_RAIL)
-	i = MAX_FOOD_ON_RAIL - MP_INFO(xt,yt).int_1;
-    }
-  i = (i * PORT_IMPORT_RATE) / 1000;
-  MP_INFO(xt,yt).int_1 += i;
-  return (i * PORT_FOOD_RATE);
-}
-
-int
-buy_coal (int xt, int yt)
-{
-  int i = 0;
-  if (MP_GROUP(xt,yt) == GROUP_TRACK)
-    {
-      if (MP_INFO(xt,yt).int_3 < MAX_COAL_ON_TRACK)
-	i = MAX_COAL_ON_TRACK - MP_INFO(xt,yt).int_3;
-    }
-  else if (MP_GROUP(xt,yt) == GROUP_ROAD)
-    {
-      if (MP_INFO(xt,yt).int_3 < MAX_COAL_ON_ROAD)
-	i = MAX_COAL_ON_ROAD - MP_INFO(xt,yt).int_3;
-    }
-  else if (MP_GROUP(xt,yt) == GROUP_RAIL)
-    {
-      if (MP_INFO(xt,yt).int_3 < MAX_COAL_ON_RAIL)
-	i = MAX_COAL_ON_RAIL - MP_INFO(xt,yt).int_3;
-    }
-  i = (i * PORT_IMPORT_RATE) / 1000;
-  MP_INFO(xt,yt).int_3 += i;
-  return (i * PORT_COAL_RATE);
-}
-
-int
-buy_ore (int xt, int yt)
-{
-  int i = 0;
-  if (MP_GROUP(xt,yt) == GROUP_TRACK)
-    {
-      if (MP_INFO(xt,yt).int_5 < MAX_ORE_ON_TRACK)
-	i = MAX_ORE_ON_TRACK - MP_INFO(xt,yt).int_5;
-    }
-  else if (MP_GROUP(xt,yt) == GROUP_ROAD)
-    {
-      if (MP_INFO(xt,yt).int_5 < MAX_ORE_ON_ROAD)
-	i = MAX_ORE_ON_ROAD - MP_INFO(xt,yt).int_5;
-    }
-  else if (MP_GROUP(xt,yt) == GROUP_RAIL)
-    {
-      if (MP_INFO(xt,yt).int_5 < MAX_ORE_ON_RAIL)
-	i = MAX_ORE_ON_RAIL - MP_INFO(xt,yt).int_5;
-    }
-  i = (i * PORT_IMPORT_RATE) / 1000;
-  MP_INFO(xt,yt).int_5 += i;
-  return (i * PORT_ORE_RATE);
-}
-
-int
-buy_goods (int xt, int yt)
-{
-  int i = 0;
-  if (MP_GROUP(xt,yt) == GROUP_TRACK)
-    {
-      if (MP_INFO(xt,yt).int_4 < MAX_GOODS_ON_TRACK)
-	i = MAX_GOODS_ON_TRACK - MP_INFO(xt,yt).int_4;
-    }
-  else if (MP_GROUP(xt,yt) == GROUP_ROAD)
-    {
-      if (MP_INFO(xt,yt).int_4 < MAX_GOODS_ON_ROAD)
-	i = MAX_GOODS_ON_ROAD - MP_INFO(xt,yt).int_4;
-    }
-  else if (MP_GROUP(xt,yt) == GROUP_RAIL)
-    {
-      if (MP_INFO(xt,yt).int_4 < MAX_GOODS_ON_RAIL)
-	i = MAX_GOODS_ON_RAIL - MP_INFO(xt,yt).int_4;
-    }
-  i = (i * PORT_IMPORT_RATE) / 1000;
-  MP_INFO(xt,yt).int_4 += i;
-  return (i * PORT_GOODS_RATE);
-}
-
-
-int
-buy_steel (int xt, int yt)
-{
-  int i = 0;
-  if (MP_GROUP(xt,yt) == GROUP_TRACK)
-    {
-      if (MP_INFO(xt,yt).int_6 < MAX_STEEL_ON_TRACK)
-	i = MAX_STEEL_ON_TRACK - MP_INFO(xt,yt).int_6;
-    }
-  else if (MP_GROUP(xt,yt) == GROUP_ROAD)
-    {
-      if (MP_INFO(xt,yt).int_6 < MAX_STEEL_ON_ROAD)
-	i = MAX_STEEL_ON_ROAD - MP_INFO(xt,yt).int_6;
-    }
-  else if (MP_GROUP(xt,yt) == GROUP_RAIL)
-    {
-      if (MP_INFO(xt,yt).int_6 < MAX_STEEL_ON_RAIL)
-	i = MAX_STEEL_ON_RAIL - MP_INFO(xt,yt).int_6;
-    }
-  i = (i * PORT_IMPORT_RATE) / 1000;
-  MP_INFO(xt,yt).int_6 += i;
-  return (i * PORT_STEEL_RATE);
-}
-
-int
-sell_food (int xt, int yt)
-{
-  int i = 0;
-  i = (MP_INFO(xt,yt).int_1 * PORT_EXPORT_RATE) / 1000;
-  MP_INFO(xt,yt).int_1 -= i;
-  return (i * PORT_FOOD_RATE);
-}
-
-int
-sell_coal (int xt, int yt)
-{
-  int i = 0;
-  i = (MP_INFO(xt,yt).int_3 * PORT_EXPORT_RATE) / 1000;
-  MP_INFO(xt,yt).int_3 -= i;
-  return (i * PORT_COAL_RATE);
-}
-
-int
-sell_ore (int xt, int yt)
-{
-  int i = 0;
-  i = (MP_INFO(xt,yt).int_5 * PORT_EXPORT_RATE) / 1000;
-  MP_INFO(xt,yt).int_5 -= i;
-  return (i * PORT_ORE_RATE);
-}
-
-int
-sell_goods (int xt, int yt)
-{
-  int i = 0;
-  i = (MP_INFO(xt,yt).int_4 * PORT_EXPORT_RATE) / 1000;
-  MP_INFO(xt,yt).int_4 -= i;
-  return (i * PORT_GOODS_RATE);
-}
-
-int
-sell_steel (int xt, int yt)
-{
-  int i = 0;
-  i = (MP_INFO(xt,yt).int_6 * PORT_EXPORT_RATE) / 1000;
-  MP_INFO(xt,yt).int_6 -= i;
-  return (i * PORT_STEEL_RATE);
-}
-
 void
 do_pollution ()
 {
@@ -614,80 +497,7 @@
   } while (++pol < &map.pollution[WORLD_SIDE_LEN][0]);
 }
 
-
-/* XXX: remove_people is only used by rocket_pad, perhaps it should go there */
-
 void
-remove_people (int num)
-{
-#if defined (commentout)
-  int x, y, f;
-  time_t t;
-  f = 1;
-  t = time (0);
-  while (f && (num > 0)) {
-      for (y = 0; y < WORLD_SIDE_LEN; y++)
-	for (x = 0; x < WORLD_SIDE_LEN; x++)
-	  if (MP_GROUP_IS_RESIDENCE(x,y) && MP_INFO(x,y).population > 0)
-	    {
-	      MP_INFO(x,y).population--;
-	      // f = 1;
-	      f |= (MP_INFO(x,y).population > 0);
-	      num--;
-	      total_evacuated++;
-	    }
-  }
-  while (num > 0 && people_pool > 0) {
-      num--;
-      total_evacuated++;
-      people_pool--;
-  }
-#endif
-
-  int x, y;
-  /* reset housed population so that we can display it correctly */
-  housed_population = 1;
-  while (housed_population && (num > 0)) {
-      housed_population = 0;
-      for (y = 0; y < WORLD_SIDE_LEN; y++)
-	for (x = 0; x < WORLD_SIDE_LEN; x++)
-	  if (MP_GROUP_IS_RESIDENCE(x,y) && MP_INFO(x,y).population > 0) {
-	      MP_INFO(x,y).population--;
-	      housed_population += MP_INFO(x,y).population;
-	      num--;
-	      total_evacuated++;
-	  }
-  }
-  while (num > 0 && people_pool > 0) {
-      num--;
-      total_evacuated++;
-      people_pool--;
-  }
-
-  refresh_population_text ();
-
-#if defined (commentout)
-/* last ship wasn't full so everyone has gone. */
-  if (num > 0)
-    {
-      if (t > HOF_START && t < HOF_STOP)
-	ok_dial_box ("launch-gone-mail.mes", GOOD, 0L);
-      else
-	ok_dial_box ("launch-gone.mes", GOOD, 0L);
-      housed_population = 0;
-    }
-#endif
-
-  /* Note that the previous test was inaccurate.  There could be 
-     exactly 1000 people left. */
-  if (!housed_population && !people_pool) {
-    ok_dial_box ("launch-gone.mes", GOOD, 0L);
-  }
-}
-
-
-
-void
 clear_fire_health_and_cricket_cover (void)
 {
   int x, y, m;
@@ -720,8 +530,6 @@
       }
 }
 
-
-
 void
 do_random_fire (int x, int y, int pwarning)	/* well random if x=y=-1 */
 {
@@ -922,39 +730,7 @@
   return (-1);
 }
 
-
-
 void
-update_tech_dep (int x, int y)
-{
-  switch (MP_GROUP(x,y))
-    {
-    case (GROUP_WINDMILL):
-#ifdef OLD_POWER_CODE
-      MP_INFO(x,y).int_5 = (int)(WINDMILL_POWER
-#else
-      MP_INFO(x,y).int_1 = (int)(WINDMILL_POWER
-#endif
-	+ (((double) MP_INFO(x,y).int_2 * WINDMILL_POWER) / MAX_TECH_LEVEL));
-      break;
-    case (GROUP_COAL_POWER):
-#ifdef OLD_POWER_CODE
-      MP_INFO(x,y).int_5 = (int)(POWERS_COAL_OUTPUT
-#else
-      MP_INFO(x,y).int_1 = (int)(POWERS_COAL_OUTPUT
-#endif
-	+ (((double) MP_INFO(x,y).int_4 * POWERS_COAL_OUTPUT)
-	   / MAX_TECH_LEVEL));
-      break;
-    case (GROUP_SOLAR_POWER):
-      MP_INFO(x,y).int_3 = (int)(POWERS_SOLAR_OUTPUT
-	+ (((double) MP_INFO(x,y).int_2 * POWERS_SOLAR_OUTPUT)
-	   / MAX_TECH_LEVEL));
-      break;
-    }
-}
-
-void
 connect_rivers (void)
 {
   int x, y, count;

Modified: branches/waterwell/src/lincity/ldsvguts.cpp
===================================================================
--- branches/waterwell/src/lincity/ldsvguts.cpp	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity/ldsvguts.cpp	2007-05-03 14:57:28 UTC (rev 1212)
@@ -615,14 +615,13 @@
     }
     else
 	university_intake_rate = 50;
-    for (x = 0; x < WORLD_SIDE_LEN; x++)
-    {
-	for (y = 0; y < WORLD_SIDE_LEN; y++)
-	{
-	    update_tech_dep (x, y);
-	}
-    }
 
+    /*Al1 : What is this ? This does nothing, the value are saved in MP_INFO.int_ 
+     * for (x = 0; x < WORLD_SIDE_LEN; x++)
+     *   for (y = 0; y < WORLD_SIDE_LEN; y++)
+     *     update_tech_dep (x, y);
+     */
+
     unhighlight_module_button (selected_module);
     selected_module = sbut[7];	/* 7 is track.  Watch out though! */
     highlight_module_button (selected_module);

Modified: branches/waterwell/src/lincity/lin-city.h
===================================================================
--- branches/waterwell/src/lincity/lin-city.h	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity/lin-city.h	2007-05-03 14:57:28 UTC (rev 1212)
@@ -89,11 +89,6 @@
 #define FATAL   -1
 #define WARNING -2
 
-#ifndef M_PI
-#define M_PI        3.14159265358979323846
-#endif
-
-
 /* comment out the the next three lines for _slightly_ faster X drawing. */
 #if defined LC_X11 || defined WIN32
 #define ALLOW_PIX_DOUBLING
@@ -1354,18 +1349,6 @@
 extern void do_oremine (int, int);
 extern void do_commune (int, int);
 extern void do_port (int, int);
-extern int buy_food (int, int);
-extern int buy_jobs (int, int);
-extern int buy_coal (int, int);
-extern int buy_ore (int, int);
-extern int buy_goods (int, int);
-extern int buy_steel (int, int);
-extern int sell_food (int, int);
-extern int sell_jobs (int, int);
-extern int sell_coal (int, int);
-extern int sell_ore (int, int);
-extern int sell_goods (int, int);
-extern int sell_steel (int, int);
 
 extern void do_pollution (void);
 extern void do_parkland (int, int);
@@ -1374,7 +1357,6 @@
 extern void do_health_centre (int, int);
 extern void do_rocket_pad (int, int);
 extern void launch_rocket (int x, int y);
-extern void remove_people (int);
 extern void do_windmill (int, int);
 extern void do_monument (int, int);
 extern void do_school (int, int);
@@ -1393,7 +1375,7 @@
 extern int spiral_find_group (int, int, int);
 extern int spiral_find_2x2 (int, int);
 extern void add_a_shanty (void);
-extern void remove_a_shanty (void);
+extern void remove_a_shanty (int, int);
 extern void update_shanty (void);
 extern void do_shanty (int, int);
 extern void do_tip (int, int);

Modified: branches/waterwell/src/lincity/modules/market.cpp
===================================================================
--- branches/waterwell/src/lincity/modules/market.cpp	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity/modules/market.cpp	2007-05-03 14:57:28 UTC (rev 1212)
@@ -368,8 +368,11 @@
   marketx[numof_markets] = x;
   markety[numof_markets] = y;
   numof_markets++;
-  /* oh dear. Got to bootstap markets with jobs, otherwise power won't work */
-  /* GCS: Is this still true?  */
+  /* oh dear. Got to bootstap markets with jobs, otherwise power won't work
+   * GCS: Is this still true?
+   * AL1: FIXME it seems not :) it's just needed to wait for periodic event
+   */
+
   MP_INFO(x,y).int_2 = 2000;
   return (1);
 }
@@ -377,7 +380,9 @@
 void
 remove_a_market (int x, int y)
 {
-  /* Should try to use jobs to put everything on transport or other markets ?*/
+  /* AL1: Could use present jobs to try put_everything elsewhere
+   * at least half of the content
+   */
   int q;
   for (q = 0; q < numof_markets; q++)
     if (marketx[q] == x && markety[q] == y)
@@ -565,7 +570,10 @@
 	  MP_POL(x,y) += 3000;
 	  MP_INFO(x,y).int_7 -= (7 * MAX_WASTE_IN_MARKET) / 10;
 #if defined (commentout)
-	  /* this should fire up the pollution mini screen within a second. */
+	  /* this should fire up the pollution mini screen within a second.
+           * AL1: oh this is not implemented in NG :(
+           * This works only with oldgui
+           */
 	  mini_screen_flags = MINI_SCREEN_POL_FLAG;
 #endif
 	}

Modified: branches/waterwell/src/lincity/modules/oremine.cpp
===================================================================
--- branches/waterwell/src/lincity/modules/oremine.cpp	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity/modules/oremine.cpp	2007-05-03 14:57:28 UTC (rev 1212)
@@ -128,13 +128,11 @@
 
 
   /* choose a graphic */
-  if ((total_time & 0x7f) == 0)
-    {
+  if ((total_time & 0x7f) == 0) {
       xx = 7 * (MP_INFO(x,y).int_2 + (3 * ORE_RESERVE / 2))
 	/ (16 * ORE_RESERVE);
-      switch (xx)
-	{
-	case (0):
+      switch (xx) {
+        case (0):
 	  MP_TYPE(x,y) = CST_OREMINE_8;
 	  break;
 	case (1):
@@ -161,6 +159,7 @@
 	}
 	if (MP_INFO(x,y).int_2 <= 0) {
 #if defined (commentout)
+            /* AL1. It seems to be overwritten just below! */
 	    do_bulldoze_area (CST_GREEN, x, y);
 	    place_item(x,y,CST_TIP_0);
 #endif
@@ -173,7 +172,7 @@
 	    connect_rivers ();
 	    refresh_main_screen ();
 	}
-    }
+  }
 }
 
 void

Modified: branches/waterwell/src/lincity/modules/port.cpp
===================================================================
--- branches/waterwell/src/lincity/modules/port.cpp	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity/modules/port.cpp	2007-05-03 14:57:28 UTC (rev 1212)
@@ -8,9 +8,177 @@
 #include "modules.h"
 #include "port.h"
 
+static int
+buy_food (int xt, int yt)
+{
+  int i = 0;
+  if (MP_GROUP(xt,yt) == GROUP_TRACK)
+    {
+      if (MP_INFO(xt,yt).int_1 < MAX_FOOD_ON_TRACK)
+	i = MAX_FOOD_ON_TRACK - MP_INFO(xt,yt).int_1;
+    }
+  else if (MP_GROUP(xt,yt) == GROUP_ROAD)
+    {
+      if (MP_INFO(xt,yt).int_1 < MAX_FOOD_ON_ROAD)
+	i = MAX_FOOD_ON_ROAD - MP_INFO(xt,yt).int_1;
+    }
+  else if (MP_GROUP(xt,yt) == GROUP_RAIL)
+    {
+      if (MP_INFO(xt,yt).int_1 < MAX_FOOD_ON_RAIL)
+	i = MAX_FOOD_ON_RAIL - MP_INFO(xt,yt).int_1;
+    }
+  i = (i * PORT_IMPORT_RATE) / 1000;
+  MP_INFO(xt,yt).int_1 += i;
+  return (i * PORT_FOOD_RATE);
+}
+
+static int
+buy_coal (int xt, int yt)
+{
+  int i = 0;
+  if (MP_GROUP(xt,yt) == GROUP_TRACK)
+    {
+      if (MP_INFO(xt,yt).int_3 < MAX_COAL_ON_TRACK)
+	i = MAX_COAL_ON_TRACK - MP_INFO(xt,yt).int_3;
+    }
+  else if (MP_GROUP(xt,yt) == GROUP_ROAD)
+    {
+      if (MP_INFO(xt,yt).int_3 < MAX_COAL_ON_ROAD)
+	i = MAX_COAL_ON_ROAD - MP_INFO(xt,yt).int_3;
+    }
+  else if (MP_GROUP(xt,yt) == GROUP_RAIL)
+    {
+      if (MP_INFO(xt,yt).int_3 < MAX_COAL_ON_RAIL)
+	i = MAX_COAL_ON_RAIL - MP_INFO(xt,yt).int_3;
+    }
+  i = (i * PORT_IMPORT_RATE) / 1000;
+  MP_INFO(xt,yt).int_3 += i;
+  return (i * PORT_COAL_RATE);
+}
+
+static int
+buy_ore (int xt, int yt)
+{
+  int i = 0;
+  if (MP_GROUP(xt,yt) == GROUP_TRACK)
+    {
+      if (MP_INFO(xt,yt).int_5 < MAX_ORE_ON_TRACK)
+	i = MAX_ORE_ON_TRACK - MP_INFO(xt,yt).int_5;
+    }
+  else if (MP_GROUP(xt,yt) == GROUP_ROAD)
+    {
+      if (MP_INFO(xt,yt).int_5 < MAX_ORE_ON_ROAD)
+	i = MAX_ORE_ON_ROAD - MP_INFO(xt,yt).int_5;
+    }
+  else if (MP_GROUP(xt,yt) == GROUP_RAIL)
+    {
+      if (MP_INFO(xt,yt).int_5 < MAX_ORE_ON_RAIL)
+	i = MAX_ORE_ON_RAIL - MP_INFO(xt,yt).int_5;
+    }
+  i = (i * PORT_IMPORT_RATE) / 1000;
+  MP_INFO(xt,yt).int_5 += i;
+  return (i * PORT_ORE_RATE);
+}
+
+static int
+buy_goods (int xt, int yt)
+{
+  int i = 0;
+  if (MP_GROUP(xt,yt) == GROUP_TRACK)
+    {
+      if (MP_INFO(xt,yt).int_4 < MAX_GOODS_ON_TRACK)
+	i = MAX_GOODS_ON_TRACK - MP_INFO(xt,yt).int_4;
+    }
+  else if (MP_GROUP(xt,yt) == GROUP_ROAD)
+    {
+      if (MP_INFO(xt,yt).int_4 < MAX_GOODS_ON_ROAD)
+	i = MAX_GOODS_ON_ROAD - MP_INFO(xt,yt).int_4;
+    }
+  else if (MP_GROUP(xt,yt) == GROUP_RAIL)
+    {
+      if (MP_INFO(xt,yt).int_4 < MAX_GOODS_ON_RAIL)
+	i = MAX_GOODS_ON_RAIL - MP_INFO(xt,yt).int_4;
+    }
+  i = (i * PORT_IMPORT_RATE) / 1000;
+  MP_INFO(xt,yt).int_4 += i;
+  return (i * PORT_GOODS_RATE);
+}
+
+
+static int
+buy_steel (int xt, int yt)
+{
+  int i = 0;
+  if (MP_GROUP(xt,yt) == GROUP_TRACK)
+    {
+      if (MP_INFO(xt,yt).int_6 < MAX_STEEL_ON_TRACK)
+	i = MAX_STEEL_ON_TRACK - MP_INFO(xt,yt).int_6;
+    }
+  else if (MP_GROUP(xt,yt) == GROUP_ROAD)
+    {
+      if (MP_INFO(xt,yt).int_6 < MAX_STEEL_ON_ROAD)
+	i = MAX_STEEL_ON_ROAD - MP_INFO(xt,yt).int_6;
+    }
+  else if (MP_GROUP(xt,yt) == GROUP_RAIL)
+    {
+      if (MP_INFO(xt,yt).int_6 < MAX_STEEL_ON_RAIL)
+	i = MAX_STEEL_ON_RAIL - MP_INFO(xt,yt).int_6;
+    }
+  i = (i * PORT_IMPORT_RATE) / 1000;
+  MP_INFO(xt,yt).int_6 += i;
+  return (i * PORT_STEEL_RATE);
+}
+
+static int
+sell_food (int xt, int yt)
+{
+  int i = 0;
+  i = (MP_INFO(xt,yt).int_1 * PORT_EXPORT_RATE) / 1000;
+  MP_INFO(xt,yt).int_1 -= i;
+  return (i * PORT_FOOD_RATE);
+}
+
+static int
+sell_coal (int xt, int yt)
+{
+  int i = 0;
+  i = (MP_INFO(xt,yt).int_3 * PORT_EXPORT_RATE) / 1000;
+  MP_INFO(xt,yt).int_3 -= i;
+  return (i * PORT_COAL_RATE);
+}
+
+static int
+sell_ore (int xt, int yt)
+{
+  int i = 0;
+  i = (MP_INFO(xt,yt).int_5 * PORT_EXPORT_RATE) / 1000;
+  MP_INFO(xt,yt).int_5 -= i;
+  return (i * PORT_ORE_RATE);
+}
+
+static int
+sell_goods (int xt, int yt)
+{
+  int i = 0;
+  i = (MP_INFO(xt,yt).int_4 * PORT_EXPORT_RATE) / 1000;
+  MP_INFO(xt,yt).int_4 -= i;
+  return (i * PORT_GOODS_RATE);
+}
+
+static int
+sell_steel (int xt, int yt)
+{
+  int i = 0;
+  i = (MP_INFO(xt,yt).int_6 * PORT_EXPORT_RATE) / 1000;
+  MP_INFO(xt,yt).int_6 -= i;
+  return (i * PORT_STEEL_RATE);
+}
+
 /* Trade with a transport.
  * Port is at x/y, transport at u/v. */
-void trade_connection( const int x, const int y, const int u, const int v, int* ic_ptr, int* et_ptr ){
+static void
+trade_connection( const int x, const int y, const int u, const int v, int* ic_ptr, int* et_ptr )
+{
   if (u >= 0 && v>=0 && (MP_INFO( u, v).flags
               & FLAG_IS_TRANSPORT) != 0)
   {
@@ -84,7 +252,6 @@
   }
 }
 
-
 void
 do_port (int x, int y)
 {

Modified: branches/waterwell/src/lincity/modules/rocket_pad.cpp
===================================================================
--- branches/waterwell/src/lincity/modules/rocket_pad.cpp	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity/modules/rocket_pad.cpp	2007-05-03 14:57:28 UTC (rev 1212)
@@ -7,6 +7,7 @@
 
 #include "modules.h"
 #include "gui_interface/screen_interface.h"
+#include "gui_interface/pbar_interface.h"
 #include "fire.h"
 //mouse.h" /* XXX: for fire_area! */
 #include "rocket_pad.h"
@@ -118,6 +119,74 @@
 }
 
 void
+remove_people (int num)
+{
+#if defined (commentout)
+  int x, y, f;
+  time_t t;
+  f = 1;
+  t = time (0);
+  while (f && (num > 0)) {
+      for (y = 0; y < WORLD_SIDE_LEN; y++)
+	for (x = 0; x < WORLD_SIDE_LEN; x++)
+	  if (MP_GROUP_IS_RESIDENCE(x,y) && MP_INFO(x,y).population > 0)
+	    {
+	      MP_INFO(x,y).population--;
+	      // f = 1;
+	      f |= (MP_INFO(x,y).population > 0);
+	      num--;
+	      total_evacuated++;
+	    }
+  }
+  while (num > 0 && people_pool > 0) {
+      num--;
+      total_evacuated++;
+      people_pool--;
+  }
+#endif
+
+  int x, y;
+  /* reset housed population so that we can display it correctly */
+  housed_population = 1;
+  while (housed_population && (num > 0)) {
+      housed_population = 0;
+      for (y = 0; y < WORLD_SIDE_LEN; y++)
+	for (x = 0; x < WORLD_SIDE_LEN; x++)
+	  if (MP_GROUP_IS_RESIDENCE(x,y) && MP_INFO(x,y).population > 0) {
+	      MP_INFO(x,y).population--;
+	      housed_population += MP_INFO(x,y).population;
+	      num--;
+	      total_evacuated++;
+	  }
+  }
+  while (num > 0 && people_pool > 0) {
+      num--;
+      total_evacuated++;
+      people_pool--;
+  }
+
+  refresh_population_text ();
+
+#if defined (commentout)
+/* last ship wasn't full so everyone has gone. */
+  if (num > 0)
+    {
+      if (t > HOF_START && t < HOF_STOP)
+	ok_dial_box ("launch-gone-mail.mes", GOOD, 0L);
+      else
+	ok_dial_box ("launch-gone.mes", GOOD, 0L);
+      housed_population = 0;
+    }
+#endif
+
+  /* Note that the previous test was inaccurate.  There could be 
+     exactly 1000 people left. */
+  if (!housed_population && !people_pool) {
+    ok_dial_box ("launch-gone.mes", GOOD, 0L);
+  }
+}
+
+void
 launch_rocket (int x, int y)
 {
     int i, r, xx, yy, xxx, yyy;

Modified: branches/waterwell/src/lincity/modules/shanty.cpp
===================================================================
--- branches/waterwell/src/lincity/modules/shanty.cpp	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity/modules/shanty.cpp	2007-05-03 14:57:28 UTC (rev 1212)
@@ -61,28 +61,9 @@
   numof_shanties++;
 }
 
-void
-remove_a_shanty (void)
-{
-  int x, y, r;
-  if (numof_shanties <= 0)
-    return;
-  x = rand () % WORLD_SIDE_LEN;
-  y = rand () % WORLD_SIDE_LEN;
-  r = spiral_find_group (x, y, GROUP_SHANTY);
-  if (r == -1) {
-      printf ("Can't find a shanty to remove! ?\n");
-      return;
-  }
-  y = r / WORLD_SIDE_LEN;
-  x = r % WORLD_SIDE_LEN;
-  /* decrement of numof_shanties is done in fire area() */
-  fire_area (x, y);
-  /* now put the fire out */
-  MP_INFO(x,y).int_2 = FIRE_LENGTH + 1;
-  MP_INFO(x + 1,y).int_2 = FIRE_LENGTH + 1;
-  MP_INFO(x,y + 1).int_2 = FIRE_LENGTH + 1;
-  MP_INFO(x + 1,y + 1).int_2 = FIRE_LENGTH + 1;
+void remove_a_shanty (int x, int y) {
+    numof_shanties--;
+    fire_area (x, y);
 }
 
 void
@@ -91,14 +72,27 @@
   int i, pp;
   pp = people_pool - (COMMUNE_POP * numof_communes);
   i = (pp - SHANTY_MIN_PP) / SHANTY_POP;
-  if (i > numof_shanties)
-    add_a_shanty ();		/*                   vv-- schmitt trigger */
-
-  else if (numof_shanties > 0 && i < (numof_shanties - 1))
-    remove_a_shanty ();
-  else if (numof_shanties > 0 && rand () % 100 == 10)
-    remove_a_shanty ();		/* randomly close some down. */
-
+  if (i > numof_shanties) {
+      add_a_shanty ();
+  } else if ( numof_shanties > 0 && 
+                    ( i < (numof_shanties - 1) || rand () % 100 == 1) ) {
+        int x, y, r;
+        x = rand () % WORLD_SIDE_LEN;
+        y = rand () % WORLD_SIDE_LEN;
+        r = spiral_find_group (x, y, GROUP_SHANTY);
+        if (r == -1) {
+            fprintf (stderr,"Can't find a shanty to remove!\n");
+            return;
+        }
+        y = r / WORLD_SIDE_LEN;
+        x = r % WORLD_SIDE_LEN;
+        remove_a_shanty(x,y);  /* this will fire_area */
+        /* now put the fire out: it becomes impossible to bulldoze */
+        MP_INFO(x,y).int_2 = FIRE_LENGTH + 1;
+        MP_INFO(x + 1,y).int_2 = FIRE_LENGTH + 1;
+        MP_INFO(x,y + 1).int_2 = FIRE_LENGTH + 1;
+        MP_INFO(x + 1,y + 1).int_2 = FIRE_LENGTH + 1;
+  }
 }
 
 void

Modified: branches/waterwell/src/lincity/modules/shanty.h
===================================================================
--- branches/waterwell/src/lincity/modules/shanty.h	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity/modules/shanty.h	2007-05-03 14:57:28 UTC (rev 1212)
@@ -9,7 +9,7 @@
 #define __shanty_h__
 
 void add_a_shanty(void);
-void remove_a_shanty(void);
+void remove_a_shanty(int x, int y);
 void update_shanty(void);
 void do_shanty(int x, int y);
 

Modified: branches/waterwell/src/lincity/simulate.cpp
===================================================================
--- branches/waterwell/src/lincity/simulate.cpp	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity/simulate.cpp	2007-05-03 14:57:28 UTC (rev 1212)
@@ -51,8 +51,8 @@
 static void random_start (int* originx, int* originy);
 static void simulate_mappoints (void);
 static void quick_start_add (int x, int y, short type, int size);
+static void nullify_mappoint (int x, int y);
 static void setup_land (void);
-static void nullify_mappoint (int x, int y);
 
 #define IS_RIVER(x,y) (MP_INFO(x,y).flags & FLAG_IS_RIVER)
 
@@ -453,10 +453,10 @@
     rockets_launched_success = 0;
     init_inventory();
     update_avail_modules(0);
+    /* Al1. NG 1.1 is this enough ? Are all global variables reseted ? */
+    /* TODO reset screen, sustain info */
     use_waterwell = true;
     ldsv_version = MIN_WATERWELL_VERSION;
-    /* Al1. NG 1.1 is this enough ? Are all global variables reseted ? */
-    /* TODO reset screen, sustain info */
 }
 
 void

Modified: branches/waterwell/src/lincity-ng/MainLincity.cpp
===================================================================
--- branches/waterwell/src/lincity-ng/MainLincity.cpp	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity-ng/MainLincity.cpp	2007-05-03 14:57:28 UTC (rev 1212)
@@ -55,9 +55,11 @@
   Uint32 now=SDL_GetTicks();
   Uint32 mStepTime=( lincitySpeed *1000/NUMOF_DAYS_IN_YEAR); 
 
-  if( lincitySpeed == 0 || blockingDialogIsOpen )
+  if( lincitySpeed == 0 || blockingDialogIsOpen
+        || ( (now - oldTime < (mStepTime-10)) && (lincitySpeed != FAST_TIME_FOR_YEAR)) ) {
+      SDL_Delay(10); //don't burn cpu in active loop
       return;
-
+  }
   if ( (now - oldTime < mStepTime) && lincitySpeed != FAST_TIME_FOR_YEAR  )
     return; // skip frame
   oldTime = now;

Modified: branches/waterwell/src/lincity-ng/MapEdit.cpp
===================================================================
--- branches/waterwell/src/lincity-ng/MapEdit.cpp	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity-ng/MapEdit.cpp	2007-05-03 14:57:28 UTC (rev 1212)
@@ -56,46 +56,6 @@
     new Dialog( EDIT_MARKET, x, y );
 }
 
-void 
-no_credit_build_msg (int selected_group)
-{
-    if( last_message_group == selected_group ){
-        return;
-    }
-    last_message_group = selected_group;
-#ifdef GROUP_SOLAR_POWER_NO_CREDIT
-  if (selected_group == GROUP_SOLAR_POWER) {
-    ok_dial_box ("no-credit-solar-power.mes", BAD, 0L);
-    return;
-  }
-#endif
-#ifdef GROUP_UNIVERSITY_NO_CREDIT
-  if (selected_group == GROUP_UNIVERSITY) {
-    ok_dial_box ("no-credit-university.mes", BAD, 0L);
-    return;
-  }
-#endif
-#ifdef GROUP_PARKLAND_NO_CREDIT
-  if (selected_group == GROUP_PARKLAND) {
-    ok_dial_box ("no-credit-parkland.mes", BAD, 0L);
-    return;
-  }
-#endif
-#ifdef GROUP_RECYCLE_NO_CREDIT
-  if (selected_group == GROUP_RECYCLE) {
-    ok_dial_box ("no-credit-recycle.mes", BAD, 0L);
-    return;
-  }
-#endif
-#ifdef GROUP_ROCKET
-  if (selected_group == GROUP_ROCKET) {
-    ok_dial_box ("no-credit-rocket.mes", BAD, 0L);
-    return;
-  }
-#endif
-  return;
-}
-
 void
 check_bulldoze_area (int x, int y)
 {
@@ -295,24 +255,32 @@
             selected_module_type = CST_PARKLAND_PLANE;
     }
 
-    /* Place the selected item */
-    switch (place_item (x, y, selected_module_type))
+    /* Place the selected item . Warning messages are managed by place_item(...) */
+    last_message_group = place_item (x, y, selected_module_type);
+    switch (last_message_group)
     {
         case 0:
             /* Success */
             getSound()->playSound( "Build" );
-            last_message_group = 0;
             break;
+        case -1000:
+            /* ouch group does not exist */
         case -1:
             /* Not enough money */
-            no_credit_build_msg (selected_module_group);
-            break;
         case -2:
             /* Improper port placement */
-            // WolfgangB: The correct placement for the port (river to the east)
-            // is shown by red/blue cursor in GameView. So we don't need    
-            // a dialog here.
+        case -3:
+            /* too many windmills/substations */
+        case -4:
+            /* too many market */
+        case -5:
+            /* previous tip here, cannot build tip here */
+        case -6:
+            /* previous tip here, cannot build oremine */
+        case -7:
+            /* no ore reserve. cannot build oremine here */
+        default:
+            /* warning messages are managed by place item */
             last_message_group = 0;
-            break;
     }
 }

Modified: branches/waterwell/src/lincity-ng/ScreenInterface.cpp
===================================================================
--- branches/waterwell/src/lincity-ng/ScreenInterface.cpp	2007-05-01 10:38:03 UTC (rev 1211)
+++ branches/waterwell/src/lincity-ng/ScreenInterface.cpp	2007-05-03 14:57:28 UTC (rev 1212)
@@ -149,15 +149,18 @@
  * 
  * see oldgui/screen.cpp: ok_dial_box (char *fn, int good_bad, char *xs)
  *
- * good_bad influences the color: GOOD, RESULTS in green
+ * in oldgui good_bad influences the color:
+ *                                GOOD, RESULTS in green
  *                                BAD in red
  *                                default white
+ * in NG good_bad is reseted to void !!!
+ *
  * fn is the FileName of the message
  *   if good_bad is RESULTS the fn is an absolute filename else
  *   it is a File in message_path.                              
  * 
  * xs is some additional Text, that is shown after the Message
- *    from the File. (maybe XtraString?)  
+ *    from the File. ( XtraString )  
  */
 void ok_dial_box (const char *fn, int good_bad, const char *xs)
 {
@@ -167,7 +170,7 @@
     } catch(std::exception& e) {
         std::cerr << "Problem with ok_dial_box: " << e.what() << "\n";
         std::ostringstream text;
-        text << "ok_dial_box:'" << fn << "' + \"" << (xs ? xs : "") << "\"\n";
+        text << "Problem with ok_dial_box: '" << fn << "' + \"" << (xs ? xs : "") << "\"\n";
         updateMessageText( text.str() );
     }
 }
@@ -285,48 +288,6 @@
 }
 
 /*
- *  Draw a Dialogbox, in oldgui/screen.cpp it is called from the 
- *  other Dialog Functions to do the actual drawing.
- *  TODO: at the moment we just dump the Text in the MessageArea...
- *
- *  see oldgui/dialbox.cpp 
- *  -there must be just one DialogBox at a time.
- *  colour is the color of the Background of the Dialog
- *
- *  Do we use dialog_box at all? Unfortunately yes. There is a lot of legacy code...
- *  
- *  argc is the number of following argument triplets.
- *  Each triplet consists of
- *      type, key, string
- *      type is an integer that describes this entry
- *          0 = it is a text to display
- *          2 = a button 
- *      key 
- *        a char as hotkey for the button
- *        10 (LF), 13(CR) or ' '(blank)
- *        are used to mark the default button
- *        also key is returned as result of the Dialog if the corespondending Button is pressed.
- *           
- *      string is the text
- */
-int dialog_box(int colour, int argc, ...)
-{
-    (void) colour;
-
-    std::ostringstream text;
-    va_list arg;
-    va_start( arg, argc );
-     for( int i = 0; i < argc; i++ ) {
-        text << std::cout <<  va_arg( arg, int ) << " '"<<  va_arg( arg, int )  << "' " << va_arg( arg, char* ) <<"\n";
-     }
-    va_end( arg );    
-    
-    updateMessageText(  text.str() );
-    
-    return 0;
-}
-
-/*
  *  A DialogBox with a Progressbar.
  *  see oldgui/screen.cpp: prog_box (char *title, int percent)
  *  is used to open a Dialog with given Title an a Progressbar,



From alainb at mail.berlios.de  Fri May  4 01:18:48 2007
From: alainb at mail.berlios.de (alainb at BerliOS)
Date: Fri, 4 May 2007 01:18:48 +0200
Subject: [Lincity-ng-commit] r1213 - in branches/waterwell: . doc
	src/lincity src/lincity/modules
Message-ID: <200705032318.l43NImB7011399@sheep.berlios.de>

Author: alainb
Date: 2007-05-04 01:18:47 +0200 (Fri, 04 May 2007)
New Revision: 1213

Modified:
   branches/waterwell/README-TODO-WaterWell
   branches/waterwell/doc/units
   branches/waterwell/src/lincity/engine.cpp
   branches/waterwell/src/lincity/modules/commune.cpp
Log:
communes production depends on water, parks need water
 Probable bug: population decrease with random village! 

Modified: branches/waterwell/README-TODO-WaterWell
===================================================================
--- branches/waterwell/README-TODO-WaterWell	2007-05-03 14:57:28 UTC (rev 1212)
+++ branches/waterwell/README-TODO-WaterWell	2007-05-03 23:18:47 UTC (rev 1213)
@@ -5,33 +5,45 @@
 
 HELP NEEDED:
 ------------
-- Better graphic for icon and tile. (i did my best but its not enough ;-)
+ -Better graphic for icon and tile. (i did my best but its not enough ;-)
+ -sound for waterwell tile.
+  
+BUGS:
+-----
+ -population decrease in initial random village ! FIXME
+ -icon, tile (hmmm, must be redrawn by someone competent)
+ -info with query tool seems to not work on desert and trees, or work randomly
 
 WIP:
 ----
 basic water management implemented:
  -icon, tile (hmmm, must be redrawn by someone competent)
- -help (en), info with query tool and in residences.
  -residence need water like food. Lack of water has the same consequences as lack of food.
  -random village has a water well.
- -farm output depend of underground water: initial desert tile have no underground water
- -2 scenarios: extreme_arid and extreme_wetland    (random village is in between)
-
+ -initial desert tiles have no underground water (added flag has_underground_water)
+ -farm output depend of underground water
+ -2 scenarios: extreme_arid and extreme_wetland (random village is in between)
+ -Tuning of aridity parameter and others.
+  
 TODO: 
 -----
+* help (en), info with query tool, (waterwell, residences, farms, communes, parks, pollution)
 * Tuning of aridity parameter and others.
-* show well's range in starvation window (<= market range)
-* residence near river should not need water well.
+* show well's range in starvation window (<= market range) // ? display numof_waterwell in stat window ?
 * load/save numof_waterwell and display it in stat window. (current load/save works)
 * sound.
-* basic ecology
-
+* basic ecology: change desert with UGW (= bulldozed tile) to green after some monthes.
+   (needed for showing UGW for placing farms etc ...)
+ 
 * tile property ++ water, underground_pollution, ore_reserve, coal_reserve, waste
 * annual event = waste => pollution diffusion and slow diminution (1000 years)
-* computer water in land at start.
-  - show it in mining view.
-  - Farm and commune efficiency x= min (1,#tile_with_underground_water/8)
-
+	In NG_1.1 already, tips slowly degrade to green.
+  
++ * computer water in land at start. (FLAG_HAS_UNDERGROUND_WATER)
+    - show it in mining view.
++   - commune efficiency x= min (1,#tile_with_underground_water/8)
++   - parks need underground water (maybe also 'or 2 neighbouring tile with UGW')
+  
 AIM:
 ----
 * simple ecology = periodic event :
@@ -40,21 +52,25 @@
    - water ++%increase
    = just look nicer (change nothing in the game) but could show impact of human activities on forests :)
 
-* farms, industries also need water (connection needed?, or pipes?)
-
 * Water quality (from drinkable to mortal).
+  - tile property ++ UG_water, UG_pollution, UG_waste , UG_altitude.
   - residences, farms and industries can pollute water.
   - park along a river or around a well will also reduce the pollution.
-  - pollution transported by river will follow the flow, so travel toward the bottom
-      of the map (y++) (roughtly opposite of wind direction :-)
+  - altitude to know the local slope and the drainage basin.
+        unit 1cm        +1/tile is enough slope for calm river, large river => +0/tile,
+                        coast line +100, land + rand() % mountainity per tile.
+        maybe just UGW_altitude. Need to be tested and displayed in altitude minimap.
+        pb: ugw motion with desert tile
+  - annual event = waste => pollution diffusion and slow diminution (1000 years)
+  - pollution transported by water will follow the slope, so go in river and travel toward the bottom
+      of the map (roughtly opposite of wind direction :-)
 
-* think of how to import existing games without killing all population by thirstyness.
-  (maybe just add a new version to check at load time if water management should be enabled)
-
 Won't do soon:
 --------------
 * Areas without water could need high-tech deep well and/or pipes to feed the water station.
 
+* residence near river should not need water well.
+
 * transport capacity for water = water_on_road, water_on rail.... ?
   This mean quantity management of water. can be very tricky in addition to quality.
   rev 1170 uses range, so no need for transport.
@@ -62,6 +78,8 @@
 
 * fire/health cover in dry area should cost more (need more equipment ...)
 
+* industries also need water (connection needed?, or pipes?)
+
 REMARKS/NOTES:
 --------------
 Don't consider this is important, it's just some ideas i have while wandering in the
@@ -69,16 +87,18 @@
 or put them in the wiki.
 
 * random village is placed near water in original lincity :) 
-  (see src/lincity/simulate.cpp random_start near line 610)
+  (see src/lincity/simulate.cpp random_start)
 
 * Code contains obsolete stuff from old lincity (eg .csi references ...). Maybe a clean up should
  be considered, but that can be a big job with compatibility issues.
  (so in another branch, and later as far as i m concerned :-)
 
-* better separation of engine and graphics could be nice for future:
-   - a building gives: tech at build time, average state (production %) during last period
+* separation of engine and graphics is rather good
+   - additional data structure could be useful
+        map += group_xyz_no_credit + underground missing stuff + empty slots for future improvements.
+   - a building gives: tech at build time, average state (needs %, production %) during last period
    - the drawing modules uses the info to choose correct tile, and manage looping for
-     cleaner animation (currently fast speed skip frames => weird animation).
+                cleaner animation (currently fast speed skip frames => weird animation).
 
 * With market range, everything can already jump accross rivers.
 * rivers are ready for transport: in lin-city.h  
@@ -96,7 +116,21 @@
              (group == GROUP_RAIL) || \
              (group == GROUP_POWER_LINE))
   Beach scenario could cause trouble (stock many thing in the sea !).
+  FLAG_IS_RIVER (=navigable) should allow to control this: 
+  	coast line = navigable = RIVER
+	off shore = not navigable = WATER
+  In current version (1195), in Beach all the sea is navigable.
 
+* Speed of transport: (must think of this and look more carefully)
+  afaik speed of transport +-= 1 tile/iteration for all transports
+  it could be set to different value: speed = N <=> N iteration
+  track_speed = 1
+  road_speed = 2
+  train_speed = 3
+  river_speed = 0.3 but huge capacity for coal,ore and steel.
+  	low speed should prevent absorbing everything, but once the
+	river is loaded it should be a nice transport.
+
 * Parks are not entertainment parks. They are biological depollution tool
  => they are build in very polluted areas (sometimes mortal)
  => no child games should appear there!
@@ -106,6 +140,9 @@
 * Graphic before rail techlevel should not have cars, but horses and bullocks instead.
 * Low tech houses looks too modern.
 
-* non-navigable waters (not seas) could very slowly become green (less than 1/1000 chance per year)
+* non-navigable waters (not seas) could very slowly become green
+        less than 1/1000 chance per year, inversely proportionnal to surface.
 
 * Minimap size is hardcoded 200 pixel = 2x WORLD_SIDE_LEN. Probably need to use pixel for sharp graphics.
+
+

Modified: branches/waterwell/doc/units
===================================================================
--- branches/waterwell/doc/units	2007-05-03 14:57:28 UTC (rev 1212)
+++ branches/waterwell/doc/units	2007-05-03 23:18:47 UTC (rev 1213)
@@ -0,0 +1,87 @@
+Some orders of magnitudes to check engine internals and try to display realistic units.
+
+POWER
+=====
+Power unit is 1kW
+=> Coal unit = 100 kg   (coal power plant and coal_make_power)
+
+Discussion power:
+_________________
+
+some RL indicators picked in wikipedia and other sites in 2007:
+ 1 ton equivalent oil
+    = 40 GJ
+    = 1.5 tons of coal
+    = gives 11 MW.h of thermic power
+    = gives less than 5 MW.h of electic power in thermic power plant
+    = production of 1 ton biofuel by 1 hectare (4t of biomass)
+        sometimes 2 crops/year.
+         (variable by a factor 0.5 to 2) 
+         (need to add work and water and fertilizer ...)
+    = sun at midday on 1 hectare during one hour 
+         (1000 W/m2, average on earth= 350 W/m2)
+    = power produced by a 10 ha solarplant.(10% efficiency)
+
+Big offshore windmill = 5 MW
+Big solar plant = 350 MW
+Big coal powerplant = 700 MW
+
+100 MW = 50 000 citizens
+
+build cost:
+-----------
+ clean coal power station:  1 MW = 1 M?  +need to be fed by tons of coal/day
+ solar plant / bio / wind:  1 MW = 2 M?
+
+prices:
+-------
+ oil 350?/ton equivalent oil
+ coal 50~100?/ton equivalent oil
+ bio  50~500?/ton equivalent oil
+ sun/wind/river  0?
+
+=> in NG
+--------
+ Windmill and solar power prices are rather realistic
+ but coal_power plants are far too much cheap 
+ even if we consider 10% efficiency for windmill and sunplant, there is still
+ a factor 3 in favor of coal plants. (moreover they don't pay the coal in NG
+ except when it is imported.
+ The only counter-part is the coal reserve are finite, even if sometimes they
+ are huge.
+
+=> idea:
+--------
+Like windmill add high tech thermic power plant and change as little as possible:
+ - price *=  1 + 2 * (tech - coalpower_tech)   (doesn't break too much)
+ - pollution -= some % tech
+ - check box to use food or coal
+
+Production of one farm of tech T gives enough biomass to produce the same amount
+of power as a solar plant of the same tech.
+
+
+ORE/STEEL
+=========
+RL:
+---
+average earth crust is 4% iron
+rich iron ore = 50% iron
+
+NG:
+--
+heavy industry : 16 ore -> 1 steel
+this is ok considering that ore is average earth crust (we can dig everywhere)
+
+need to find energy needed for producing steel to have steel weight unit in NG,
+then ore weight unit :)
+
+MAX_COAL_ON_TRACK 64    unit = 100 kg
+MAX_ORE_ON_TRACK 4096
+MAX_STEEL_ON_TRACK 128
+
+MAX_COAL_ON_ROAD (MAX_COAL_ON_TRACK * 8) = 512*100 = 51.2 tons
+MAX_ORE_ON_ROAD (MAX_ORE_ON_TRACK * 4) = 16384 ore_unit
+MAX_STEEL_ON_ROAD (MAX_STEEL_ON_TRACK * 4) = 512 steel_unit
+
+MAX_XXX_ON_RAIL (MAX_XXXX_ON_ROAD * same_coeff_as_road_vs_track)

Modified: branches/waterwell/src/lincity/engine.cpp
===================================================================
--- branches/waterwell/src/lincity/engine.cpp	2007-05-03 14:57:28 UTC (rev 1212)
+++ branches/waterwell/src/lincity/engine.cpp	2007-05-03 23:18:47 UTC (rev 1213)
@@ -281,6 +281,13 @@
     case GROUP_WATERWELL:
 	numof_waterwell++;
         break;
+    case GROUP_PARKLAND:
+        if (use_waterwell)
+            if (!HAS_UGWATER(x,y)) {
+                ok_dial_box("warning.mes", BAD,
+                        _("You can't build a park here: it is a desert, parks need water"));
+                return -8;
+            }
 
     } /* end case */
     last_warning_message_group = 0;

Modified: branches/waterwell/src/lincity/modules/commune.cpp
===================================================================
--- branches/waterwell/src/lincity/modules/commune.cpp	2007-05-03 14:57:28 UTC (rev 1212)
+++ branches/waterwell/src/lincity/modules/commune.cpp	2007-05-03 23:18:47 UTC (rev 1213)
@@ -23,28 +23,42 @@
   /* GCS -- I folded the trackflag into int_2, changing the logic slightly.
      This change only affects the animation. */
   int trackflag = 0;
+  int coalprod = 2;
   /* stick coal and ore on tracks, in SMALL doses. */
-  if (put_coal (x, y, 2) != 0)
-    {
+  if (use_waterwell) {
+      int w = 0;
+      int n = 0;
+      /* Check underground water, and reduce production accordingly */
+      for (int i = 0; i < MP_SIZE(x,y); i++) {
+          for (int j = 0; j < MP_SIZE(x,y); j++) {
+              n++;
+              if (HAS_UGWATER(x+i,y+j))
+                  w++;
+          }
+      }
+      if (w < n / 3) 
+          coalprod = 0;
+      else if (w < (2 * n) / 3)
+          coalprod = 1;
+  }
+
+  if (put_coal (x, y, coalprod) != 0) {
       trackflag = 1;
       MP_INFO(x,y).int_3++;
       MP_INFO(x,y).int_6 |= 1;
-    }
-  if (put_ore (x, y, 6) != 0)
-    {
+  }
+  if (put_ore (x, y, 6) != 0) {
       trackflag = 1;
       MP_INFO(x,y).int_3++;
       MP_INFO(x,y).int_6 |= 2;
-    }
+  }
   /* recycle a bit of waste */
-  if (get_waste (x, y, 20) != 0)
-    {
+  if (get_waste (x, y, 20) != 0) {
       trackflag = 1;
       MP_INFO(x,y).int_3++;
       MP_INFO(x,y).int_6 |= 8;
-    }
-  if (total_time % 10 == 0)
-    {
+  }
+  if (total_time % 10 == 0) {
       MP_INFO(x,y).int_2 = 1;
       if (put_steel (x, y, 2) != 0) {
 	  MP_INFO(x,y).int_3++;
@@ -55,38 +69,50 @@
       if (trackflag) {
 	MP_INFO(x,y).int_2 = 0;
       }
-    }
+  }
 
-  if (total_time % 100 == 48){
+  /* each month. /AL1: is there a reason for day 48 ? */
+  if (total_time % 100 == 1) {
     MP_INFO(x,y).int_5 = MP_INFO(x,y).int_6;
     MP_INFO(x,y).int_6 = 0;
     if (MP_INFO(x,y).int_5 & 4) { //producing steel
-      if (MP_TYPE(x,y) < CST_COMMUNE_7){
+        if (MP_TYPE(x,y) < CST_COMMUNE_7){
 	    MP_TYPE(x,y) += 5;
-      }
+        }
     } else {
         if (MP_TYPE(x,y) >= CST_COMMUNE_7){
 	        MP_TYPE(x,y) -= 5;
         }
     }
 
-      if (MP_INFO(x,y).int_3 > 0)	/*  >0% */
-	{
+    if (MP_INFO(x,y).int_3 > 0)	/*  >0% */ {
 	  MP_INFO(x,y).int_3 = 0;
 	  if (--MP_INFO(x,y).int_4 < 0)
-	    MP_INFO(x,y).int_4 = 0;
-	}
-      else
-	{
+              MP_INFO(x,y).int_4 = 0;
+    } else {
 	  MP_INFO(x,y).int_3 = 0;
 	  MP_INFO(x,y).int_4++;
-	  /* XXX: Why do communes only last 10 years? */
-	  if (MP_INFO(x,y).int_4 > 120)	/* 10 years */
-	    {
-	      do_bulldoze_area (CST_PARKLAND_PLANE, x, y);
+	  /* Communes without production only last 10 years */
+	  if (MP_INFO(x,y).int_4 > 120)	/* 10 years */ {
+              if (use_waterwell) {
+                  int s =  MP_SIZE(x,y);
+                  /* first destroy the commune, then fill it with correct tiles
+                   * maybe paranoid, but tile is 4x4 thus becomes 16 tiles 1x1
+                   */
+                  do_bulldoze_area (CST_DESERT, x, y);
+                  for (int i = 0; i < s; i++) {
+                      for (int j = 0; j < s; j++)
+                          if (HAS_UGWATER(x+i,y+j))
+                                do_bulldoze_area (CST_PARKLAND_PLANE, x+i, y+j);
+                          else
+                                do_bulldoze_area (CST_DESERT, x+i, y+j);
+                  }
+              } else {
+                  do_bulldoze_area (CST_PARKLAND_PLANE, x, y);
+              }
 	      return;
-	    }
-	}
+          }
+    }
   }
 
   /* animate */



From alainb at mail.berlios.de  Fri May  4 19:57:07 2007
From: alainb at mail.berlios.de (alainb at BerliOS)
Date: Fri, 4 May 2007 19:57:07 +0200
Subject: [Lincity-ng-commit] r1214 - in branches/waterwell: . src/lincity
	src/lincity/modules src/lincity-ng
Message-ID: <200705041757.l44Hv7HS032147@sheep.berlios.de>

Author: alainb
Date: 2007-05-04 19:57:06 +0200 (Fri, 04 May 2007)
New Revision: 1214

Modified:
   branches/waterwell/README-TODO-WaterWell
   branches/waterwell/src/lincity-ng/GameView.cpp
   branches/waterwell/src/lincity-ng/MiniMap.cpp
   branches/waterwell/src/lincity/engine.cpp
   branches/waterwell/src/lincity/engine.h
   branches/waterwell/src/lincity/modules/residence.cpp
   branches/waterwell/src/lincity/simulate.cpp
Log:
-fix birth bug
-display range around cursor and in starvation minimap
-basic ecology: bulldozed tiles becomes green again after some time

Modified: branches/waterwell/README-TODO-WaterWell
===================================================================
--- branches/waterwell/README-TODO-WaterWell	2007-05-03 23:18:47 UTC (rev 1213)
+++ branches/waterwell/README-TODO-WaterWell	2007-05-04 17:57:06 UTC (rev 1214)
@@ -10,43 +10,33 @@
   
 BUGS:
 -----
- -population decrease in initial random village ! FIXME
  -icon, tile (hmmm, must be redrawn by someone competent)
  -info with query tool seems to not work on desert and trees, or work randomly
+ -bug of trunk = (re)initialisation of engine and UI is not enough.
 
 WIP:
 ----
 basic water management implemented:
- -icon, tile (hmmm, must be redrawn by someone competent)
  -residence need water like food. Lack of water has the same consequences as lack of food.
  -random village has a water well.
+ -well's range is shown in starvation window and around cursor
  -initial desert tiles have no underground water (added flag has_underground_water)
- -farm output depend of underground water
+ -farm and charcoal (in communes) production depends on underground water
+ -parks need ugw (no park on true desert tile)
  -2 scenarios: extreme_arid and extreme_wetland (random village is in between)
- -Tuning of aridity parameter and others.
+ -basic ecology: change desert with UGW (= bulldozed tile) to green after some monthes.
+   (needed for showing UGW for placing farms communes and parks)
+ -Tuning of aridity parameter and others (communes, farms, parks) seems rather correct.
   
 TODO: 
 -----
-* help (en), info with query tool, (waterwell, residences, farms, communes, parks, pollution)
-* Tuning of aridity parameter and others.
-* show well's range in starvation window (<= market range) // ? display numof_waterwell in stat window ?
-* load/save numof_waterwell and display it in stat window. (current load/save works)
-* sound.
-* basic ecology: change desert with UGW (= bulldozed tile) to green after some monthes.
-   (needed for showing UGW for placing farms etc ...)
+* additional tiles for desert (like water)
+* help (en), info with query tool, (waterwell, residences, farms, communes, parks)
  
-* tile property ++ water, underground_pollution, ore_reserve, coal_reserve, waste
-* annual event = waste => pollution diffusion and slow diminution (1000 years)
-	In NG_1.1 already, tips slowly degrade to green.
-  
-+ * computer water in land at start. (FLAG_HAS_UNDERGROUND_WATER)
-    - show it in mining view.
-+   - commune efficiency x= min (1,#tile_with_underground_water/8)
-+   - parks need underground water (maybe also 'or 2 neighbouring tile with UGW')
-  
 AIM:
 ----
 * simple ecology = periodic event :
+   - probably need additional property (global aridity, tile_aridity_table_pointer)
    - neighbours  => % decrease/increase from desert to tree3. (tree3 need 4 neighbouring trees)
    - pollution ++%decrease
    - water ++%increase
@@ -54,19 +44,22 @@
 
 * Water quality (from drinkable to mortal).
   - tile property ++ UG_water, UG_pollution, UG_waste , UG_altitude.
-  - residences, farms and industries can pollute water.
-  - park along a river or around a well will also reduce the pollution.
   - altitude to know the local slope and the drainage basin.
         unit 1cm        +1/tile is enough slope for calm river, large river => +0/tile,
                         coast line +100, land + rand() % mountainity per tile.
         maybe just UGW_altitude. Need to be tested and displayed in altitude minimap.
-        pb: ugw motion with desert tile
-  - annual event = waste => pollution diffusion and slow diminution (1000 years)
+        pb: ugw motion with desert tile:
+                -probably need some iterations during creation to draw a path.
+                -allow diagonal motion
+  - residences, farms and industries can pollute water.
+  - park along a river or around a well will also reduce the pollution.
   - pollution transported by water will follow the slope, so go in river and travel toward the bottom
       of the map (roughtly opposite of wind direction :-)
+  - annual event = waste => pollution diffusion and slow diminution (1000 years)
+	In NG_1.1 already, tips slowly degrade to green.
 
-Won't do soon:
---------------
+Won't do soon, maybe never:
+---------------------------
 * Areas without water could need high-tech deep well and/or pipes to feed the water station.
 
 * residence near river should not need water well.
@@ -86,6 +79,8 @@
 code. I write them here instead of somewhere else, but maybe i will just forget them later,
 or put them in the wiki.
 
+* initialise with srand (time) and add command line option --seed (easier debugging)
+
 * random village is placed near water in original lincity :) 
   (see src/lincity/simulate.cpp random_start)
 

Modified: branches/waterwell/src/lincity/engine.cpp
===================================================================
--- branches/waterwell/src/lincity/engine.cpp	2007-05-03 23:18:47 UTC (rev 1213)
+++ branches/waterwell/src/lincity/engine.cpp	2007-05-04 17:57:06 UTC (rev 1214)
@@ -627,6 +627,17 @@
   fire_area (x, y);
 }
 
+void do_daily_ecology ()
+{
+    for (int x = 0; x < WORLD_SIDE_LEN; x++)
+        for (int y = 0; y < WORLD_SIDE_LEN; y++) {
+            /* approximately 3 monthes needed to turn bulldoze area into green */
+            if (MP_GROUP(x,y) == GROUP_DESERT && HAS_UGWATER(x,y) 
+                    && rand() %300 == 1)
+                do_bulldoze_area(CST_GREEN, x, y);
+        }
+}
+
 /*
    // spiral round from startx,starty until we hit something of group group.
    // return the x y coords encoded as x+y*WORLD_SIDE_LEN

Modified: branches/waterwell/src/lincity/engine.h
===================================================================
--- branches/waterwell/src/lincity/engine.h	2007-05-03 23:18:47 UTC (rev 1213)
+++ branches/waterwell/src/lincity/engine.h	2007-05-04 17:57:06 UTC (rev 1214)
@@ -14,6 +14,7 @@
 void connect_rivers (void);
 int adjust_money(int value);
 void fire_area (int x, int y);
+void do_daily_ecology (void);
 
 extern long real_time;
 

Modified: branches/waterwell/src/lincity/modules/residence.cpp
===================================================================
--- branches/waterwell/src/lincity/modules/residence.cpp	2007-05-03 23:18:47 UTC (rev 1213)
+++ branches/waterwell/src/lincity/modules/residence.cpp	2007-05-04 17:57:06 UTC (rev 1214)
@@ -26,6 +26,7 @@
     int hc = 0;                      /* have health cover ? */
     int brm = 0, drm = 0;            /* birth/death rate modifier */
     int cc = 0;
+    int birth_flag=0;
 
     p = MP_INFO(x,y).population;
     if ((MP_INFO(x,y).flags & FLAG_HEALTH_COVER) != 0)
@@ -70,10 +71,14 @@
 	}
     }
     /* normal births - must have food, water and jobs... and people */
-    if ((MP_INFO(x,y).flags & (FLAG_FED + (use_waterwell && FLAG_WATERWELL_COVER) + FLAG_EMPLOYED))
-	== (FLAG_FED + (use_waterwell && FLAG_WATERWELL_COVER) + FLAG_EMPLOYED)
+    if (use_waterwell) 
+        birth_flag = FLAG_FED + FLAG_WATERWELL_COVER + FLAG_EMPLOYED;
+    else
+        birth_flag = FLAG_FED + FLAG_EMPLOYED;
+
+    if (((MP_INFO(x,y).flags & birth_flag) == birth_flag)
 	&& (rand () % (RESIDENCE_BASE_BR + MP_INFO(x,y).int_4) == 1) 
-	&& p > 0)
+	&& (p > 0))
     {
 #ifdef DEBUG_WATERWELL
     	fprintf(stderr," birth ok, we are fed. use_waterwell= %i\n",use_waterwell);
@@ -172,7 +177,8 @@
 	}
     }
 
-    population += p;
+    /* XXX AL1: this is daily accumulator used stats.cpp, and maybe pop graph */
+    population += p; 
 
     /* now get power */
     if (get_power (x, y, POWER_RES_OVERHEAD
@@ -203,31 +209,25 @@
 	swing = JOB_SWING + (hc * HC_JOB_SWING) + cc;
     else
 	swing = -(JOB_SWING + (hc * HC_JOB_SWING) + cc);
-    if (put_jobs (x, y, ((p * (WORKING_POP_PERCENT + swing)) / 100)) != 0)
-    {
+
+    if (put_jobs (x, y, ((p * (WORKING_POP_PERCENT + swing)) / 100)) != 0) {
 	MP_INFO(x,y).flags |= FLAG_EMPLOYED;
 	MP_INFO(x,y).int_1++;
 	if (MP_INFO(x,y).int_1 > 10)
 	    MP_INFO(x,y).int_1 = 10;
 	good += 20;
-	if (get_goods (x, y, p / 4) != 0)
-	{
+	if (get_goods (x, y, p / 4) != 0) {
 	    good += 10;
-	    if (get_power (x, y, p / 2, 0) != 0)	/* goods use power */
-
-	    {
+	    if (get_power (x, y, p / 2, 0) != 0) {
 		good += 5;
 		brm += 10;
 		/*     buy more goods if got power for them */
 		if (get_goods (x, y, p / 4) != 0)
 		    good += 5;
-	    }
-	    else
+	    } else
 		bad += 5;
 	}
-    }
-    else if (MP_INFO(x,y).int_1 < 10)
-    {
+    } else if (MP_INFO(x,y).int_1 < 10) {
 	MP_INFO(x,y).flags &= (0xffffffff - FLAG_EMPLOYED);
 	MP_INFO(x,y).int_1 -= 11;
 	if (MP_INFO(x,y).int_1 < -300)
@@ -242,11 +242,8 @@
 	    unemployed_history += 1.0;
 	}
 	unemployment_cost += p;	/* hmmm */
-
 	bad += 70;
-    }
-    else
-    {
+    } else {
 	MP_INFO(x,y).int_1 -= 20;
 	bad += 50;
     }
@@ -256,16 +253,12 @@
     bad += MP_POL(x,y) / 20;
     good += people_pool / 27;
     r = rand () % ((good + bad) * RESIDENCE_PPM);
-    if (r < bad)
-    {
-	if (p > MIN_RES_POPULATION)
-	{
+    if (r < bad) {
+	if (p > MIN_RES_POPULATION) {
 	    p--;
 	    people_pool++;
 	}
-    }
-    else if (people_pool > 0 && r > ((good + bad) * (RESIDENCE_PPM - 1) + bad))
-    {
+    } else if (people_pool > 0 && r > ((good + bad) * (RESIDENCE_PPM - 1) + bad)) {
 	p++;
 	people_pool--;
     }

Modified: branches/waterwell/src/lincity/simulate.cpp
===================================================================
--- branches/waterwell/src/lincity/simulate.cpp	2007-05-03 23:18:47 UTC (rev 1213)
+++ branches/waterwell/src/lincity/simulate.cpp	2007-05-04 17:57:06 UTC (rev 1214)
@@ -40,6 +40,7 @@
 //#include "module_buttons.h"
 
 extern void connect_rivers (void);
+extern void do_daily_ecology (void);
 
 /* ---------------------------------------------------------------------- *
  * Private Fn Prototypes
@@ -248,11 +249,14 @@
 do_periodic_events (void)
 {
   add_daily_to_monthly();
+  do_daily_ecology ();
 
-
   if ((total_time % NUMOF_DAYS_IN_YEAR) == 0) {
     start_of_year_update ();
   }
+  if ((total_time % DAYS_PER_POLLUTION) == 3) {
+    do_pollution ();
+  }
   if ((total_time % DAYS_BETWEEN_FIRES) == 9
       && tech_level > (GROUP_FIRESTATION_TECH * MAX_TECH_LEVEL / 1000)) {
     do_random_fire (-1, -1, 1);
@@ -271,9 +275,6 @@
   if (total_time % NUMOF_DAYS_IN_YEAR == (NUMOF_DAYS_IN_YEAR - 1)) {
     end_of_year_update ();
   }
-  if ((total_time % DAYS_PER_POLLUTION) == 3) {
-    do_pollution ();
-  }
 }
 
 

Modified: branches/waterwell/src/lincity-ng/GameView.cpp
===================================================================
--- branches/waterwell/src/lincity-ng/GameView.cpp	2007-05-03 23:18:47 UTC (rev 1213)
+++ branches/waterwell/src/lincity-ng/GameView.cpp	2007-05-04 17:57:06 UTC (rev 1214)
@@ -1439,6 +1439,7 @@
             //case CST_MONUMENT_0: break;
             //case CST_PARKLAND_PLANE: break;
             //case CST_WATER: break;
+            case CST_WATERWELL: range = MARKET_RANGE; break;
         }
        	
         if (range > 0 )

Modified: branches/waterwell/src/lincity-ng/MiniMap.cpp
===================================================================
--- branches/waterwell/src/lincity-ng/MiniMap.cpp	2007-05-03 23:18:47 UTC (rev 1213)
+++ branches/waterwell/src/lincity-ng/MiniMap.cpp	2007-05-04 17:57:06 UTC (rev 1214)
@@ -705,7 +705,11 @@
                 else
                     return Color(0,0xFF,0);
             } else {
-                return makeGrey(getColorNormal(x,y));
+                    if (use_waterwell) {
+                        if ((flags & FLAG_WATERWELL_COVER) != 0)
+                                return makeBlue(getColorNormal(x,y));
+                    }
+                    return makeGrey(getColorNormal(x,y));
             }
         }
         case POWER: {



From alainb at mail.berlios.de  Sat May  5 11:00:06 2007
From: alainb at mail.berlios.de (alainb at BerliOS)
Date: Sat, 5 May 2007 11:00:06 +0200
Subject: [Lincity-ng-commit] r1215 - in trunk: mk/autoconf src src/binreloc
	src/lincity-ng
Message-ID: <200705050900.l45906xs027064@sheep.berlios.de>

Author: alainb
Date: 2007-05-05 11:00:05 +0200 (Sat, 05 May 2007)
New Revision: 1215

Added:
   trunk/src/binreloc/
   trunk/src/binreloc/Version-2.0
   trunk/src/binreloc/binreloc.c
   trunk/src/binreloc/binreloc.h
Removed:
   trunk/src/lincity-ng/prefix.cpp
   trunk/src/lincity-ng/prefix.h
Modified:
   trunk/mk/autoconf/pkg.m4
   trunk/src/lincity-ng/main.cpp
Log:
upgrade to binreloc-2.0

Modified: trunk/mk/autoconf/pkg.m4
===================================================================
--- trunk/mk/autoconf/pkg.m4	2007-05-04 17:57:06 UTC (rev 1214)
+++ trunk/mk/autoconf/pkg.m4	2007-05-05 09:00:05 UTC (rev 1215)
@@ -2,7 +2,7 @@
 dnl PKG_CHECK_MODULES(GSTUFF, gtk+-2.0 >= 1.3 glib = 1.3.4, action-if, action-not)
 dnl defines GSTUFF_LIBS, GSTUFF_CFLAGS, see pkg-config man page
 dnl also defines GSTUFF_PKG_ERRORS on error
-AC_DEFUN(PKG_CHECK_MODULES, [
+AC_DEFUN([PKG_CHECK_MODULES], [
   succeeded=no
 
   if test -z "$PKG_CONFIG"; then

Added: trunk/src/binreloc/Version-2.0
===================================================================
--- trunk/src/binreloc/Version-2.0	2007-05-04 17:57:06 UTC (rev 1214)
+++ trunk/src/binreloc/Version-2.0	2007-05-05 09:00:05 UTC (rev 1215)
@@ -0,0 +1,2 @@
+This is binreloc version 2.0
+http://autopackage.org/docs/binreloc/index.html

Added: trunk/src/binreloc/binreloc.c
===================================================================
--- trunk/src/binreloc/binreloc.c	2007-05-04 17:57:06 UTC (rev 1214)
+++ trunk/src/binreloc/binreloc.c	2007-05-05 09:00:05 UTC (rev 1215)
@@ -0,0 +1,766 @@
+/*
+ * BinReloc - a library for creating relocatable executables
+ * Written by: Hongli Lai <h.lai at chello.nl>
+ * http://autopackage.org/
+ *
+ * This source code is public domain. You can relicense this code
+ * under whatever license you want.
+ *
+ * See http://autopackage.org/docs/binreloc/ for
+ * more information and how to use this.
+ */
+
+#ifndef __BINRELOC_C__
+#define __BINRELOC_C__
+
+#ifdef ENABLE_BINRELOC
+	#include <sys/types.h>
+	#include <sys/stat.h>
+	#include <unistd.h>
+#endif /* ENABLE_BINRELOC */
+#include <stdio.h>
+#include <stdlib.h>
+#include <limits.h>
+#include <string.h>
+#include "binreloc.h"
+
+#ifdef __cplusplus
+extern "C" {
+#endif /* __cplusplus */
+
+
+
+/** @internal
+ * Find the canonical filename of the executable. Returns the filename
+ * (which must be freed) or NULL on error. If the parameter 'error' is
+ * not NULL, the error code will be stored there, if an error occured.
+ */
+static char *
+_br_find_exe (BrInitError *error)
+{
+#ifndef ENABLE_BINRELOC
+	if (error)
+		*error = BR_INIT_ERROR_DISABLED;
+	return NULL;
+#else
+	char *path, *path2, *line, *result;
+	size_t buf_size;
+	ssize_t size;
+	struct stat stat_buf;
+	FILE *f;
+
+	/* Read from /proc/self/exe (symlink) */
+	if (sizeof (path) > SSIZE_MAX)
+		buf_size = SSIZE_MAX - 1;
+	else
+		buf_size = PATH_MAX - 1;
+	path = (char *) malloc (buf_size);
+	if (path == NULL) {
+		/* Cannot allocate memory. */
+		if (error)
+			*error = BR_INIT_ERROR_NOMEM;
+		return NULL;
+	}
+	path2 = (char *) malloc (buf_size);
+	if (path2 == NULL) {
+		/* Cannot allocate memory. */
+		if (error)
+			*error = BR_INIT_ERROR_NOMEM;
+		free (path);
+		return NULL;
+	}
+
+	strncpy (path2, "/proc/self/exe", buf_size - 1);
+
+	while (1) {
+		int i;
+
+		size = readlink (path2, path, buf_size - 1);
+		if (size == -1) {
+			/* Error. */
+			free (path2);
+			break;
+		}
+
+		/* readlink() success. */
+		path[size] = '\0';
+
+		/* Check whether the symlink's target is also a symlink.
+		 * We want to get the final target. */
+		i = stat (path, &stat_buf);
+		if (i == -1) {
+			/* Error. */
+			free (path2);
+			break;
+		}
+
+		/* stat() success. */
+		if (!S_ISLNK (stat_buf.st_mode)) {
+			/* path is not a symlink. Done. */
+			free (path2);
+			return path;
+		}
+
+		/* path is a symlink. Continue loop and resolve this. */
+		strncpy (path, path2, buf_size - 1);
+	}
+
+
+	/* readlink() or stat() failed; this can happen when the program is
+	 * running in Valgrind 2.2. Read from /proc/self/maps as fallback. */
+
+	buf_size = PATH_MAX + 128;
+	line = (char *) realloc (path, buf_size);
+	if (line == NULL) {
+		/* Cannot allocate memory. */
+		free (path);
+		if (error)
+			*error = BR_INIT_ERROR_NOMEM;
+		return NULL;
+	}
+
+	f = fopen ("/proc/self/maps", "r");
+	if (f == NULL) {
+		free (line);
+		if (error)
+			*error = BR_INIT_ERROR_OPEN_MAPS;
+		return NULL;
+	}
+
+	/* The first entry should be the executable name. */
+	result = fgets (line, (int) buf_size, f);
+	if (result == NULL) {
+		fclose (f);
+		free (line);
+		if (error)
+			*error = BR_INIT_ERROR_READ_MAPS;
+		return NULL;
+	}
+
+	/* Get rid of newline character. */
+	buf_size = strlen (line);
+	if (buf_size <= 0) {
+		/* Huh? An empty string? */
+		fclose (f);
+		free (line);
+		if (error)
+			*error = BR_INIT_ERROR_INVALID_MAPS;
+		return NULL;
+	}
+	if (line[buf_size - 1] == 10)
+		line[buf_size - 1] = 0;
+
+	/* Extract the filename; it is always an absolute path. */
+	path = strchr (line, '/');
+
+	/* Sanity check. */
+	if (strstr (line, " r-xp ") == NULL || path == NULL) {
+		fclose (f);
+		free (line);
+		if (error)
+			*error = BR_INIT_ERROR_INVALID_MAPS;
+		return NULL;
+	}
+
+	path = strdup (path);
+	free (line);
+	fclose (f);
+	return path;
+#endif /* ENABLE_BINRELOC */
+}
+
+
+/** @internal
+ * Find the canonical filename of the executable which owns symbol.
+ * Returns a filename which must be freed, or NULL on error.
+ */
+static char *
+_br_find_exe_for_symbol (const void *symbol, BrInitError *error)
+{
+#ifndef ENABLE_BINRELOC
+	if (error)
+		*error = BR_INIT_ERROR_DISABLED;
+	return (char *) NULL;
+#else
+	#define SIZE PATH_MAX + 100
+	FILE *f;
+	size_t address_string_len;
+	char *address_string, line[SIZE], *found;
+
+	if (symbol == NULL)
+		return (char *) NULL;
+
+	f = fopen ("/proc/self/maps", "r");
+	if (f == NULL)
+		return (char *) NULL;
+
+	address_string_len = 4;
+	address_string = (char *) malloc (address_string_len);
+	found = (char *) NULL;
+
+	while (!feof (f)) {
+		char *start_addr, *end_addr, *end_addr_end, *file;
+		void *start_addr_p, *end_addr_p;
+		size_t len;
+
+		if (fgets (line, SIZE, f) == NULL)
+			break;
+
+		/* Sanity check. */
+		if (strstr (line, " r-xp ") == NULL || strchr (line, '/') == NULL)
+			continue;
+
+		/* Parse line. */
+		start_addr = line;
+		end_addr = strchr (line, '-');
+		file = strchr (line, '/');
+
+		/* More sanity check. */
+		if (!(file > end_addr && end_addr != NULL && end_addr[0] == '-'))
+			continue;
+
+		end_addr[0] = '\0';
+		end_addr++;
+		end_addr_end = strchr (end_addr, ' ');
+		if (end_addr_end == NULL)
+			continue;
+
+		end_addr_end[0] = '\0';
+		len = strlen (file);
+		if (len == 0)
+			continue;
+		if (file[len - 1] == '\n')
+			file[len - 1] = '\0';
+
+		/* Get rid of "(deleted)" from the filename. */
+		len = strlen (file);
+		if (len > 10 && strcmp (file + len - 10, " (deleted)") == 0)
+			file[len - 10] = '\0';
+
+		/* I don't know whether this can happen but better safe than sorry. */
+		len = strlen (start_addr);
+		if (len != strlen (end_addr))
+			continue;
+
+
+		/* Transform the addresses into a string in the form of 0xdeadbeef,
+		 * then transform that into a pointer. */
+		if (address_string_len < len + 3) {
+			address_string_len = len + 3;
+			address_string = (char *) realloc (address_string, address_string_len);
+		}
+
+		memcpy (address_string, "0x", 2);
+		memcpy (address_string + 2, start_addr, len);
+		address_string[2 + len] = '\0';
+		sscanf (address_string, "%p", &start_addr_p);
+
+		memcpy (address_string, "0x", 2);
+		memcpy (address_string + 2, end_addr, len);
+		address_string[2 + len] = '\0';
+		sscanf (address_string, "%p", &end_addr_p);
+
+
+		if (symbol >= start_addr_p && symbol < end_addr_p) {
+			found = file;
+			break;
+		}
+	}
+
+	free (address_string);
+	fclose (f);
+
+	if (found == NULL)
+		return (char *) NULL;
+	else
+		return strdup (found);
+#endif /* ENABLE_BINRELOC */
+}
+
+
+#ifndef BINRELOC_RUNNING_DOXYGEN
+	#undef NULL
+	#define NULL ((void *) 0) /* typecasted as char* for C++ type safeness */
+#endif
+
+static char *exe = (char *) NULL;
+
+
+/** Initialize the BinReloc library (for applications).
+ *
+ * This function must be called before using any other BinReloc functions.
+ * It attempts to locate the application's canonical filename.
+ *
+ * @note If you want to use BinReloc for a library, then you should call
+ *       br_init_lib() instead.
+ *
+ * @param error  If BinReloc failed to initialize, then the error code will
+ *               be stored in this variable. Set to NULL if you want to
+ *               ignore this. See #BrInitError for a list of error codes.
+ *
+ * @returns 1 on success, 0 if BinReloc failed to initialize.
+ */
+int
+br_init (BrInitError *error)
+{
+	exe = _br_find_exe (error);
+	return exe != NULL;
+}
+
+
+/** Initialize the BinReloc library (for libraries).
+ *
+ * This function must be called before using any other BinReloc functions.
+ * It attempts to locate the calling library's canonical filename.
+ *
+ * @note The BinReloc source code MUST be included in your library, or this
+ *       function won't work correctly.
+ *
+ * @param error  If BinReloc failed to initialize, then the error code will
+ *               be stored in this variable. Set to NULL if you want to
+ *               ignore this. See #BrInitError for a list of error codes.
+ *
+ * @returns 1 on success, 0 if a filename cannot be found.
+ */
+int
+br_init_lib (BrInitError *error)
+{
+	exe = _br_find_exe_for_symbol ((const void *) "", error);
+	return exe != NULL;
+}
+
+
+/** Find the canonical filename of the current application.
+ *
+ * @param default_exe  A default filename which will be used as fallback.
+ * @returns A string containing the application's canonical filename,
+ *          which must be freed when no longer necessary. If BinReloc is
+ *          not initialized, or if br_init() failed, then a copy of
+ *          default_exe will be returned. If default_exe is NULL, then
+ *          NULL will be returned.
+ */
+char *
+br_find_exe (const char *default_exe)
+{
+	if (exe == (char *) NULL) {
+		/* BinReloc is not initialized. */
+		if (default_exe != (const char *) NULL)
+			return strdup (default_exe);
+		else
+			return (char *) NULL;
+	}
+	return strdup (exe);
+}
+
+
+/** Locate the directory in which the current application is installed.
+ *
+ * The prefix is generated by the following pseudo-code evaluation:
+ * \code
+ * dirname(exename)
+ * \endcode
+ *
+ * @param default_dir  A default directory which will used as fallback.
+ * @return A string containing the directory, which must be freed when no
+ *         longer necessary. If BinReloc is not initialized, or if the
+ *         initialization function failed, then a copy of default_dir
+ *         will be returned. If default_dir is NULL, then NULL will be
+ *         returned.
+ */
+char *
+br_find_exe_dir (const char *default_dir)
+{
+	if (exe == NULL) {
+		/* BinReloc not initialized. */
+		if (default_dir != NULL)
+			return strdup (default_dir);
+		else
+			return NULL;
+	}
+
+	return br_dirname (exe);
+}
+
+
+/** Locate the prefix in which the current application is installed.
+ *
+ * The prefix is generated by the following pseudo-code evaluation:
+ * \code
+ * dirname(dirname(exename))
+ * \endcode
+ *
+ * @param default_prefix  A default prefix which will used as fallback.
+ * @return A string containing the prefix, which must be freed when no
+ *         longer necessary. If BinReloc is not initialized, or if
+ *         the initialization function failed, then a copy of default_prefix
+ *         will be returned. If default_prefix is NULL, then NULL will be returned.
+ */
+char *
+br_find_prefix (const char *default_prefix)
+{
+	char *dir1, *dir2;
+
+	if (exe == (char *) NULL) {
+		/* BinReloc not initialized. */
+		if (default_prefix != (const char *) NULL)
+			return strdup (default_prefix);
+		else
+			return (char *) NULL;
+	}
+
+	dir1 = br_dirname (exe);
+	dir2 = br_dirname (dir1);
+	free (dir1);
+	return dir2;
+}
+
+
+/** Locate the application's binary folder.
+ *
+ * The path is generated by the following pseudo-code evaluation:
+ * \code
+ * prefix + "/bin"
+ * \endcode
+ *
+ * @param default_bin_dir  A default path which will used as fallback.
+ * @return A string containing the bin folder's path, which must be freed when
+ *         no longer necessary. If BinReloc is not initialized, or if
+ *         the initialization function failed, then a copy of default_bin_dir will
+ *         be returned. If default_bin_dir is NULL, then NULL will be returned.
+ */
+char *
+br_find_bin_dir (const char *default_bin_dir)
+{
+	char *prefix, *dir;
+
+	prefix = br_find_prefix ((const char *) NULL);
+	if (prefix == (char *) NULL) {
+		/* BinReloc not initialized. */
+		if (default_bin_dir != (const char *) NULL)
+			return strdup (default_bin_dir);
+		else
+			return (char *) NULL;
+	}
+
+	dir = br_build_path (prefix, "bin");
+	free (prefix);
+	return dir;
+}
+
+
+/** Locate the application's superuser binary folder.
+ *
+ * The path is generated by the following pseudo-code evaluation:
+ * \code
+ * prefix + "/sbin"
+ * \endcode
+ *
+ * @param default_sbin_dir  A default path which will used as fallback.
+ * @return A string containing the sbin folder's path, which must be freed when
+ *         no longer necessary. If BinReloc is not initialized, or if the
+ *         initialization function failed, then a copy of default_sbin_dir will
+ *         be returned. If default_bin_dir is NULL, then NULL will be returned.
+ */
+char *
+br_find_sbin_dir (const char *default_sbin_dir)
+{
+	char *prefix, *dir;
+
+	prefix = br_find_prefix ((const char *) NULL);
+	if (prefix == (char *) NULL) {
+		/* BinReloc not initialized. */
+		if (default_sbin_dir != (const char *) NULL)
+			return strdup (default_sbin_dir);
+		else
+			return (char *) NULL;
+	}
+
+	dir = br_build_path (prefix, "sbin");
+	free (prefix);
+	return dir;
+}
+
+
+/** Locate the application's data folder.
+ *
+ * The path is generated by the following pseudo-code evaluation:
+ * \code
+ * prefix + "/share"
+ * \endcode
+ *
+ * @param default_data_dir  A default path which will used as fallback.
+ * @return A string containing the data folder's path, which must be freed when
+ *         no longer necessary. If BinReloc is not initialized, or if the
+ *         initialization function failed, then a copy of default_data_dir
+ *         will be returned. If default_data_dir is NULL, then NULL will be
+ *         returned.
+ */
+char *
+br_find_data_dir (const char *default_data_dir)
+{
+	char *prefix, *dir;
+
+	prefix = br_find_prefix ((const char *) NULL);
+	if (prefix == (char *) NULL) {
+		/* BinReloc not initialized. */
+		if (default_data_dir != (const char *) NULL)
+			return strdup (default_data_dir);
+		else
+			return (char *) NULL;
+	}
+
+	dir = br_build_path (prefix, "share");
+	free (prefix);
+	return dir;
+}
+
+
+/** Locate the application's localization folder.
+ *
+ * The path is generated by the following pseudo-code evaluation:
+ * \code
+ * prefix + "/share/locale"
+ * \endcode
+ *
+ * @param default_locale_dir  A default path which will used as fallback.
+ * @return A string containing the localization folder's path, which must be freed when
+ *         no longer necessary. If BinReloc is not initialized, or if the
+ *         initialization function failed, then a copy of default_locale_dir will be returned.
+ *         If default_locale_dir is NULL, then NULL will be returned.
+ */
+char *
+br_find_locale_dir (const char *default_locale_dir)
+{
+	char *data_dir, *dir;
+
+	data_dir = br_find_data_dir ((const char *) NULL);
+	if (data_dir == (char *) NULL) {
+		/* BinReloc not initialized. */
+		if (default_locale_dir != (const char *) NULL)
+			return strdup (default_locale_dir);
+		else
+			return (char *) NULL;
+	}
+
+	dir = br_build_path (data_dir, "locale");
+	free (data_dir);
+	return dir;
+}
+
+
+/** Locate the application's library folder.
+ *
+ * The path is generated by the following pseudo-code evaluation:
+ * \code
+ * prefix + "/lib"
+ * \endcode
+ *
+ * @param default_lib_dir  A default path which will used as fallback.
+ * @return A string containing the library folder's path, which must be freed when
+ *         no longer necessary. If BinReloc is not initialized, or if the initialization
+ *         function failed, then a copy of default_lib_dir will be returned.
+ *         If default_lib_dir is NULL, then NULL will be returned.
+ */
+char *
+br_find_lib_dir (const char *default_lib_dir)
+{
+	char *prefix, *dir;
+
+	prefix = br_find_prefix ((const char *) NULL);
+	if (prefix == (char *) NULL) {
+		/* BinReloc not initialized. */
+		if (default_lib_dir != (const char *) NULL)
+			return strdup (default_lib_dir);
+		else
+			return (char *) NULL;
+	}
+
+	dir = br_build_path (prefix, "lib");
+	free (prefix);
+	return dir;
+}
+
+
+/** Locate the application's libexec folder.
+ *
+ * The path is generated by the following pseudo-code evaluation:
+ * \code
+ * prefix + "/libexec"
+ * \endcode
+ *
+ * @param default_libexec_dir  A default path which will used as fallback.
+ * @return A string containing the libexec folder's path, which must be freed when
+ *         no longer necessary. If BinReloc is not initialized, or if the initialization
+ *         function failed, then a copy of default_libexec_dir will be returned.
+ *         If default_libexec_dir is NULL, then NULL will be returned.
+ */
+char *
+br_find_libexec_dir (const char *default_libexec_dir)
+{
+	char *prefix, *dir;
+
+	prefix = br_find_prefix ((const char *) NULL);
+	if (prefix == (char *) NULL) {
+		/* BinReloc not initialized. */
+		if (default_libexec_dir != (const char *) NULL)
+			return strdup (default_libexec_dir);
+		else
+			return (char *) NULL;
+	}
+
+	dir = br_build_path (prefix, "libexec");
+	free (prefix);
+	return dir;
+}
+
+
+/** Locate the application's configuration files folder.
+ *
+ * The path is generated by the following pseudo-code evaluation:
+ * \code
+ * prefix + "/etc"
+ * \endcode
+ *
+ * @param default_etc_dir  A default path which will used as fallback.
+ * @return A string containing the etc folder's path, which must be freed when
+ *         no longer necessary. If BinReloc is not initialized, or if the initialization
+ *         function failed, then a copy of default_etc_dir will be returned.
+ *         If default_etc_dir is NULL, then NULL will be returned.
+ */
+char *
+br_find_etc_dir (const char *default_etc_dir)
+{
+	char *prefix, *dir;
+
+	prefix = br_find_prefix ((const char *) NULL);
+	if (prefix == (char *) NULL) {
+		/* BinReloc not initialized. */
+		if (default_etc_dir != (const char *) NULL)
+			return strdup (default_etc_dir);
+		else
+			return (char *) NULL;
+	}
+
+	dir = br_build_path (prefix, "etc");
+	free (prefix);
+	return dir;
+}
+
+
+/***********************
+ * Utility functions
+ ***********************/
+
+/** Concatenate str1 and str2 to a newly allocated string.
+ *
+ * @param str1 A string.
+ * @param str2 Another string.
+ * @returns A newly-allocated string. This string should be freed when no longer needed.
+ */
+char *
+br_strcat (const char *str1, const char *str2)
+{
+	char *result;
+	size_t len1, len2;
+
+	if (str1 == NULL)
+		str1 = "";
+	if (str2 == NULL)
+		str2 = "";
+
+	len1 = strlen (str1);
+	len2 = strlen (str2);
+
+	result = (char *) malloc (len1 + len2 + 1);
+	memcpy (result, str1, len1);
+	memcpy (result + len1, str2, len2);
+	result[len1 + len2] = '\0';
+
+	return result;
+}
+
+
+char *
+br_build_path (const char *dir, const char *file)
+{
+	char *dir2, *result;
+	size_t len;
+	int must_free = 0;
+
+	len = strlen (dir);
+	if (len > 0 && dir[len - 1] != '/') {
+		dir2 = br_strcat (dir, "/");
+		must_free = 1;
+	} else
+		dir2 = (char *) dir;
+
+	result = br_strcat (dir2, file);
+	if (must_free)
+		free (dir2);
+	return result;
+}
+
+
+/* Emulates glibc's strndup() */
+static char *
+br_strndup (const char *str, size_t size)
+{
+	char *result = (char *) NULL;
+	size_t len;
+
+	if (str == (const char *) NULL)
+		return (char *) NULL;
+
+	len = strlen (str);
+	if (len == 0)
+		return strdup ("");
+	if (size > len)
+		size = len;
+
+	result = (char *) malloc (len + 1);
+	memcpy (result, str, size);
+	result[size] = '\0';
+	return result;
+}
+
+
+/** Extracts the directory component of a path.
+ *
+ * Similar to g_dirname() or the dirname commandline application.
+ *
+ * Example:
+ * \code
+ * br_dirname ("/usr/local/foobar");  --> Returns: "/usr/local"
+ * \endcode
+ *
+ * @param path  A path.
+ * @returns     A directory name. This string should be freed when no longer needed.
+ */
+char *
+br_dirname (const char *path)
+{
+	char *end, *result;
+
+	if (path == (const char *) NULL)
+		return (char *) NULL;
+
+	end = strrchr (path, '/');
+	if (end == (const char *) NULL)
+		return strdup (".");
+
+	while (end > path && *end == '/')
+		end--;
+	result = br_strndup (path, end - path + 1);
+	if (result[0] == 0) {
+		free (result);
+		return strdup ("/");
+	} else
+		return result;
+}
+
+
+#ifdef __cplusplus
+}
+#endif /* __cplusplus */
+
+#endif /* __BINRELOC_C__ */

Added: trunk/src/binreloc/binreloc.h
===================================================================
--- trunk/src/binreloc/binreloc.h	2007-05-04 17:57:06 UTC (rev 1214)
+++ trunk/src/binreloc/binreloc.h	2007-05-05 09:00:05 UTC (rev 1215)
@@ -0,0 +1,80 @@
+/*
+ * BinReloc - a library for creating relocatable executables
+ * Written by: Hongli Lai <h.lai at chello.nl>
+ * http://autopackage.org/
+ *
+ * This source code is public domain. You can relicense this code
+ * under whatever license you want.
+ *
+ * See http://autopackage.org/docs/binreloc/ for
+ * more information and how to use this.
+ */
+
+#ifndef __BINRELOC_H__
+#define __BINRELOC_H__
+
+#ifdef __cplusplus
+extern "C" {
+#endif /* __cplusplus */
+
+
+/** These error codes can be returned by br_init(), br_init_lib(), gbr_init() or gbr_init_lib(). */
+typedef enum {
+	/** Cannot allocate memory. */
+	BR_INIT_ERROR_NOMEM,
+	/** Unable to open /proc/self/maps; see errno for details. */
+	BR_INIT_ERROR_OPEN_MAPS,
+	/** Unable to read from /proc/self/maps; see errno for details. */
+	BR_INIT_ERROR_READ_MAPS,
+	/** The file format of /proc/self/maps is invalid; kernel bug? */
+	BR_INIT_ERROR_INVALID_MAPS,
+	/** BinReloc is disabled (the ENABLE_BINRELOC macro is not defined). */
+	BR_INIT_ERROR_DISABLED
+} BrInitError;
+
+
+#ifndef BINRELOC_RUNNING_DOXYGEN
+/* Mangle symbol names to avoid symbol collisions with other ELF objects. */
+	#define br_init             IESV86484081450641_br_init
+	#define br_init_lib         IESV86484081450641_br_init_lib
+	#define br_find_exe         IESV86484081450641_br_find_exe
+	#define br_find_exe_dir     IESV86484081450641_br_find_exe_dir
+	#define br_find_prefix      IESV86484081450641_br_find_prefix
+	#define br_find_bin_dir     IESV86484081450641_br_find_bin_dir
+	#define br_find_sbin_dir    IESV86484081450641_br_find_sbin_dir
+	#define br_find_data_dir    IESV86484081450641_br_find_data_dir
+	#define br_find_locale_dir  IESV86484081450641_br_find_locale_dir
+	#define br_find_lib_dir     IESV86484081450641_br_find_lib_dir
+	#define br_find_libexec_dir IESV86484081450641_br_find_libexec_dir
+	#define br_find_etc_dir     IESV86484081450641_br_find_etc_dir
+	#define br_strcat           IESV86484081450641_br_strcat
+	#define br_build_path       IESV86484081450641_br_build_path
+	#define br_dirname          IESV86484081450641_br_dirname
+
+
+#endif
+int   br_init             (BrInitError *error);
+int   br_init_lib         (BrInitError *error);
+
+char *br_find_exe         (const char *default_exe);
+char *br_find_exe_dir     (const char *default_dir);
+char *br_find_prefix      (const char *default_prefix);
+char *br_find_bin_dir     (const char *default_bin_dir);
+char *br_find_sbin_dir    (const char *default_sbin_dir);
+char *br_find_data_dir    (const char *default_data_dir);
+char *br_find_locale_dir  (const char *default_locale_dir);
+char *br_find_lib_dir     (const char *default_lib_dir);
+char *br_find_libexec_dir (const char *default_libexec_dir);
+char *br_find_etc_dir     (const char *default_etc_dir);
+
+/* Utility functions */
+char *br_strcat  (const char *str1, const char *str2);
+char *br_build_path (const char *dir, const char *file);
+char *br_dirname (const char *path);
+
+
+#ifdef __cplusplus
+}
+#endif /* __cplusplus */
+
+#endif /* __BINRELOC_H__ */

Modified: trunk/src/lincity-ng/main.cpp
===================================================================
--- trunk/src/lincity-ng/main.cpp	2007-05-04 17:57:06 UTC (rev 1214)
+++ trunk/src/lincity-ng/main.cpp	2007-05-05 09:00:05 UTC (rev 1215)
@@ -45,7 +45,7 @@
 #include "Config.hpp"
 
 #ifdef ENABLE_BINRELOC
-#include "prefix.h"
+#include "binreloc/binreloc.h"
 #endif
 
 Painter* painter = 0;
@@ -152,6 +152,13 @@
 #if defined(APPDATADIR) || defined(ENABLE_BINRELOC)
     std::string datadir;
 #ifdef ENABLE_BINRELOC
+    BrInitError error;
+    if (br_init (&error) == 0 && error != BR_INIT_ERROR_DISABLED) {
+        printf ("Warning: BinReloc failed to initialize (error code %d)\n",
+                error);
+        printf ("Will fallback to hardcoded default path.\n");
+    }
+
     char* brdatadir = br_strcat(DATADIR, "/" PACKAGE_NAME);
     datadir = brdatadir;
     free(brdatadir);

Deleted: trunk/src/lincity-ng/prefix.cpp
===================================================================
--- trunk/src/lincity-ng/prefix.cpp	2007-05-04 17:57:06 UTC (rev 1214)
+++ trunk/src/lincity-ng/prefix.cpp	2007-05-05 09:00:05 UTC (rev 1215)
@@ -1,484 +0,0 @@
-/*
- * BinReloc - a library for creating relocatable executables
- * Written by: Mike Hearn <mike at theoretic.com>
- *             Hongli Lai <h.lai at chello.nl>
- * http://autopackage.org/
- * 
- * This source code is public domain. You can relicense this code
- * under whatever license you want.
- *
- * NOTE: if you're using C++ and are getting "undefined reference
- * to br_*", try renaming prefix.c to prefix.cpp
- */
-
-/* WARNING, BEFORE YOU MODIFY PREFIX.C:
- *
- * If you make changes to any of the functions in prefix.c, you MUST
- * change the BR_NAMESPACE macro (in prefix.h).
- * This way you can avoid symbol table conflicts with other libraries
- * that also happen to use BinReloc.
- *
- * Example:
- * #define BR_NAMESPACE(funcName) foobar_ ## funcName
- * --> expands br_locate to foobar_br_locate
- */
-
-#ifndef _PREFIX_C_
-#define _PREFIX_C_
-
-#ifdef HAVE_CONFIG_H
-	#include "config.h"
-#endif
-
-#ifndef BR_PTHREADS
-	/* Change 1 to 0 if you don't want pthread support */
-	#define BR_PTHREADS 1
-#endif /* BR_PTHREADS */
-
-#include <stdlib.h>
-#include <stdio.h>
-#include <limits.h>
-#include <string.h>
-#include "prefix.h"
-
-#ifdef __cplusplus
-extern "C" {
-#endif /* __cplusplus */
-
-
-#undef NULL
-#define NULL ((void *) 0)
-
-#ifdef __GNUC__
-	#define br_return_val_if_fail(expr,val) if (!(expr)) {fprintf (stderr, "** BinReloc (%s): assertion %s failed\n", __PRETTY_FUNCTION__, #expr); return val;}
-#else
-	#define br_return_val_if_fail(expr,val) if (!(expr)) return val
-#endif /* __GNUC__ */
-
-
-static br_locate_fallback_func fallback_func = (br_locate_fallback_func) NULL;
-static void *fallback_data = NULL;
-
-
-#ifdef ENABLE_BINRELOC
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <sys/param.h>
-#include <unistd.h>
-
-
-/**
- * br_locate:
- * symbol: A symbol that belongs to the app/library you want to locate.
- * Returns: A newly allocated string containing the full path of the
- *	    app/library that func belongs to, or NULL on error. This
- *	    string should be freed when not when no longer needed.
- *
- * Finds out to which application or library symbol belongs, then locate
- * the full path of that application or library.
- * Note that symbol cannot be a pointer to a function. That will not work.
- *
- * Example:
- * --> main.c
- * #include "prefix.h"
- * #include "libfoo.h"
- *
- * int main (int argc, char *argv[]) {
- *	printf ("Full path of this app: %s\n", br_locate (&argc));
- *	libfoo_start ();
- *	return 0;
- * }
- *
- * --> libfoo.c starts here
- * #include "prefix.h"
- *
- * void libfoo_start () {
- *	--> "" is a symbol that belongs to libfoo (because it's called
- *	--> from libfoo_start()); that's why this works.
- *	printf ("libfoo is located in: %s\n", br_locate (""));
- * }
- */
-char *
-br_locate (void *symbol)
-{
-	char line[5000];
-	FILE *f;
-	char *path;
-
-	br_return_val_if_fail (symbol != NULL, NULL);
-
-	f = fopen ("/proc/self/maps", "r");
-	if (!f) {
-		if (fallback_func)
-			return fallback_func(symbol, fallback_data);
-		else
-			return NULL;
-	}
-
-	while (!feof (f))
-	{
-		unsigned long start, end;
-
-		if (!fgets (line, sizeof (line), f))
-			continue;
-		if (!strstr (line, " r-xp ") || !strchr (line, '/'))
-			continue;
-
-		sscanf (line, "%lx-%lx ", &start, &end);
-		if (symbol >= (void *) start && symbol < (void *) end)
-		{
-			char *tmp;
-			size_t len;
-
-			/* Extract the filename; it is always an absolute path */
-			path = strchr (line, '/');
-
-			/* Get rid of the newline */
-			tmp = strrchr (path, '\n');
-			if (tmp) *tmp = 0;
-
-			/* Get rid of "(deleted)" */
-			len = strlen (path);
-			if (len > 10 && strcmp (path + len - 10, " (deleted)") == 0)
-			{
-				tmp = path + len - 10;
-				*tmp = 0;
-			}
-
-			fclose(f);
-			return strdup (path);
-		}
-	}
-
-	fclose (f);
-	return NULL;
-}
-
-
-/**
- * br_locate_prefix:
- * symbol: A symbol that belongs to the app/library you want to locate.
- * Returns: A prefix. This string should be freed when no longer needed.
- *
- * Locates the full path of the app/library that symbol belongs to, and return
- * the prefix of that path, or NULL on error.
- * Note that symbol cannot be a pointer to a function. That will not work.
- *
- * Example:
- * --> This application is located in /usr/bin/foo
- * br_locate_prefix (&argc);   --> returns: "/usr"
- */
-char *
-br_locate_prefix (void *symbol)
-{
-	char *path, *prefix;
-
-	br_return_val_if_fail (symbol != NULL, NULL);
-
-	path = br_locate (symbol);
-	if (!path) return NULL;
-
-	prefix = br_extract_prefix (path);
-	free (path);
-	return prefix;
-}
-
-
-/**
- * br_prepend_prefix:
- * symbol: A symbol that belongs to the app/library you want to locate.
- * path: The path that you want to prepend the prefix to.
- * Returns: The new path, or NULL on error. This string should be freed when no
- *	    longer needed.
- *
- * Gets the prefix of the app/library that symbol belongs to. Prepend that prefix to path.
- * Note that symbol cannot be a pointer to a function. That will not work.
- *
- * Example:
- * --> The application is /usr/bin/foo
- * br_prepend_prefix (&argc, "/share/foo/data.png");   --> Returns "/usr/share/foo/data.png"
- */
-char *
-br_prepend_prefix (void *symbol, char *path)
-{
-	char *tmp, *newpath;
-
-	br_return_val_if_fail (symbol != NULL, NULL);
-	br_return_val_if_fail (path != NULL, NULL);
-
-	tmp = br_locate_prefix (symbol);
-	if (!tmp) return NULL;
-
-	if (strcmp (tmp, "/") == 0)
-		newpath = strdup (path);
-	else
-		newpath = br_strcat (tmp, path);
-
-	/* Get rid of compiler warning ("br_prepend_prefix never used") */
-	if (0) br_prepend_prefix (NULL, NULL);
-
-	free (tmp);
-	return newpath;
-}
-
-#endif /* ENABLE_BINRELOC */
-
-
-/* Pthread stuff for thread safetiness */
-#if BR_PTHREADS && defined(ENABLE_BINRELOC)
-
-#include <pthread.h>
-
-static pthread_key_t br_thread_key;
-static pthread_once_t br_thread_key_once = PTHREAD_ONCE_INIT;
-
-
-static void
-br_thread_local_store_fini ()
-{
-	char *specific;
-
-	specific = (char *) pthread_getspecific (br_thread_key);
-	if (specific)
-	{
-		free (specific);
-		pthread_setspecific (br_thread_key, NULL);
-	}
-	pthread_key_delete (br_thread_key);
-	br_thread_key = 0;
-}
-
-
-static void
-br_str_free (void *str)
-{
-	if (str)
-		free (str);
-}
-
-
-static void
-br_thread_local_store_init ()
-{
-	if (pthread_key_create (&br_thread_key, br_str_free) == 0)
-		atexit (br_thread_local_store_fini);
-}
-
-#else /* BR_PTHREADS */
-#ifdef ENABLE_BINRELOC
-
-static char *br_last_value = (char *) NULL;
-
-static void
-br_free_last_value ()
-{
-	if (br_last_value)
-		free (br_last_value);
-}
-
-#endif /* ENABLE_BINRELOC */
-#endif /* BR_PTHREADS */
-
-
-#ifdef ENABLE_BINRELOC
-
-/**
- * br_thread_local_store:
- * str: A dynamically allocated string.
- * Returns: str. This return value must not be freed.
- *
- * Store str in a thread-local variable and return str. The next
- * you run this function, that variable is freed too.
- * This function is created so you don't have to worry about freeing
- * strings. Just be careful about doing this sort of thing:
- *
- * some_function( BR_DATADIR("/one.png"), BR_DATADIR("/two.png") )
- *
- * Examples:
- * char *foo;
- * foo = br_thread_local_store (strdup ("hello")); --> foo == "hello"
- * foo = br_thread_local_store (strdup ("world")); --> foo == "world"; "hello" is now freed.
- */
-const char *
-br_thread_local_store (char *str)
-{
-	#if BR_PTHREADS
-		char *specific;
-
-		pthread_once (&br_thread_key_once, br_thread_local_store_init);
-
-		specific = (char *) pthread_getspecific (br_thread_key);
-		br_str_free (specific);
-		pthread_setspecific (br_thread_key, str);
-
-	#else /* BR_PTHREADS */
-		static int initialized = 0;
-
-		if (!initialized)
-		{
-			atexit (br_free_last_value);
-			initialized = 1;
-		}
-
-		if (br_last_value)
-			free (br_last_value);
-		br_last_value = str;
-	#endif /* BR_PTHREADS */
-
-	return (const char *) str;
-}
-
-#endif /* ENABLE_BINRELOC */
-
-
-/**
- * br_strcat:
- * str1: A string.
- * str2: Another string.
- * Returns: A newly-allocated string. This string should be freed when no longer needed.
- *
- * Concatenate str1 and str2 to a newly allocated string.
- */
-char *
-br_strcat (const char *str1, const char *str2)
-{
-	char *result;
-	size_t len1, len2;
-
-	if (!str1) str1 = "";
-	if (!str2) str2 = "";
-
-	len1 = strlen (str1);
-	len2 = strlen (str2);
-
-	result = (char *) malloc (len1 + len2 + 1);
-	memcpy (result, str1, len1);
-	memcpy (result + len1, str2, len2);
-	result[len1 + len2] = '\0';
-
-	return result;
-}
-
-
-/* Emulates glibc's strndup() */
-static char *
-br_strndup (char *str, size_t size)
-{
-	char *result = (char *) NULL;
-	size_t len;
-
-	br_return_val_if_fail (str != (char *) NULL, (char *) NULL);
-
-	len = strlen (str);
-	if (!len) return strdup ("");
-	if (size > len) size = len;
-
-	result = (char *) calloc (sizeof (char), len + 1);
-	memcpy (result, str, size);
-	return result;
-}
-
-
-/**
- * br_extract_dir:
- * path: A path.
- * Returns: A directory name. This string should be freed when no longer needed.
- *
- * Extracts the directory component of path. Similar to g_dirname() or the dirname
- * commandline application.
- *
- * Example:
- * br_extract_dir ("/usr/local/foobar");  --> Returns: "/usr/local"
- */
-char *
-br_extract_dir (const char *path)
-{
-	const char *end;
-	char *result;
-
-	br_return_val_if_fail (path != (char *) NULL, (char *) NULL);
-
-	end = strrchr (path, '/');
-	if (!end) return strdup (".");
-
-	while (end > path && *end == '/')
-		end--;
-	result = br_strndup ((char *) path, end - path + 1);
-	if (!*result)
-	{
-		free (result);
-		return strdup ("/");
-	} else
-		return result;
-}
-
-
-/**
- * br_extract_prefix:
- * path: The full path of an executable or library.
- * Returns: The prefix, or NULL on error. This string should be freed when no longer needed.
- *
- * Extracts the prefix from path. This function assumes that your executable
- * or library is installed in an LSB-compatible directory structure.
- *
- * Example:
- * br_extract_prefix ("/usr/bin/gnome-panel");       --> Returns "/usr"
- * br_extract_prefix ("/usr/local/lib/libfoo.so");   --> Returns "/usr/local"
- * br_extract_prefix ("/usr/local/libfoo.so");       --> Returns "/usr"
- */
-char *
-br_extract_prefix (const char *path)
-{
-	const char *end;
-	char *tmp, *result;
-
-	br_return_val_if_fail (path != (char *) NULL, (char *) NULL);
-
-	if (!*path) return strdup ("/");
-	end = strrchr (path, '/');
-	if (!end) return strdup (path);
-
-	tmp = br_strndup ((char *) path, end - path);
-	if (!*tmp)
-	{
-		free (tmp);
-		return strdup ("/");
-	}
-	end = strrchr (tmp, '/');
-	if (!end) return tmp;
-
-	result = br_strndup (tmp, end - tmp);
-	free (tmp);
-
-	if (!*result)
-	{
-		free (result);
-		result = strdup ("/");
-	}
-
-	return result;
-}
-
-
-/**
- * br_set_fallback_function:
- * func: A function to call to find the binary.
- * data: User data to pass to func.
- *
- * Sets a function to call to find the path to the binary, in
- * case "/proc/self/maps" can't be opened. The function set should
- * return a string that is safe to free with free().
- */
-void
-br_set_locate_fallback_func (br_locate_fallback_func func, void *data)
-{
-	fallback_func = func;
-	fallback_data = data;
-}
-
-
-#ifdef __cplusplus
-}
-#endif /* __cplusplus */
-
-#endif /* _PREFIX_C */

Deleted: trunk/src/lincity-ng/prefix.h
===================================================================
--- trunk/src/lincity-ng/prefix.h	2007-05-04 17:57:06 UTC (rev 1214)
+++ trunk/src/lincity-ng/prefix.h	2007-05-05 09:00:05 UTC (rev 1215)
@@ -1,139 +0,0 @@
-/*
- * BinReloc - a library for creating relocatable executables
- * Written by: Mike Hearn <mike at theoretic.com>
- *             Hongli Lai <h.lai at chello.nl>
- * http://autopackage.org/
- *
- * This source code is public domain. You can relicense this code
- * under whatever license you want.
- *
- * See http://autopackage.org/docs/binreloc/ for
- * more information and how to use this.
- *
- * NOTE: if you're using C++ and are getting "undefined reference
- * to br_*", try renaming prefix.c to prefix.cpp
- */
-
-#ifndef _PREFIX_H_
-#define _PREFIX_H_
-
-#ifdef __cplusplus
-extern "C" {
-#endif /* __cplusplus */
-
-/* WARNING, BEFORE YOU MODIFY PREFIX.C:
- *
- * If you make changes to any of the functions in prefix.c, you MUST
- * change the BR_NAMESPACE macro.
- * This way you can avoid symbol table conflicts with other libraries
- * that also happen to use BinReloc.
- *
- * Example:
- * #define BR_NAMESPACE(funcName) foobar_ ## funcName
- * --> expands br_locate to foobar_br_locate
- */
-#undef BR_NAMESPACE
-#define BR_NAMESPACE(funcName) funcName
-
-
-#ifdef ENABLE_BINRELOC
-
-#define br_thread_local_store BR_NAMESPACE(br_thread_local_store)
-#define br_locate BR_NAMESPACE(br_locate)
-#define br_locate_prefix BR_NAMESPACE(br_locate_prefix)
-#define br_prepend_prefix BR_NAMESPACE(br_prepend_prefix)
-
-#ifndef BR_NO_MACROS
-	/* These are convience macros that replace the ones usually used
-	   in Autoconf/Automake projects */
-	#undef SELFPATH
-	#undef PREFIX
-	#undef PREFIXDIR
-	#undef BINDIR
-	#undef SBINDIR
-	#undef DATADIR
-	#undef LIBDIR
-	#undef LIBEXECDIR
-	#undef ETCDIR
-	#undef SYSCONFDIR
-	#undef CONFDIR
-	#undef LOCALEDIR
-
-	#define SELFPATH	(br_thread_local_store (br_locate ((void *) "")))
-	#define PREFIX		(br_thread_local_store (br_locate_prefix ((void *) "")))
-	#define PREFIXDIR	(br_thread_local_store (br_locate_prefix ((void *) "")))
-	#define BINDIR		(br_thread_local_store (br_prepend_prefix ((void *) "", "/bin")))
-	#define SBINDIR		(br_thread_local_store (br_prepend_prefix ((void *) "", "/sbin")))
-	#define DATADIR		(br_thread_local_store (br_prepend_prefix ((void *) "", "/share")))
-	#define LIBDIR		(br_thread_local_store (br_prepend_prefix ((void *) "", "/lib")))
-	#define LIBEXECDIR	(br_thread_local_store (br_prepend_prefix ((void *) "", "/libexec")))
-	#define ETCDIR		(br_thread_local_store (br_prepend_prefix ((void *) "", "/etc")))
-	#define SYSCONFDIR	(br_thread_local_store (br_prepend_prefix ((void *) "", "/etc")))
-	#define CONFDIR		(br_thread_local_store (br_prepend_prefix ((void *) "", "/etc")))
-	#define LOCALEDIR	(br_thread_local_store (br_prepend_prefix ((void *) "", "/share/locale")))
-#endif /* BR_NO_MACROS */
-
-
-/* The following functions are used internally by BinReloc
-   and shouldn't be used directly in applications. */
-
-char *br_locate		(void *symbol);
-char *br_locate_prefix	(void *symbol);
-char *br_prepend_prefix	(void *symbol, char *path);
-
-#endif /* ENABLE_BINRELOC */
-
-const char *br_thread_local_store (char *str);
-
-
-/* These macros and functions are not guarded by the ENABLE_BINRELOC
- * macro because they are portable. You can use these functions.
- */
-
-#define br_strcat BR_NAMESPACE(br_strcat)
-#define br_extract_dir BR_NAMESPACE(br_extract_dir)
-#define br_extract_prefix BR_NAMESPACE(br_extract_prefix)
-#define br_set_locate_fallback_func BR_NAMESPACE(br_set_locate_fallback_func)
-
-#ifndef BR_NO_MACROS
-  #ifndef ENABLE_BINRELOC        
-	#define BR_SELFPATH(suffix)	SELFPATH suffix
-	#define BR_PREFIX(suffix)	PREFIX suffix
-	#define BR_PREFIXDIR(suffix)	BR_PREFIX suffix
-	#define BR_BINDIR(suffix)	BINDIR suffix
-	#define BR_SBINDIR(suffix)	SBINDIR suffix
-	#define BR_DATADIR(suffix)	DATADIR suffix
-	#define BR_LIBDIR(suffix)	LIBDIR suffix
-	#define BR_LIBEXECDIR(suffix)	LIBEXECDIR suffix
-	#define BR_ETCDIR(suffix)	ETCDIR suffix
-	#define BR_SYSCONFDIR(suffix)	SYSCONFDIR suffix
-	#define BR_CONFDIR(suffix)	CONFDIR suffix
-	#define BR_LOCALEDIR(suffix)	LOCALEDIR suffix
-  #else
-	#define BR_SELFPATH(suffix)	(br_thread_local_store (br_strcat (SELFPATH, suffix)))
-	#define BR_PREFIX(suffix)	(br_thread_local_store (br_strcat (PREFIX, suffix)))
-	#define BR_PREFIXDIR(suffix)	(br_thread_local_store (br_strcat (BR_PREFIX, suffix)))
-	#define BR_BINDIR(suffix)	(br_thread_local_store (br_strcat (BINDIR, suffix)))
-	#define BR_SBINDIR(suffix)	(br_thread_local_store (br_strcat (SBINDIR, suffix)))
-	#define BR_DATADIR(suffix)	(br_thread_local_store (br_strcat (DATADIR, suffix)))
-	#define BR_LIBDIR(suffix)	(br_thread_local_store (br_strcat (LIBDIR, suffix)))
-	#define BR_LIBEXECDIR(suffix)	(br_thread_local_store (br_strcat (LIBEXECDIR, suffix)))
-	#define BR_ETCDIR(suffix)	(br_thread_local_store (br_strcat (ETCDIR, suffix)))
-	#define BR_SYSCONFDIR(suffix)	(br_thread_local_store (br_strcat (SYSCONFDIR, suffix)))
-	#define BR_CONFDIR(suffix)	(br_thread_local_store (br_strcat (CONFDIR, suffix)))
-	#define BR_LOCALEDIR(suffix)	(br_thread_local_store (br_strcat (LOCALEDIR, suffix)))        
-  #endif
-#endif
-
-char *br_strcat	(const char *str1, const char *str2);
-char *br_extract_dir	(const char *path);
-char *br_extract_prefix(const char *path);
-typedef char *(*br_locate_fallback_func) (void *symbol, void *data);
-void br_set_locate_fallback_func (br_locate_fallback_func func, void *data);
-
-
-#ifdef __cplusplus
-}
-#endif /* __cplusplus */
-
-#endif /* _PREFIX_H_ */



From alainb at mail.berlios.de  Sun May  6 23:03:06 2007
From: alainb at mail.berlios.de (alainb at BerliOS)
Date: Sun, 6 May 2007 23:03:06 +0200
Subject: [Lincity-ng-commit] r1216 - trunk/src/lincity
Message-ID: <200705062103.l46L36CM008818@sheep.berlios.de>

Author: alainb
Date: 2007-05-06 23:03:05 +0200 (Sun, 06 May 2007)
New Revision: 1216

Modified:
   trunk/src/lincity/engine.cpp
Log:
fix bug introduced in 1207: build windmill instead of substation :(

Modified: trunk/src/lincity/engine.cpp
===================================================================
--- trunk/src/lincity/engine.cpp	2007-05-05 09:00:05 UTC (rev 1215)
+++ trunk/src/lincity/engine.cpp	2007-05-06 21:03:05 UTC (rev 1216)
@@ -179,6 +179,15 @@
         }
         break;
     case GROUP_SUBSTATION:
+        if (add_a_substation (x, y) == 0) {
+            /* Not enough slots in the substation array */
+            if (last_warning_message_group != group)
+                ok_dial_box ("warning.mes", BAD,
+                    _("Too many substations + windmills. You cannot build one more"));
+            last_warning_message_group = group;
+	    return -3;
+        }
+        break;
     case GROUP_WINDMILL:
 	if (add_a_substation (x, y) == 0) {
             /* Not enough slots in the substation array */



From alainb at mail.berlios.de  Sun May  6 23:33:21 2007
From: alainb at mail.berlios.de (alainb at BerliOS)
Date: Sun, 6 May 2007 23:33:21 +0200
Subject: [Lincity-ng-commit] r1217 - in trunk: . src/lincity
	src/lincity/modules
Message-ID: <200705062133.l46LXLeB010766@sheep.berlios.de>

Author: alainb
Date: 2007-05-06 23:33:21 +0200 (Sun, 06 May 2007)
New Revision: 1217

Modified:
   trunk/TODO
   trunk/src/lincity/engine.cpp
   trunk/src/lincity/modules/rocket_pad.cpp
   trunk/src/lincity/modules/shanty.cpp
Log:
fix corner cases in fire_area

Modified: trunk/TODO
===================================================================
--- trunk/TODO	2007-05-06 21:03:05 UTC (rev 1216)
+++ trunk/TODO	2007-05-06 21:33:21 UTC (rev 1217)
@@ -7,9 +7,18 @@
 Graphics 
 ~~~~~~~~
 
- [M] Draw Mousecursors for normal, link and what's this (eventually also
-     loading and scrolling)
+ [M] Draw Mousecursors for
+        - text normal, link (in help window)
+        - what's this (query tool), bulldoze
+        - (eventually also loading and scrolling)
 
+ [L] Animation of rocket launch 
+
+Sounds
+~~~~~~
+ [L] Add sound for rocket launch and rocket crash. 
+
+
 Programming
 ~~~~~~~~~~~
 

Modified: trunk/src/lincity/engine.cpp
===================================================================
--- trunk/src/lincity/engine.cpp	2007-05-06 21:03:05 UTC (rev 1216)
+++ trunk/src/lincity/engine.cpp	2007-05-06 21:33:21 UTC (rev 1217)
@@ -32,13 +32,63 @@
 int last_warning_message_group = 0;
 
 void
-fire_area (int x, int y)
+fire_area (int xx, int yy)
 {
-  do_bulldoze_area (CST_FIRE_1, x, y);
-  refresh_main_screen ();
-  /*
+    /* this happens when a rocket crashes or on random_fire. */
+    int x = xx;
+    int y = yy;
+    int size;
+    if (MP_GROUP(x,y) == GROUP_WATER || MP_GROUP(x,y) == GROUP_FIRE)
+        return;
+    if (MP_TYPE(x,y) == CST_USED) {
+        x = MP_INFO(xx,yy).int_1;
+        y = MP_INFO(xx,yy).int_2;
+    }
+    size = MP_SIZE(x,y);
+
+    /* Destroy the content of the building to prevent special management
+     * when bulldozed.
+     */
+
+    /* Kill 'only' half of the people (bulldoze item put them in people_pool)
+     * lincity NG 1.1 and previous killed all the people!
+     */
+    if ((MP_INFO(x,y).flags & FLAG_FIRE_COVER) !=0)
+        MP_INFO(x,y).population = MP_INFO(x,y).population / 2;
+    else
+        MP_INFO(x,y).population = 0;
+    MP_INFO(x,y).flags = 0;
+    MP_INFO(x,y).int_1 = 0;
+    MP_INFO(x,y).int_2 = 0;
+    MP_INFO(x,y).int_3 = 0;
+    MP_INFO(x,y).int_4 = 0;
+    MP_INFO(x,y).int_5 = 0;
+    MP_INFO(x,y).int_6 = 0;
+    MP_INFO(x,y).int_7 = 0;
+
+    /* Correctly remove buildings (substations...) and adjust count,
+     * but don't count bulldoze cost
+     * */
+    adjust_money(+main_groups[MP_GROUP(x,y)].bul_cost);
+    bulldoze_item(x, y);
+
+    /* put fire */
+    for (int i = 0; i < size; i++)
+        for (int j = 0; j < size; j++) {
+            bulldoze_mappoint (CST_FIRE_1, x + i, y + j);
+            MP_GROUP(x + i, y + j) = GROUP_FIRE;
+        }
+
+
+    /* AL1: is it necessary ? It is the only place in lincity/. with such a call
+     *  all other are in lincity-ng/.
+     */
+    refresh_main_screen ();
+
+  /* 
     // update transport or we get stuff put in
     // the area from connected tracks etc.
+    // FIXME: AL1: NG 1.1: do the right thing and/or remove this comment
   */
 }
 
@@ -390,7 +440,8 @@
     /* bulldoze preserve underground resources */
     MP_TYPE(x,y) = fill;
     MP_GROUP(x,y) = get_group_of_type(fill);
-    if (MP_GROUP(x,y) < 0) MP_GROUP(x,y) = GROUP_BARE;
+    if (MP_GROUP(x,y) < 0)
+        MP_GROUP(x,y) = GROUP_BARE;
     MP_INFO(x,y).population = 0;
     MP_INFO(x,y).flags = 0;
     MP_INFO(x,y).int_1 = 0;

Modified: trunk/src/lincity/modules/rocket_pad.cpp
===================================================================
--- trunk/src/lincity/modules/rocket_pad.cpp	2007-05-06 21:03:05 UTC (rev 1216)
+++ trunk/src/lincity/modules/rocket_pad.cpp	2007-05-06 21:33:21 UTC (rev 1217)
@@ -108,7 +108,10 @@
 	MP_TYPE(x,y) = CST_ROCKET_5;
 	update_main_screen (0);
 	if (ask_launch_rocket_now (x,y)) {
-	    launch_rocket (x,y);
+            /* ? AL1: in NG 1.1 it seems we are never here ?
+             * ? ask_launch_rocket_now  manages everything and call launch_rocket ?
+             */
+            launch_rocket (x,y);
 	}
 	/* so we don't get get our money back when we bulldoze. */
 	if (x == last_built_x && y == last_built_y) {
@@ -193,6 +196,9 @@
     rockets_launched++;
     MP_TYPE(x,y) = CST_ROCKET_FLOWN;
     update_main_screen (0);
+    /* The first five failures gives 49.419 % chances of 5 success
+     * TODO: some stress could be added by 3,2,1,0 and animation of rocket with sound...
+     */
     r = rand () % MAX_TECH_LEVEL;
     if (r > tech_level || rand () % 100 > (rockets_launched * 15 + 25)) {
 	/* the launch failed */
@@ -203,8 +209,8 @@
 	for (i = 0; i < 20; i++) {
 	    xxx = ((rand () % 20) - 10) + xx;
 	    yyy = ((rand () % 20) - 10) + yy;
-	    if (xxx > 0 && xxx < WORLD_SIDE_LEN	
-		&& yyy > 0 && yyy < WORLD_SIDE_LEN) {
+	    if (xxx > 0 && xxx < (WORLD_SIDE_LEN - 4)
+                    && yyy > 0 && yyy < (WORLD_SIDE_LEN - 4)) {
 		/* don't crash on it's own area */
 		if (xxx >= x && xxx < (x + 4) && yyy >= y && yyy < (y + 4))
 		    continue;
@@ -214,6 +220,7 @@
 	}
     } else {
 	rockets_launched_success++;
+        /* TODO: Maybe should generate some pollution ? */
 	if (rockets_launched_success > 5) {
 	    remove_people (1000);
 	    if (people_pool || housed_population)

Modified: trunk/src/lincity/modules/shanty.cpp
===================================================================
--- trunk/src/lincity/modules/shanty.cpp	2007-05-06 21:03:05 UTC (rev 1216)
+++ trunk/src/lincity/modules/shanty.cpp	2007-05-06 21:33:21 UTC (rev 1217)
@@ -61,9 +61,13 @@
   numof_shanties++;
 }
 
-void remove_a_shanty (int x, int y) {
+void remove_a_shanty (int x, int y)
+{
     numof_shanties--;
-    fire_area (x, y);
+    /* ATTENTION:
+     * fire_area calls bulldoze_item which calls remove shanty.
+     */
+    do_bulldoze_area(CST_FIRE_1,x,y);
 }
 
 void



From alainb at mail.berlios.de  Sat May 12 21:59:31 2007
From: alainb at mail.berlios.de (alainb at BerliOS)
Date: Sat, 12 May 2007 21:59:31 +0200
Subject: [Lincity-ng-commit] r1218 - in trunk/src: lincity lincity/modules
	lincity-ng
Message-ID: <200705121959.l4CJxVkY000663@sheep.berlios.de>

Author: alainb
Date: 2007-05-12 21:59:30 +0200 (Sat, 12 May 2007)
New Revision: 1218

Modified:
   trunk/src/lincity-ng/GameView.cpp
   trunk/src/lincity-ng/MiniMap.cpp
   trunk/src/lincity/engine.cpp
   trunk/src/lincity/ldsvguts.cpp
   trunk/src/lincity/modules/coal_power.cpp
   trunk/src/lincity/modules/solar_power.cpp
   trunk/src/lincity/modules/substation.cpp
   trunk/src/lincity/modules/windmill.cpp
   trunk/src/lincity/power.cpp
Log:
fix compatibility bug introduced in 1207
fix 'recurse_power_grid insane' problem: both output of a power building are on the same grid 
display range of substation around cursor
display power lines in power minimap

Modified: trunk/src/lincity/engine.cpp
===================================================================
--- trunk/src/lincity/engine.cpp	2007-05-06 21:33:21 UTC (rev 1217)
+++ trunk/src/lincity/engine.cpp	2007-05-12 19:59:30 UTC (rev 1218)
@@ -263,10 +263,11 @@
 	                / MAX_TECH_LEVEL));
         break;
     case (GROUP_SOLAR_POWER):
+        MP_INFO(x,y).int_1 = (int)(POWERS_SOLAR_OUTPUT
+	        + (((double) MP_INFO(x,y).int_2 * POWERS_SOLAR_OUTPUT)
+	                / MAX_TECH_LEVEL)); /* like other power sources */
  	MP_INFO(x,y).int_2 = tech_level;
-        MP_INFO(x,y).int_3 = (int)(POWERS_SOLAR_OUTPUT
-	        + (((double) MP_INFO(x,y).int_2 * POWERS_SOLAR_OUTPUT)
-	                / MAX_TECH_LEVEL));
+        MP_INFO(x,y).int_3 = MP_INFO(x,y).int_1; /* Int_3 is kept for compatibility */
         break;
     case GROUP_COMMUNE:
 	numof_communes++;

Modified: trunk/src/lincity/ldsvguts.cpp
===================================================================
--- trunk/src/lincity/ldsvguts.cpp	2007-05-06 21:33:21 UTC (rev 1217)
+++ trunk/src/lincity/ldsvguts.cpp	2007-05-12 19:59:30 UTC (rev 1218)
@@ -610,7 +610,37 @@
 
     print_total_money ();
     reset_animation_times ();
-    map_power_grid(true); /* WCK:  Is this safe to do here? */
+    /* update tech dep for compatibility with old games */
+    for (x = 0; x < WORLD_SIDE_LEN; x++)
+	for (y = 0; y < WORLD_SIDE_LEN; y++) {
+            switch (MP_GROUP(x,y)) {
+            case (GROUP_WINDMILL): 	 
+                MP_INFO(x,y).int_1 = (int)(WINDMILL_POWER 	 
+                        + (((double) MP_INFO(x,y).int_2 * WINDMILL_POWER)
+                                / MAX_TECH_LEVEL));
+                break;
+            case (GROUP_COAL_POWER): 	 
+                MP_INFO(x,y).int_1 = (int)(POWERS_COAL_OUTPUT 	 
+                        + (((double) MP_INFO(x,y).int_4 * POWERS_COAL_OUTPUT) 
+                                / MAX_TECH_LEVEL)); 	 
+                break; 	 
+            case (GROUP_SOLAR_POWER): 	 
+                MP_INFO(x,y).int_1 = (int)(POWERS_SOLAR_OUTPUT 	 
+                        + (((double) MP_INFO(x,y).int_2 * POWERS_SOLAR_OUTPUT) 	 
+                                / MAX_TECH_LEVEL)); 	 
+                break; 	 
+            }
+    }
+ 
+    map_power_grid(true); /* WCK:  Is this safe to do here?
+                           * AL1: No, in NG_1.1
+                           * In case of error message with ok_dial_box
+                           *    the dialog cannot appear because the screen
+                           *    is not set up => crash.
+                           * FIXME: move all initialisation elsewhere, in 
+                           *    engine.cpp or simulate.cpp.
+                           */
+                                
 }
 
 void

Modified: trunk/src/lincity/modules/coal_power.cpp
===================================================================
--- trunk/src/lincity/modules/coal_power.cpp	2007-05-06 21:33:21 UTC (rev 1217)
+++ trunk/src/lincity/modules/coal_power.cpp	2007-05-12 19:59:30 UTC (rev 1218)
@@ -18,6 +18,8 @@
   // int_3 is the stored jobs... Must be an interesting warehouse
   // int_4 is the tech level when built
   // int_5 is the projected output.
+  // int_6 is the grid ID
+  // int_7 is grid_timestamp
 */
 
 

Modified: trunk/src/lincity/modules/solar_power.cpp
===================================================================
--- trunk/src/lincity/modules/solar_power.cpp	2007-05-06 21:33:21 UTC (rev 1217)
+++ trunk/src/lincity/modules/solar_power.cpp	2007-05-12 19:59:30 UTC (rev 1218)
@@ -12,11 +12,10 @@
 /*** Solar Power ***/
 
 /*
-  int_1 is the power to give away,  this must be >= POWER_LINE_CAPACITY
-  for it to pass it to a power line. 
-  Not added to if > POWER_LINE_CAPACITY
+  int_1 unused
   int_2 is the tech level when it was built.
   int_3 is the rated output
+  int_4 unused
   int_5 is the current output
   int_6 is the grid it's on
   int_7 is a grid mapping timestamp

Modified: trunk/src/lincity/modules/substation.cpp
===================================================================
--- trunk/src/lincity/modules/substation.cpp	2007-05-06 21:33:21 UTC (rev 1217)
+++ trunk/src/lincity/modules/substation.cpp	2007-05-12 19:59:30 UTC (rev 1218)
@@ -11,12 +11,17 @@
 
 #include <stdlib.h>
 
-/*** Substations ***/
-/*
-  int_5 is the power demand at this substation
-  int_6 is the grid its connected to
-  int_7 is a grid timestamp
-*/
+/* Substations 
+ *
+ * int_1 unused
+ * int_2 unused
+ * int_3 unused
+ * int_4 is the power demand at this substation 
+ * int_5 forbidden for substations: it is power production from power sources
+ *                and windmill is both a source power and a substation
+ * int_6 is the grid its connected to
+ * int_7 is a grid timestamp
+ */
 
 void 
 do_power_substation (int x, int y) 
@@ -91,7 +96,7 @@
     mps_store_title(i++,_("Substation"));
     i++;
 
-    format_power (s, sizeof(s), MP_INFO(x,y).int_5);    
+    format_power (s, sizeof(s), MP_INFO(x,y).int_4);    
     mps_store_title(i++,_("Local Demand"));
     mps_store_title(i++,s);
     i++;

Modified: trunk/src/lincity/modules/windmill.cpp
===================================================================
--- trunk/src/lincity/modules/windmill.cpp	2007-05-06 21:33:21 UTC (rev 1217)
+++ trunk/src/lincity/modules/windmill.cpp	2007-05-12 19:59:30 UTC (rev 1218)
@@ -13,10 +13,15 @@
   // int_1 is the rated capacity 
   // int_2 is the tech level when built
   // int_3 is the sail count - to choose the right sail.
-  // int_4 is the last real time that a sail was turned
+  // int_4 reserved = local power demand for substations (like windmills)
   // int_5 is the power produced (basically _if_ power produced)
   // int_6 is the grid it's on
   // int_7 is a timestamp for mapping
+  // 
+  // Stored in (x+1, y)
+  //  int_1 reserved = x
+  //  int_2 reserved = y
+  //  int_3 is the last real time that a sail was turned
 */
 void
 do_windmill (int x, int y) 
@@ -27,17 +32,17 @@
     MP_INFO(x,y).int_5 = MP_INFO(x,y).int_1;
     grid[MP_INFO(x,y).int_6]->avail_power += MP_INFO(x,y).int_1;
   } else {
-    MP_INFO(x,y).int_4 = real_time + MODERN_WINDMILL_ANIM_SPEED;
+    MP_INFO(x + 1, y).int_3 = real_time + MODERN_WINDMILL_ANIM_SPEED;
     return;
   }
 
-  /* update animation */
-  if (real_time > MP_INFO(x,y).int_4) {
+  /* update animation. ATTENTION: (x,y) and (x+1,y) are used to store info */
+  if (real_time > MP_INFO(x + 1, y).int_3) {
     MP_INFO(x,y).int_3++;
     if (MP_INFO(x,y).int_2 < MODERN_WINDMILL_TECH) {
-      MP_INFO(x,y).int_4 = real_time + ANTIQUE_WINDMILL_ANIM_SPEED;
+      MP_INFO(x + 1, y).int_3 = real_time + ANTIQUE_WINDMILL_ANIM_SPEED;
     } else {
-      MP_INFO(x,y).int_4 = real_time + MODERN_WINDMILL_ANIM_SPEED;
+      MP_INFO(x + 1, y).int_3 = real_time + MODERN_WINDMILL_ANIM_SPEED;
     }
   }
 
@@ -71,22 +76,19 @@
     char s[12];
     
     mps_store_title(i++,_("Windmill"));
+    mps_store_sfp(i++,_("Tech"),
+		  MP_INFO(x,y).int_2 * 100.0 / MAX_TECH_LEVEL);  
     i++;
    
-    if (MP_INFO(x,y).int_2 < MODERN_WINDMILL_TECH) {
-	mps_store_sfp(i++,_("Tech"),
-		      MP_INFO(x,y).int_2 * 100.0 / MAX_TECH_LEVEL);  
-    } else {
+    if (MP_INFO(x,y).int_2 >= MODERN_WINDMILL_TECH) {
 	mps_store_title(i++,_("Local Status"));
 
-	format_power (s, sizeof(s), MP_INFO(x,y).int_1);    
+	format_power (s, sizeof(s), MP_INFO(x,y).int_5);    
 	mps_store_ss(i++,_("Prod."),s);
 
-	format_power (s, sizeof(s), MP_INFO(x,y).int_5);    
+	format_power (s, sizeof(s), MP_INFO(x,y).int_4);    
 	mps_store_ss(i++,_("Demand"),s);
 
-	mps_store_sfp(i++,_("Tech"),
-		  MP_INFO(x,y).int_2 * 100.0 / MAX_TECH_LEVEL);  
 	i++;
 	
 	mps_store_title(i++,_("Grid Status"));

Modified: trunk/src/lincity/power.cpp
===================================================================
--- trunk/src/lincity/power.cpp	2007-05-06 21:33:21 UTC (rev 1217)
+++ trunk/src/lincity/power.cpp	2007-05-12 19:59:30 UTC (rev 1218)
@@ -1,5 +1,5 @@
  /* ---------------------------------------------------------------------- *
- * engine.c
+ * 
  * This file is part of lincity.
  * Lincity is copyright (c) I J Peters 1995-1997, (c) Greg Sharp 1997-2001.
  * (c) Corey Keasling 2001-2004.
@@ -19,6 +19,8 @@
 #include "power.h"
 #include "transport.h" /* for XY_IS_TRANSPORT */
 
+#include "gui_interface/dialbox_interface.h"
+
 /* reset per map_power_grid run; how many different grids */
 int grid_num = 0;
 
@@ -42,11 +44,17 @@
     if (grid_num == 0)
 	return;
 
+    /* AL1: Do we want to shuffle substations ? It is not done in NG 1.1
+     *     shuffle_substations();
+     */
     for (gi = 1; gi <= grid_num; gi++) {
 	grid[gi]->total_power = grid[gi]->avail_power - 
 		(grid[gi]->power_lines * POWER_LINE_LOSS);
 
 	net = (grid[gi]->total_power - grid[gi]->demand);
+        /* ->powered is used only for animation of power_lines,
+         * substations and windmills
+         */
 	if (net < 0)
 	    grid[gi]->powered = -1;
 	else if (net < (grid[gi]->avail_power / 4))
@@ -59,8 +67,9 @@
     }
 
     /* Clear substation 'Here' counter */
+    /*  int_4 is the local power demand in the substation */
     for (gi = 0; gi < numof_substations; gi++) 
-	MP_INFO(substationx[gi],substationy[gi]).int_5 = 0;
+	MP_INFO(substationx[gi],substationy[gi]).int_4 = 0;
 }
 
 void 
@@ -79,13 +88,13 @@
             }
         }
     }
-
     for (mapx = 0; mapx < WORLD_SIDE_LEN; mapx++) {
 	for (mapy = 0; mapy < WORLD_SIDE_LEN; mapy++) {
 	    if (XY_IS_GRID(mapx,mapy)) {
 		if (MP_INFO(mapx,mapy).int_7 != grid_inc) {
 		    if (grid_num == MAX_GRIDS) {
-			printf("You have too many power grids.  Join some of them\n");
+			ok_dial_box("warning.mes", BAD,
+                                _("You have too many power grids. Join some of them\n"));
 			return;
 		    }
 		    grid[++grid_num] = (Grid *)lcalloc(sizeof(Grid));
@@ -104,8 +113,6 @@
 #endif
 }
 
-
-
 /* 
 check_grid(x, y, xi, yi) - coordinates, ?i being which one to increment if we
 need to step over transport
@@ -121,35 +128,36 @@
 {
   if (XY_IS_GRID(x,y) && !IS_OLD_WINDMILL(x,y)) {
     if (GRID_CURRENT(x,y)) {
-      if (MP_INFO(x,y).int_6 != grid_num)
-	/* XXX: This can occur if connecting to a power source at different
-	   locations.  Need a clean way to resolve this, either connect
-	   the two grids by treating a power source as a power line, or 
-	   let the power source be multihomed and figure out power distribution
-	*/
-	printf("recurse_power_grid insane: %d, %d on a different grid!\n",
-	       x,y);
+        if (MP_INFO(x,y).int_6 != grid_num) {
+                /* XXX: This can occur if connecting to a power source at different
+	         *   locations.
+	         *   Treat a power source or a substation as a power line in order to
+                 *   have both output with the same grid ID.
+	         */
+                return 1;
+        }
     } else if (!IS_POWER_LINE(x,y)) {
-      if (IS_POWER_SOURCE(x,y)) {
-	project_power(x,y); 
-	grid[grid_num]->total_power += MP_INFO(x,y).int_1;
-      }
-      
-      MP_INFO(x,y).int_6 = grid_num;
-      MP_INFO(x,y).int_7 = grid_inc;
-      
+        if (IS_POWER_SOURCE(x,y)) {
+                /* Pick the produced power from power sources */
+                grid[grid_num]->total_power += MP_INFO(x,y).int_5;
+                grid[grid_num]->max_power += MP_INFO(x,y).int_1;
+
+        } /* else = is pure substation */
+        MP_INFO(x,y).int_6 = grid_num;
+        MP_INFO(x,y).int_7 = grid_inc;
+        return 1; /* say power sources and substation are power line */
     } else /* is a power line */
-      return 1;
+        return 1;
+
   } else if (XY_IS_TRANSPORT(x,y) || XY_IS_WATER(x,y)) { /* can we step over?*/
-    if (xi == 0 && yi == 0) /* already stepped */
-      return 0;
-    if (x+xi >= 1 && x+xi < WORLD_SIDE_LEN &&
-	y+yi >= 1 && y+yi < WORLD_SIDE_LEN)
-      return (check_grid(x+xi,y+yi,0,0) ? 2 : 0);
-    else
-      return 0;
+        if (xi == 0 && yi == 0) /* already stepped */
+                return 0;
+        if (x+xi >= 1 && x+xi < WORLD_SIDE_LEN &&
+                        y+yi >= 1 && y+yi < WORLD_SIDE_LEN)
+                return (check_grid(x+xi,y+yi,0,0) ? 2 : 0);
+        else
+                return 0;
   }
-
   return 0;
 }
   
@@ -167,7 +175,6 @@
     int inc;           /* handles special case of stepping over transport */
   
     level++;
-  
     if (count % POWER_MODULUS == 0)
 	count = 0;
 
@@ -175,85 +182,59 @@
        ignore them in the main loop.  This case should only be reached from a 
        call from map_power_grid with a new grid_num, not from a new path in the
        code below */
-
     if (IS_OLD_WINDMILL(mapx, mapy)) {
 	MP_INFO(mapx,mapy).int_6 = grid_num;
 	MP_INFO(mapx,mapy).int_7 = grid_inc;
-
 	grid[grid_num]->max_power += MP_INFO(mapx,mapy).int_1;
-
 	level--;
 	return;
     }
 
-
     /* Crawl about the grid, finding paths and what not.  */
-
     while (dir != 0) {
-
 	/* Set to current grid */
-
 	/* figure out what we are on */
 	if (IS_POWER_LINE(mapx,mapy)) {
 	    grid[grid_num]->power_lines++;
 	    MP_INFO(mapx,mapy).int_5 = (count++ % POWER_MODULUS);
 	    if ((MP_TYPE(mapx,mapy) >= 1) && (MP_TYPE(mapx,mapy) <= 11))
 		MP_TYPE(mapx,mapy) += 11;
-
-
 	}
-
 	MP_INFO(mapx,mapy).int_6 = grid_num;
 	MP_INFO(mapx,mapy).int_7 = grid_inc;
 
-
 	/* For each direction, check map bounds, check if there is power stuff
 	   there, then either remember to follow it later or start a new
 	   recursion to follow the path now */
 
 	/* West */
-	if (mapx >= 1) {
-	    if ((inc = check_grid(mapx - 1, mapy, -1, 0))) {
-		if (dir < 1) {
+	if (mapx >= 1)
+	    if ((inc = check_grid(mapx - 1, mapy, -1, 0)))
+		if (dir < 1)
 		    dir = WEST;
-		} else {
+		else
 		    recurse_power_grid(mapx - inc, mapy, count + 1);
-		}
-	    }
-	}
-
 	/* North */
-	if (mapy >= 1) {
-	    if ((inc = check_grid(mapx, mapy - 1, 0, -1))) {
-		if (dir < 1) {
+	if (mapy >= 1) 
+	    if ((inc = check_grid(mapx, mapy - 1, 0, -1)))
+		if (dir < 1)
 		    dir = NORTH;
-		} else {
+		else
 		    recurse_power_grid(mapx, mapy - inc, count + 1);
-		}
-	    }
-	}
-
 	/* East */    
-	if (mapx < WORLD_SIDE_LEN) {
-	    if ((inc = check_grid(mapx + 1, mapy, 1, 0))) {
-		if (dir < 1) {
+	if (mapx < WORLD_SIDE_LEN)
+	    if ((inc = check_grid(mapx + 1, mapy, 1, 0)))
+		if (dir < 1)
 		    dir = EAST;
-		} else {
+		else 
 		    recurse_power_grid(mapx + inc, mapy, count + 1);
-		}
-	    }
-	}
-
 	/* South */    
-	if (mapy < WORLD_SIDE_LEN) {
-	    if ((inc = check_grid(mapx, mapy + 1, 0, 1))) {
-		if (dir < 1) {
+	if (mapy < WORLD_SIDE_LEN)
+	    if ((inc = check_grid(mapx, mapy + 1, 0, 1)))
+		if (dir < 1)
 		    dir = SOUTH;
-		} else {
+		else 
 		    recurse_power_grid(mapx, mapy + inc, count + 1);
-		}
-	    }
-	}
 
 	/* Move to a new square if the chosen direction is not already mapped. */
 	switch (dir) {
@@ -261,88 +242,45 @@
 	    {
 		dir = 0; 
 	    } break;
-	case WEST: 
-	    {
-		if (mapx >= 1) {
+	case WEST: {
+		if (mapx >= 1)
 		    if ((inc = check_grid(mapx - 1, mapy, -1, 0))) {
 			mapx -= inc;
 			dir = -1;
-		    } else {
+		    } else
 			dir = 0;
-		    }
-		}
 	    } break;
-
-	case NORTH:
-	    {
-		if (mapy >= 1) {
+	case NORTH: {
+		if (mapy >= 1)
 		    if ((inc = check_grid(mapx, mapy - 1, 0, -1))) {
 			mapy -= inc;
 			dir = -1;
-		    } else {
+		    } else
 			dir = 0;
-		    }
-		}
 	    } break;
-
-	case EAST:
-	    {
-		if (mapx < WORLD_SIDE_LEN) {
+	case EAST: {
+		if (mapx < WORLD_SIDE_LEN)
 		    if ((inc = check_grid(mapx + 1, mapy, 1, 0))) {
 			mapx += inc;
 			dir = -1;
-		    } else {
+		    } else
 			dir = 0;
-		    }
-		}
 	    } break;
-
-	case SOUTH:
-	    { 
-		if (mapy < WORLD_SIDE_LEN) {
+	case SOUTH: { 
+		if (mapy < WORLD_SIDE_LEN)
 		    if ((inc = check_grid(mapx, mapy + 1, 0, 1))) {
 			mapy += inc;
 			dir = -1;
-		    } else {
+		    } else
 			dir = 0;
-		    }
-		}
 	    } break;
-	}
-    }
+	} /* switch dir */
+    } /* while dir !=0 */
 
     level--;
     /*  printf("exiting recurse_power_grid:level %d\n",level);*/
 }
 
-/* project_power
-   Get the appropriate number from the proper variable */
-
-void 
-project_power(int mapx, int mapy) 
-{
-  switch (MP_GROUP(mapx,mapy)) {
-  case GROUP_COAL_POWER: 
-    {
-      grid[grid_num]->max_power += MP_INFO(mapx,mapy).int_1;
-    } break;
-  case GROUP_SOLAR_POWER: 
-    {
-      grid[grid_num]->max_power += MP_INFO(mapx,mapy).int_3;
-    } break;
-  case GROUP_WINDMILL: 
-    { 
-      grid[grid_num]->max_power += MP_INFO(mapx,mapy).int_1;
-    } break;
-  default: 
-    {
-      printf("default case in project_power");
-      printf("\tMP_GROUP = %d\n",MP_GROUP(mapx,mapy));
-    } break;
-  }
-}
-
-
 /* get_power
    get power for thing at x, y.  Don't use windmills if industry.
    We go through a list (ugly, I know) until we find a substation in range
@@ -352,7 +290,7 @@
 int 
 get_power (int x, int y, int power, int block_industry)
 {
-
+  /* block_industry = 1 for industries and recyclers */
   int i;
   int xi, yi;
   int grid_tmp; /* for simplicity */
@@ -372,10 +310,15 @@
 
 	grid_tmp = MP_INFO(xi,yi).int_6;
 
+        /* FIXME: in case of unsatisfied demand, the demand may be counted 
+         * several times in differents substations (in the same grid or not)
+         * and thus diplayed informations are misleading.
+         */
 	grid[grid_tmp]->demand += power;
+
 	if (grid[grid_tmp]->total_power >= power) {
 	  grid[grid_tmp]->total_power -= power;
-	  MP_INFO(xi,yi).int_5 += power;
+	  MP_INFO(xi,yi).int_4 += power; // local demand in substation xi yi
 	  return 1;
 	}
 	

Modified: trunk/src/lincity-ng/GameView.cpp
===================================================================
--- trunk/src/lincity-ng/GameView.cpp	2007-05-06 21:33:21 UTC (rev 1217)
+++ trunk/src/lincity-ng/GameView.cpp	2007-05-12 19:59:30 UTC (rev 1218)
@@ -1415,7 +1415,7 @@
             //case CST_POWERL_H_L: break;
             //case CST_POWERS_COAL_EMPTY: break;
             //case CST_POWERS_SOLAR: break;
-            //case CST_SUBSTATION_R: break;
+            case CST_SUBSTATION_R:   range = SUBSTATION_RANGE; break;
             //case CST_WINDMILL_1_R: break;
             //case CST_COMMUNE_1: break;
             //case CST_COALMINE_EMPTY: break;

Modified: trunk/src/lincity-ng/MiniMap.cpp
===================================================================
--- trunk/src/lincity-ng/MiniMap.cpp	2007-05-06 21:33:21 UTC (rev 1217)
+++ trunk/src/lincity-ng/MiniMap.cpp	2007-05-12 19:59:30 UTC (rev 1218)
@@ -717,6 +717,9 @@
             } else {
                 mc=Color(0xFF,0xFF,0xFF);
             }
+            if (MP_GROUP(xx,yy) == GROUP_POWER_LINE)
+                mc=Color(0xFF,0xFF,0); //yellow
+
             mc=light(mc,brightness(getColorNormal(x,y)));
             return mc;
         }



From wolfgangb at mail.berlios.de  Tue May 15 18:46:57 2007
From: wolfgangb at mail.berlios.de (wolfgangb at BerliOS)
Date: Tue, 15 May 2007 18:46:57 +0200
Subject: [Lincity-ng-commit] r1219 - in trunk: . data/help data/help/pt_BR
	data/locale data/locale/gui src/lincity-ng
Message-ID: <200705151646.l4FGkvUG024861@sheep.berlios.de>

Author: wolfgangb
Date: 2007-05-15 18:46:52 +0200 (Tue, 15 May 2007)
New Revision: 1219

Added:
   trunk/data/help/pt_BR/
   trunk/data/help/pt_BR/blacksmith.xml
   trunk/data/help/pt_BR/bulldoze.xml
   trunk/data/help/pt_BR/button-index.xml
   trunk/data/help/pt_BR/coal.xml
   trunk/data/help/pt_BR/coalmine.xml
   trunk/data/help/pt_BR/commune.xml
   trunk/data/help/pt_BR/cricket.xml
   trunk/data/help/pt_BR/dialogs.xml
   trunk/data/help/pt_BR/economy.xml
   trunk/data/help/pt_BR/export.xml
   trunk/data/help/pt_BR/farm.xml
   trunk/data/help/pt_BR/fast.xml
   trunk/data/help/pt_BR/finance.xml
   trunk/data/help/pt_BR/firestation.xml
   trunk/data/help/pt_BR/food.xml
   trunk/data/help/pt_BR/goods.xml
   trunk/data/help/pt_BR/health.xml
   trunk/data/help/pt_BR/help.xml
   trunk/data/help/pt_BR/housing.xml
   trunk/data/help/pt_BR/index.xml
   trunk/data/help/pt_BR/industryh.xml
   trunk/data/help/pt_BR/industryl.xml
   trunk/data/help/pt_BR/jobs.xml
   trunk/data/help/pt_BR/keys.xml
   trunk/data/help/pt_BR/market.xml
   trunk/data/help/pt_BR/medium.xml
   trunk/data/help/pt_BR/mill.xml
   trunk/data/help/pt_BR/mini-screen.xml
   trunk/data/help/pt_BR/monument.xml
   trunk/data/help/pt_BR/msb-coal.xml
   trunk/data/help/pt_BR/msb-cricket.xml
   trunk/data/help/pt_BR/msb-fire.xml
   trunk/data/help/pt_BR/msb-health.xml
   trunk/data/help/pt_BR/msb-normal.xml
   trunk/data/help/pt_BR/msb-pol.xml
   trunk/data/help/pt_BR/msb-power.xml
   trunk/data/help/pt_BR/msb-starve.xml
   trunk/data/help/pt_BR/msb-transport.xml
   trunk/data/help/pt_BR/msb-ub40.xml
   trunk/data/help/pt_BR/ore.xml
   trunk/data/help/pt_BR/oremine.xml
   trunk/data/help/pt_BR/other-costs.xml
   trunk/data/help/pt_BR/park.xml
   trunk/data/help/pt_BR/pause.xml
   trunk/data/help/pt_BR/pbar.xml
   trunk/data/help/pt_BR/pollution.xml
   trunk/data/help/pt_BR/port.xml
   trunk/data/help/pt_BR/pottery.xml
   trunk/data/help/pt_BR/powerline.xml
   trunk/data/help/pt_BR/powerscoal.xml
   trunk/data/help/pt_BR/powerssolar.xml
   trunk/data/help/pt_BR/query.xml
   trunk/data/help/pt_BR/rail.xml
   trunk/data/help/pt_BR/recycle.xml
   trunk/data/help/pt_BR/residential.xml
   trunk/data/help/pt_BR/river.xml
   trunk/data/help/pt_BR/road.xml
   trunk/data/help/pt_BR/rocket.xml
   trunk/data/help/pt_BR/school.xml
   trunk/data/help/pt_BR/slow.xml
   trunk/data/help/pt_BR/steel.xml
   trunk/data/help/pt_BR/substation.xml
   trunk/data/help/pt_BR/sustain.xml
   trunk/data/help/pt_BR/tech-level.xml
   trunk/data/help/pt_BR/tip.xml
   trunk/data/help/pt_BR/track.xml
   trunk/data/help/pt_BR/transport.xml
   trunk/data/help/pt_BR/tutorial-advanced.xml
   trunk/data/help/pt_BR/tutorial-aim.xml
   trunk/data/help/pt_BR/tutorial-basics.xml
   trunk/data/help/pt_BR/tutorial-overview.xml
   trunk/data/help/pt_BR/tutorial-scenario.xml
   trunk/data/help/pt_BR/tutorial.xml
   trunk/data/help/pt_BR/university.xml
   trunk/data/help/pt_BR/windmill.xml
Modified:
   trunk/RELNOTES
   trunk/data/locale/gui/pt_BR.po
   trunk/data/locale/pt_BR.po
   trunk/src/lincity-ng/PbarInterface.cpp
Log:
Brazilian Portuguese help files and updated translation by Jose Carlos Medeiros


Modified: trunk/RELNOTES
===================================================================
--- trunk/RELNOTES	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/RELNOTES	2007-05-15 16:46:52 UTC (rev 1219)
@@ -6,6 +6,7 @@
 * Draw range for selected building around cursor 
 * Online help includes a tutorial
 * Russian online help
+* Brazilian Portuguese online help
 
 *** LincityNG 1.1.0 *** [r1139 in svn] 2007-02-19
 

Added: trunk/data/help/pt_BR/blacksmith.xml
===================================================================
--- trunk/data/help/pt_BR/blacksmith.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/blacksmith.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,20 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Ferreiro</p>
+	<p style="hp">Ferreiros transformam a?o e carv?o em bens. Voc? ira utiliz?-los brevemente neste jogo. Eles utilizam produ??o, obviamente.</p>
+	<p style="hp">Antes de ter sider?rgicas, voc? deve contar com o a?o produzido pelas comunas. ? recomendado 5 ou 6 comunas por ferreiro.</p>
+	<p style="hp">Ferreiros n?o precisam estar conectados ao transporte. Eles podem pegar tudo o que necessitam, dos mercados pr?ximos.</p>
+	<p style="hp">Voc? pode ver o ferreiro em funcionamento da forma usual, clicando nele, e mais frequentemente ver? a anima??o em movimento.</p>
+
+	<p style="hp">Este ? um ferreiro</p>
+	<img src="images/tiles/blacksmith0.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/industry/blacksmith.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="market">Mercado</a></li>
+	<li><a href="ore">Min?rio</a></li>
+	<li><a href="commune">Comuna</a></li>
+	<li><a href="steel">A?o</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/bulldoze.xml
===================================================================
--- trunk/data/help/pt_BR/bulldoze.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/bulldoze.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,12 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Demoli??o</p>
+	<p style="hp">Para demolir uma ?rea voc? deve selecionar o bot?o demolir e ent?o clicar na ?rea que deve ser demolida. A demoli??o custa dinheiro. Quando voc? constuir em uma ?rea, o custo da constru??o e demoli??o ? mostrado no rodap? esquerdo da tela.</p>
+	<p style="hp">Algumas coisas, como os monumentos, s?o muito custosos para serem demolidos. O custo da demoli??o leva em considera??o n?o somente o custo f?sico, mas tamb?m o custo pol?tico. Exemplo, para demolir um monumento, voc? tera protestos e custos judiciais.</p>
+	<p style="hp">Por enquanto, demolir ?reas de rios s?o o ?nico meio de atravess?-los com o transporte. Pense no rio demolido com transporte como se fosse uma ponte.</p>
+	<p style="hp">Este ? o ?cone da demoli??o</p>
+	<img src="images/gui/buttonpanel/base/bulldozer.png" halign="center"/>
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="river">Rios/?gua</a></li>
+</Document>

Added: trunk/data/help/pt_BR/button-index.xml
===================================================================
--- trunk/data/help/pt_BR/button-index.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/button-index.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,124 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Selecione o bot?o ?ndice</p>
+
+	<!--<p style="subtitle">Power</p>-->
+	<img src="images/gui/buttonpanel/power/powerlines.png"/>
+	<p><a href="powerline">Linha de transmiss?o</a></p>
+	
+	<img src="images/gui/buttonpanel/power/solarpower.png"/>
+	<p><a href="powerssolar">Usina el?trica solar</a></p>
+	
+	<img src="images/gui/buttonpanel/power/substation.png"/>
+	<p><a href="substation">Sub-esta??o</a></p>
+
+	<!--<p style="subtitle">Residences</p>-->
+	<img src="images/gui/buttonpanel/residence/residence.png"/>
+	<p><a href="residential">?rea residencial</a></p>
+
+	<!--<p style="subtitle">Parks</p>-->
+	<img src="images/gui/buttonpanel/parks/farm.png"/>
+	<p><a href="farm">Fazenda</a></p>
+
+	<!--<p style="subtitle">Industry</p>-->
+	<img src="images/gui/buttonpanel/industry/market.png"/>
+	<p><a href="market">Mercado</a></p>
+
+	<!--<p style="subtitle">Base</p>-->
+	<img src="images/gui/buttonpanel/base/bulldozer.png"/>
+	<p><a href="bulldoze">Demoli??o</a></p>
+
+	<!--<p style="subtitle">Transport</p>-->
+	<img src="images/gui/buttonpanel/transport/tracks.png"/>
+	<p><a href="track">Pista</a></p>
+
+	<!--<p style="subtitle">Mining</p>-->
+	<img src="images/gui/buttonpanel/mining/coalmine.png"/>
+	<p><a href="coalmine">Mina de carv?o</a></p>
+
+	<!--<p style="subtitle">Transport</p>-->
+	<img src="images/gui/buttonpanel/transport/rails2.png"/>
+	<p><a href="rail">Estrada de ferro</a></p>
+
+	<!--<p style="subtitle">Power</p>-->
+	<img src="images/gui/buttonpanel/power/coalpower.png"/>
+	<p><a href="powerscoal">Usina el?trica carvoeira</a></p>
+
+	<!--<p style="subtitle">Transport</p>-->
+	<img src="images/gui/buttonpanel/transport/road.png"/>
+	<p><a href="road">Estrada</a></p>
+
+	<!--<p style="subtitle">Industry</p>-->
+	<img src="images/gui/buttonpanel/industry/lightindustry.png"/>
+	<p><a href="industryl">Ind?stria leve</a></p>
+
+	<!--<p style="subtitle">Misc</p>-->
+	<img src="images/gui/buttonpanel/misc/university.png"/>
+	<p><a href="university">Universidade</a></p>
+
+	<!--<p style="subtitle">Mining</p>-->
+	<img src="images/gui/buttonpanel/mining/commune.png"/>
+	<p><a href="commune">Comuna</a></p>
+	
+	<img src="images/gui/buttonpanel/mining/oremine.png"/>
+	<p><a href="oremine">Mina de min?rio</a></p>
+
+	<!--<p style="subtitle">Trading</p>-->
+    <img src="images/gui/buttonpanel/transport/port.png"/>
+	<p><a href="export">Importa??o e Exporta??o</a></p>
+
+	<!--<p style="subtitle">Industry</p>-->
+	<img src="images/gui/buttonpanel/industry/heavyindustry2.png"/>
+	<p><a href="industryh">Ind?stria pesada (sider?rgicas)</a></p>
+
+	<!--<p style="subtitle">Parks</p>-->
+	<img src="images/gui/buttonpanel/parks/tree.png"/>
+	<p><a href="park">Parque</a></p>
+
+	<!--<p style="subtitle">Mining</p>-->
+	<img src="images/gui/buttonpanel/mining/recycling.png"/>
+	<p><a href="recycle">Centro de reciclagem</a></p>
+
+	<!--<p style="subtitle">Parks</p>-->
+	<img src="images/gui/buttonpanel/parks/water.png"/>
+	<p><a href="river">Rios/?gua</a></p>
+
+	<!--<p style="subtitle">Misc</p>-->
+	<img src="images/gui/buttonpanel/misc/health.png"/>
+	<p><a href="health">Hospital</a></p>
+
+	<!--<p style="subtitle">Transport</p>-->
+	<img src="images/gui/buttonpanel/transport/rocket.png"/>
+	<p><a href="rocket">Base de lan?amento</a></p>
+
+	<!--<p style="subtitle">Power</p>-->
+	<img src="images/gui/buttonpanel/power/windmills.png"/>
+	<p><a href="windmill">Moinho de vento</a></p>
+
+	<!--<p style="subtitle">Misc</p>-->
+	<img src="images/gui/buttonpanel/parks/monument.png"/>
+	<p><a href="monument">Monumento</a></p>
+
+	<!--<p style="subtitle">Misc</p>-->
+	<img src="images/gui/buttonpanel/misc/book.png"/>
+	<p><a href="school">Escola</a></p>
+
+	<!--<p style="subtitle">Parks</p>-->
+	<img src="images/gui/buttonpanel/parks/mills.png"/>
+	<p><a href="mill">Moinho</a></p>
+
+	<!--<p style="subtitle">Industry</p>-->
+	<img src="images/gui/buttonpanel/industry/pottery.png"/>
+	<p><a href="pottery">Olaria</a></p>
+
+	<!--<p style="subtitle">Misc</p>-->
+	<img src="images/gui/buttonpanel/misc/fire.png"/>
+	<p><a href="firestation">Bombeiro</a></p>
+	
+	<img src="images/gui/buttonpanel/misc/sports.png"/>
+	<p><a href="cricket">Quadra de basquete</a></p>
+
+  <!--<p style="subtitle">Transport</p>-->
+  <img src="images/gui/buttonpanel/transport/port.png"/>
+  <p><a href="port">Porto</a></p>
+</Document>

Added: trunk/data/help/pt_BR/coal.xml
===================================================================
--- trunk/data/help/pt_BR/coal.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/coal.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,15 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Carv?o</p>
+	<p style="hp">Carv?o ? utilizado pelas usinas el?tricas carvoeiras para produzirem eletricidade (energia). Tamb?m ? utilizado pelas olarias, moinhos e ferreiros no processo de produ??o de bens. As ind?strias pesadas (sider?rgicas) utilizam o carv?o quando elas n?o tem eletricidade.</p>
+	<p style="hp">Carv?o pode ser extra?do das minas de carv?o. Existe uma finita reserva de carv?o que voc? pode ver clicando no bot?o de reserva de carv?o (veja em minas de carv?o).</p>
+	<p style="hp">Comunas tamb?m prov?m um pouco de 'carv?o'. Na verdade s?o carv?es vegetais produzidos a partir das ?rvores. Elas produzem pouco, o suficiente para algumas olarias e ferreiros.</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="coalmine">Mina de carv?o</a></li>
+	<li><a href="powerscoal">Usina el?trica carvoeira</a></li>
+	<li><a href="commune">Comuna</a></li>
+	<li><a href="pottery">Olaria</a></li>
+	<li><a href="blacksmith">Ferreiro</a></li>
+	<li><a href="msb-coal">?rea de cobertura do carv?o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/coalmine.xml
===================================================================
--- trunk/data/help/pt_BR/coalmine.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/coalmine.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,21 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Mina de carv?o</p>
+	<p style="hp">Minas de carv?o extraem carv?o do fundo da terra. Deve existir uma jazida de carv?o perto da mina. Para ver onde a jazida esta, voc? deve clicar no bot?o do carv?o que esta um pouco acima do mini-mapa.</p>
+	<p style="hp">A primeira vez que voc? utilizar este bot?o, custar? a voc? 1 milh?o. Ap?s isso ser? livre. Voc? n?o precisa utilizar este bot?o, mas pode tentar encontrar o carv?o por tentativa e erro.</p>
+	<p style="hp">Minas de carv?o precisam de produ??o para minerar o carv?o.</p>
+	
+	<p style="hp">Esta ? uma mina de carv?o</p>
+	<img src="images/tiles/coalmine-full.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/mining/coalmine.png" halign="center"/>
+
+	<p style="hp">Os gr?ficos mostram o montante de carv?o ja extraido e n?o colocado para transporte. A mina de carv?o acima tem o estoque m?ximo.</p>
+	<p style="hp">Clicar numa mina de carv?o mostrar?, em um ponto do mapa na janela de estat?sticas, o estoque de carv?o na mina, e, mais importantemente, a reserva de carv?o dispon?vel.</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="coal">Carv?o</a></li>
+	<li><a href="powerscoal">Usina el?trica carvoeira</a></li>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/commune.xml
===================================================================
--- trunk/data/help/pt_BR/commune.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/commune.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,20 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Comuna</p>
+	<p style="hp">Comunas (por falta de um nome melhor) s?o ?reas onde carvoeiros queimam as ?rvores para produzirem carv?o vegetal. Elas tamb?m produzem pequenas quantidades de min?rio e a?o.</p>
+	<p style="hp">Voc? provavelmente vai precisar de 'poucas' comunas para prover carv?o e a?o suficiente para ?reas como as olarias, ferreiros e moinhos.</p>
+	<p style="hp">Se a comuna n?o produzir nada durante 10 anos ela ser? fechada e a ?rea utilizada ser? transformada em parques.</p>
+	<p style="hp">Comunas podem se conectar ao transporte em qualquer ponto em volta dela, n?o somente pelo port?o.</p>
+	
+	<p style="hp">Esta ? uma comuna</p>
+	<img src="images/tiles/commune1.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/mining/commune.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="pottery">Olaria</a></li>
+	<li><a href="blacksmith">Ferreiro</a></li>
+	<li><a href="mill">Moinho</a></li>
+	<li><a href="oremine">Mina de min?rio</a></li>
+	<li><a href="steel">A?o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/cricket.xml
===================================================================
--- trunk/data/help/pt_BR/cricket.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/cricket.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,23 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Quadra de basquete</p>
+	<p style="hp">Quadras de Basquete fornecem esporte e entreterimento para seus residentes. Elas precisam de bens e produ??o para funcionar. Elas n?o precisam estar conectadas ao transporte, mas neste caso elas devem estar pr?ximas de um mercado para serem supridas de produ??o e bens. Elas tamb?m custam dinheiro para funcionar.</p>
+	<p style="hp">Quando voc? constr?i um quadra de basquete, ela n?o funciona automaticamente. Leva mais ou menos tr?s meses at? que as quadras comecem a funcionar.</p>
+	<p style="hp">Para ver a ?rea coberta pela quadra, clique no bot?o de esportes acima no 'mini-mapa'. As ?reas cobertas s?o exibidas normalmente, e ?reas n?o cobertas aparecem em verde escuro.</p>
+	<p style="hp">Quadras de basquete aumentam a procura de ?reas residenciais em volta.</p>
+	<p style="hp">Quadras de basquete exibem uma sequ?ncia de anima??o todo m?s para mostrar que elas est?o em funcionamento.</p>
+
+	<p style="hp">Esta ? uma quadra de basquete</p>
+	<img src="images/tiles/cricket1.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/misc/sports.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone de cobertura no mapa</p>
+	<img src="images/gui/mapview/roundbuttons/round_sport.png" halign="center"/>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="mini-screen">Mini-mapa</a></li>
+	<li><a href="goods">Bens</a></li>
+	<li><a href="market">Mercado</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+	<li><a href="msb-cricket">?rea de cobertura de esportes</a></li>
+</Document>

Added: trunk/data/help/pt_BR/dialogs.xml
===================================================================
--- trunk/data/help/pt_BR/dialogs.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/dialogs.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,15 @@
+<?xml version="1.0" encoding="utf-8"?>
+<Document style="helpdocument">
+	<p style="htitle">Aba de ajuda</p>
+  <p>Mapa</p>
+    <li><a href="mini-screen">Mini-mapa</a></li>
+  <p>Mercados</p>
+	  <li><a href="pbar">Barra de status dos recursos</a></li>
+  <p>$</p>
+	  <li><a href="finance">Finan?as</a></li>
+	  <li><a href="other-costs">Outros custos</a></li>
+	  <li><a href="housing">Popula??o</a></li>
+  <p>Eco</p>
+	  <li><a href="economy">Gr?fico econ?mico</a></li>
+	  <li><a href="sustain">Janela do progresso sustent?vel</a></li>
+</Document>

Added: trunk/data/help/pt_BR/economy.xml
===================================================================
--- trunk/data/help/pt_BR/economy.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/economy.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,32 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Gr?fico econ?mico</p>
+	<p style="hp">Este gr?fico cont?m quatro linhas coloridas. Eles mostram os fatores econ?micos mais importantes.</p>
+	<li>
+		<span color="brown">Popula??o</span>	(marrom) 
+        A linha marrom representa sua popula??o.
+        Ela ? mostrada como hist?rico em escala.
+	</li>
+	<li>
+		<span color="blue">Desabrigados</span> (azul) 
+        A linha azul representa a demanda por
+        resid?ncias. A altura do gr?fico ?
+        proporcional ? raiz quadrada da
+        popula??o 'desabrigada'.
+	</li>
+	<li>
+		<span color="yellow">Desempregados</span> (amarelo) 
+        A 'barra' s?lida amarela mostra que existem
+        desempregados. A escala deste gr?fico
+        muda conforme sua popula??o. Este gr?fico ? 
+        desenhado de forma s?lida e voc? deve atentar a isto.
+	</li>
+	<li>
+		<span color="red">Famintos</span> (vermelho) 
+        A 'barra' s?lida vermelha mostra que existem
+        famintos. A escala deste gr?fico
+        muda conforme sua popula??o. Este gr?fico ?
+        desenhado de forma s?lida e voc? deve atentar a isto.
+        Esta barra ? desenhada com base no gr?fico de desemprego.
+	</li>
+</Document>

Added: trunk/data/help/pt_BR/export.xml
===================================================================
--- trunk/data/help/pt_BR/export.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/export.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,17 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">?rea de importa??o e exporta??o</p>
+	<p style="hp">As importa??es e exporta??es trabalham da mesma forma, exceto que com a primeira voc? gasta dinheiro e na segunda ganha dinheiro. Ambas requerem um porto. Por esta raz?o, somente as exporta??es ser?o tratadas em detalhe.</p>
+	<p style="hp">Para exportar, o porto deve estar conectado a uma estrada.</p>
+	<p style="hp">Eles <b>devem</b> estar conectados a todos os rios e do lado direito.</p>
+	<p style="hp">A ?rea de exporta??o suportar? tanto quanto ela receber. Se voc? precisa exportar, mas gostaria de restringir a quantidade, voc? pode utilizar um tipo de transporte com menor capacidade, use um peda?o grande ou passe o produto atrav?s de um mercado. Voc? precisar? experimentar para conseguir a melhor configura??o de transporte.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="port">Porto</a></li>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="market">Mercado</a></li>
+	<li><a href="coal">Carv?o</a></li>
+	<li><a href="ore">Min?rio</a></li>
+	<li><a href="goods">Bens</a></li>
+	<li><a href="steel">A?o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/farm.xml
===================================================================
--- trunk/data/help/pt_BR/farm.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/farm.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,19 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Fazenda</p>
+	<p style="hp">Fazendas geram alimento para as pessoas se alimentarem, e suprem com mat?ria prima os moinhos. Os fazendeiros podem vender o alimento nos mercados. Eles levam o alimento em tratores, logo eles n?o precisam estar conectados ao transporte. Contudo eles podem vender para o transporte se quiserem. Mas voc? deve se certificar que o mercado est? pr?ximo da fazenda.</p>
+	
+	<p style="hp">Esta ? uma fazenda</p>
+	<img src="images/tiles/farm0.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/parks/farm.png" halign="center"/>
+	
+	<p style="hp">As fazendas precisam de produ??o para produzir mais que a quantidade m?nima de alimento. Dar energia para a fazenda tamb?m aumenta o montante de alimento produzido. Energia tamb?m inclui o 'velho' tipo de moinho de vento que ajudam o alimento ser processado, diminuindo o desperd?cio.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="market">Mercado</a></li>
+	<li><a href="tech-level">N?vel tecnol?gico</a></li>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="windmill">Moinho de vento</a></li>
+	<li><a href="food">Alimento</a></li>
+</Document>

Added: trunk/data/help/pt_BR/fast.xml
===================================================================
--- trunk/data/help/pt_BR/fast.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/fast.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,10 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Acelera??o r?pida</p>
+	<img src="images/gui/speed/fast.png"/>
+	<p style="hp">Este ? o bot?o de acelera??o r?pida. Ele faz com que o jogo rode o mais r?pido poss?vel. Cuidado ao utilizar o modo r?pido em computadores r?pidos; 'situa??es' pode se desenvolver muito r?pidamente!</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="medium">Acelera??o m?dia</a></li>
+	<li><a href="slow">Acelera??o lenta</a></li>
+</Document>

Added: trunk/data/help/pt_BR/finance.xml
===================================================================
--- trunk/data/help/pt_BR/finance.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/finance.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,10 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Finan?as</p>
+	<p style="hp">Clique esquerdo nesta janela ir? circular entre as janelas 'global finan?as balan?o', detalhe o que s?o 'outros custos' na janela anterior, e 'custo da populacional'.</p>
+	<p style="hp">A janela de finan?as ? atualizada todo dia 1 de Janeiro. A situa??o ser? correspondente as receitas e despesas do ano anterior.</p>
+	<p style="hp">O 'Total' mostrado ? o montante de dinheiro em sua conta. Existem certas coisas que voc? n?o pode fazer quando esta 'no vermelho'.</p>
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="housing">Popula??o</a></li>
+	<li><a href="other-costs">Outros custos</a></li>
+</Document>

Added: trunk/data/help/pt_BR/firestation.xml
===================================================================
--- trunk/data/help/pt_BR/firestation.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/firestation.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,23 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Bombeiro</p>
+	<p style="hp">Bombeiros previnem o in?cio e o espalhamento do fogo na ?rea coberta por eles. Eles precisam ser supridos com bens e produ??o para funcionar. Eles <b>n?o</b> precisam estar conectados ao transporte, por?m eles devem estar perto de um mercado para que possam ser supridos com produ??o e bens. Eles tamb?m custam dinheiro para funcionar.</p>
+	<p style="hp">Quando voc? constr?i um bombeiro, ele n?o come?a a funcionar imediatamente. Geralmente eles levam tr?s meses antes de prover a cobertura contra fogo.</p>
+	<p style="hp">Para ver a ?rea de cobertura, clique no bot?o de bombeiros acima no <i>mini mapa</i>. ?reas cobertas contra fogo s?o mostradas como normal, e ?reas n?o cobertas s?o apenas verde escuro.</p>
+	<p style="hp">Bombeiros aumentam a demanda nas ?reas residenciais em sua volta.</p>
+	<p style="hp">Bombeiros s?o exibidos com uma anima??o todo o m?s para mostrar que eles est?o em funcionamento.</p>
+
+	<p style="hp">Este ? um bombeiro</p>
+	<img src="images/tiles/firestation1.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/misc/fire.png" halign="center"/>
+	<p style="hp">e este ? o ?cone de cobertura no mapa</p>
+	<img src="images/gui/mapview/roundbuttons/round_fire.png" halign="center"/>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="mini-screen">Mini-mapa</a></li>
+	<li><a href="goods">Bens</a></li>
+	<li><a href="market">Mercado</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+	<li><a href="msb-fire">?rea de cobertura dos bombeiros</a></li>
+</Document>

Added: trunk/data/help/pt_BR/food.xml
===================================================================
--- trunk/data/help/pt_BR/food.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/food.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,13 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Alimento</p>
+	<p style="hp">Alimento ? produzido nas fazendas e podem ser importados atrav?s de um porto.</p>
+	<p style="hp">Seu povo precisa de alimento para sobreviver. Se voc? deix?-los famintos, eles ir?o embora da ?rea e alguns poder?o morrer de fome.</p>
+	<p style="hp">Moinhos tamb?m utilizam alimento. Eles transformam algod?o em roupas. Eles podem usar <i>muito</i> alimento - tome cuidado.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="farm">Fazenda</a></li>
+	<li><a href="port">Porto</a></li>
+	<li><a href="mill">Moinho</a></li>
+	<li><a href="steel">A?o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/goods.xml
===================================================================
--- trunk/data/help/pt_BR/goods.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/goods.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,13 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Bens</p>
+	<p style="hp">Bens s?o necess?rios para a maioria das ?reas trabalharem. As pessoas tamb?m gostam muito deles e s?o atra?das para ?reas onde podem encontr?-los.</p>
+	<p style="hp">Bens s?o taxados, ent?o produzir muitos ajudar? nas suas finan?as.</p>
+	<p style="hp">Bens s?o produzidos pelas Olarias, Ferreiros, Moinhos e Ind?strias leves.</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="pottery">Olaria</a></li>
+	<li><a href="blacksmith">Ferreiro</a></li>
+	<li><a href="mills">Moinho</a></li>
+	<li><a href="industryl">Ind?stria leve</a></li>
+</Document>

Added: trunk/data/help/pt_BR/health.xml
===================================================================
--- trunk/data/help/pt_BR/health.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/health.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,25 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Hospital</p>
+	<p style="hp">Hospitais cuidam da sa?de dos residentes. Eles atuam numa ?rea de mais ou menos quatro quadros em cada dire??o.</p>
+	<p style="hp">Hospitais tornam as resid?ncias um local mais desej?vel para se viver, menos pessoas morrem por doen?as relacionadas a polui??o e as pessoas ficam mais eficientes na produ??o de trabalho nas ?reas ao redor (eles perdem menos tempo doentes).</p>
+	<p style="hp">Hospitais s?o muito dispendiosos, 60.000,00 por ano. Contudo, eles reduzem o custo de 'mortes n?o naturais' e podem prover uma receita extra (desde que existam lugares para as pessoas trabalharem).</p>
+	<p style="hp">Ap?s voc? criar um hospital, ele levar? tr?s meses para estar em funcionamento. Eles utilizam bens.	Eles contudo, n?o, utilizam produ??o. Ela ? pega durante o c?lculo do trabalho extra criado devido a redu??o de doen?as nas redondezas.</p>
+	<p style="hp">Hospitais n?o precisam estar conectados ao transporte. Neste caso, eles precisam estar pr?ximos de um mercado.</p>
+	<p style="hp">Para ver a a ?rea de cobertura, clique no ?cone do hospital acima no 'mini-mapa' (abaixo ? direita do centro da tela). As ?reas mostradas como normal tem cobertura hospitalar.</p>
+
+	<p style="hp">Este ? um hospital</p>
+	<img src="images/tiles/health.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/misc/health.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone no mini-mapa</p>
+	<img src="images/gui/mapview/roundbuttons/round_health.png" halign="center"/>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="residential">?rea residencial</a></li>
+	<li><a href="pollution">Polui??o</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+	<li><a href="goods">Bens</a></li>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="msb-health">?rea de cobertura dos hospitais</a></li>
+</Document>

Added: trunk/data/help/pt_BR/help.xml
===================================================================
--- trunk/data/help/pt_BR/help.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/help.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,17 @@
+<?xml version="1.0" encoding="utf-8"?>
+<Document style="helpdocument">
+	<p style="htitle">Ajuda do Lincity</p>
+	<p style="hp">Este ? o sistema de ajuda do Lincity. Favor escolher o t?pico clicando em uma das palavras em azul abaixo. Palavras em azul geralmente indicam um apontamento para outro documento. Utilize a seta no topo esquerdo para voltar para a tela anterior de ajuda.</p>
+	<p style="hp">Durante o jogo, voc? poder? obter ajuda sobre a maioria das coisas utilizando o bot?o de ajuda, ou clicando com o bot?o direito no ?cone de alguma constru??o na barra localizada no topo esquerdo.</p>
+
+	<li><a href="tutorial">Tutorial</a></li>
+	<li><a href="keys">Comandos no teclado</a></li>
+	<li><a href="button-index">Listagem dos itens constru?veis</a></li>
+	<li><a href="mini-screen">Ajuda no mini-mapa</a></li>
+	<li><a href="dialogs">Ajuda das abas de informa??o</a></li>
+	<li><a href="index">?ndice</a></li>
+
+    <p style="htitle">Objetivo</p>
+    <p style="hp">Voc? pode vencer no Lincity ou por construir uma <a href="sustain">economia sustent?vel </a> ou
+    evacuando todos os cidad?os com <a href="rocket">foguetes</a>.</p>
+</Document>

Added: trunk/data/help/pt_BR/housing.xml
===================================================================
--- trunk/data/help/pt_BR/housing.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/housing.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,18 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Popula??o</p>
+	<p style="hp">Esta ? a janela da popula??o.</p>
+	<p style="hp">Esta janela mostra 7 estat?sticas:</p>
+	<li>Popula??o - mostra a popula??o de suas resid?ncias. Esta figura n?o inclui os desabrigados.</li>
+	<li>Morador   - mostra o n?mero total de pessoas que vivem em resid?ncias na sua cidade.</li>
+	<li>Morador % - mostra a percentagem de pessoas que vivem em resid?ncias na sua cidade.</li>
+	<li>Favelas   - mostra o n?mero de favelas na sua cidade.</li>
+	<li>Mortes    - mostra o n?mero de pessoas que morreram de fome ou por causa da polui??o no ?ltimo m?s.</li>
+	<li>Desempr % - mostra a percentagem de pessoas desempregadas.</li>
+	<li>Fome    % - mostra a percentagem de pessoas que passam fome.</li>
+	<p style="hp">Clicar com o esquerdo nesta janela, ir? alternar entre as janelas de finan?as, outros custos e habita??o.</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="finance">Finan?as</a></li>
+	<li><a href="other-costs">Outros custos</a></li>
+</Document>

Added: trunk/data/help/pt_BR/index.xml
===================================================================
--- trunk/data/help/pt_BR/index.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/index.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,79 @@
+<?xml version="1.0" encoding="utf-8"?>
+<Document style="helpdocument">
+<p style="htitle">?ndice</p>
+<li><a href="blacksmith">Ferreiro</a></li>
+<li><a href="bulldoze">Demoli??o</a></li>
+<li><a href="button-index">Selecione o bot?o ?ndice</a></li>
+<li><a href="coal">Carv?o</a></li>
+<li><a href="coalmine">Mina de carv?o</a></li>
+<li><a href="commune">Comuna</a></li>
+<li><a href="cricket">Quadra de basquete</a></li>
+<li><a href="dialogs">Aba de Ajuda</a></li>
+<li><a href="economy">Gr?fico Econ?mico</a></li>
+<li><a href="export">?rea de importa??o e exporta??o</a></li>
+<li><a href="farm">Fazenda</a></li>
+<li><a href="fast">Acelera??o r?pida</a></li>
+<li><a href="finance">Finan?as</a></li>
+<li><a href="firestation">Bombeiro</a></li>
+<li><a href="food">Alimento</a></li>
+<li><a href="goods">Bens</a></li>
+<li><a href="health">Hospital</a></li>
+<li><a href="help">Ajuda do Lincity</a></li>
+<li><a href="housing">Popula??o</a></li>
+<li><a href="industryh">Ind?stria pesada (sider?rgicas)</a></li>
+<li><a href="industryl">Ind?stria leve</a></li>
+<li><a href="jobs">Produ??o</a></li>
+<li><a href="keys">Teclado</a></li>
+<li><a href="keys">Mouse</a></li>
+<li><a href="market">Mercado</a></li>
+<li><a href="medium">Acelera??o m?dia</a></li>
+<li><a href="mill">Moinho</a></li>
+<li><a href="mini-screen">Mini-mapa</a></li>
+<li><a href="monument">Monumento</a></li>
+<li><a href="msb-coal">?rea de cobertura do carv?o</a></li>
+<li><a href="msb-cricket">?rea de cobertura de esportes</a></li>
+<li><a href="msb-fire">?rea de cobertura dos bombeiros</a></li>
+<li><a href="msb-health">?rea de cobertura dos hospitais</a></li>
+<li><a href="msb-normal">Utiliza??o do terreno</a></li>
+<li><a href="msb-pol">?rea de cobertura da polui??o</a></li>
+<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+<li><a href="msb-starve">?rea de cobertura dos famintos</a></li>
+<li><a href="msb-transport">?rea de cobertura do transporte</a></li>
+<li><a href="msb-ub40">?rea de cobertura do desemprego</a></li>
+<li><a href="ore">Min?rio</a></li>
+<li><a href="oremine">Mina de min?rio</a></li>
+<li><a href="other-costs">Outros custos</a></li>
+<li><a href="park">Parque</a></li>
+<li><a href="pause">Bot?o Pausar</a></li>
+<li><a href="pbar">Barra</a></li>
+<li><a href="pollution">Polui??o</a></li>
+<li><a href="port">Porto</a></li>
+<li><a href="pottery">Olaria</a></li>
+<li><a href="powerline">Linha de transmiss?o</a></li>
+<li><a href="powerscoal">Usina el?trica carvoeira</a></li>
+<li><a href="powerssolar">Usina el?trica solar</a></li>
+<li><a href="query">Pesquisa</a></li>
+<li><a href="rail">Estrada de ferro</a></li>
+<li><a href="recycle">Centro de reciclagem</a></li>
+<li><a href="residential">?rea residencial</a></li>
+<li><a href="river">Rios/?gua</a></li>
+<li><a href="road">Estrada</a></li>
+<li><a href="rocket">Base de lan?amento</a></li>
+<li><a href="school">Escola</a></li>
+<li><a href="slow">Acelera??o lenta</a></li>
+<li><a href="steel">A?o</a></li>
+<li><a href="substation">Sub-esta??o</a></li>
+<li><a href="sustain">Sustentabilidade</a></li>
+<li><a href="tech-level">N?vel Tecnol?gico</a></li>
+<li><a href="tip">Aterro (dep?sitos de lixo)</a></li>
+<li><a href="track">Pista</a></li>
+<li><a href="transport">Transporte</a></li>
+<li><a href="tutorial">Tutorial</a></li>
+<li><a href="tutorial-aim">Objetivo</a></li>
+<li><a href="tutorial-overview">Vis?o geral</a></li>
+<li><a href="tutorial-basics">Primeiros passos</a></li>
+<li><a href="tutorial-advanced">Avan?ado</a></li>
+<li><a href="tutorial-scenario">Cen?rio</a></li>
+<li><a href="university">Universidade</a></li>
+<li><a href="windmill">Moinhos de vento</a></li>
+</Document>

Added: trunk/data/help/pt_BR/industryh.xml
===================================================================
--- trunk/data/help/pt_BR/industryh.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/industryh.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,20 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Ind?stria pesada (sider?rgicas)</p>
+	<p style="hp">As sider?rgicas produzem a?o a partir de min?rio, energia e produ??o. O min?rio ? obtido diretamente do transporte. O a?o ? colocado no transporte tamb?m. A produ??o ? obtida do mercado local. O transporte conecta ao canto esquerdo superior.</p>
+	<p style="hp">As sider?rgicas podem receber energia de duas formas. A primeira vinda do carv?o, que ? obtido diretamente do transporte. A segunda vem da eletricidade: voc? deve ter uma ou mais sub-esta??es ativas na ?rea das sider?rgicas. (Os moinhos de vento <b>n?o</b> energizam as sider?rgicas.)</p>
+	<p style="hp">Sider?rgicas produzem polui??o</p>
+	<p style="hp">Voc? pode ver as sider?rgicas em funcionamento da forma usual, clicando nelas, e de vem em quando a anima??o estar? em movimento.</p>
+	
+	<p style="hp">Esta ? uma sider?rgica</p>
+	<img src="images/tiles/industryhl1.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/industry/heavyindustry2.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="pollution">Polui??o</a></li>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="power">Energia</a></li>
+	<li><a href="coal">Carv?o</a></li>
+	<li><a href="ore">Min?rio</a></li>
+</Document>

Added: trunk/data/help/pt_BR/industryl.xml
===================================================================
--- trunk/data/help/pt_BR/industryl.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/industryl.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,20 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Ind?stria leve</p>
+	<p style="hp">Ind?strias leves transformam os min?rios em bens. A transforma??o torna-se mais eficiente caso tenha a?o dispon?vel. Energia aumenta a produ??o ainda mais. Moinhos de vento <b>n?o</b> geram energia para estas ?reas.</p>
+	<p style="hp">Como um princ?pio b?sico, ignorando o acima, a sa?da de uma ?rea ind?strial leve ? muito dependente do montante de materiais b?sicos, incluindo produ??o, que elas podem receber, e tamb?m o montante de bens que podem ser <b>tirados</b>.</p>
+	<p style="hp">Estas ?reas conectam-se diretamente ao transporte para comercializar min?rios, a?o e bens. Eles podem precisar de um mercado para supr?-las com produ??o.</p>
+	<p style="hp">Estas ?reas conectam ao transporte <b>somente</b> ao canto superior da m?o esquerda, como mostrado. O transporte curvar-se-? em quando ? conectado.</p>
+	
+	<p style="hp">Esta ? uma ind?stria leve</p>
+	<img src="images/tiles/industryll1.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/industry/lightindustry.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="road">Estrada</a></li>
+	<li><a href="rail">Estrada de ferro</a></li>
+	<li><a href="market">Mercado</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/jobs.xml
===================================================================
--- trunk/data/help/pt_BR/jobs.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/jobs.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,13 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Produ??o</p>
+	<p style="hp">As pessoas que vivem nas ?reas residenciais geram produ??o. Produ??o ? utilizada pela maioria das ?reas para funcionarem. Algumas ?reas necessitam de produ??o apenas quando est?o em constru??o, por exemplo, os monumentos.</p>
+	<p style="hp">A produ??o deve ser suprida por mercados; voc? deve ter um mercado perto da ?rea que quer suprir. O mercado, certamente, deve pegar sua produ??o de algum lugar. Os mercados pegam a produ??o de duas formas. Primeira, se tiver uma ?rea residencial por perto, ela suprir? o mercado com produ??o na propor??o de sua popula??o	e quanto mais mercados a produ??o pode ser compartilhada entre eles. A segunda forma e pelo transporte. Um mercado um pouco distante transportar? um pouco do excedente de produ??o. Qualquer mercado conectado ao transporte que tiver pouca produ??o pegar? a produ??o atrav?s das pistas, estradas ou trilhos.</p>
+	<p style="hp">Se o mercado estiver 'lotado' de produ??o, ele ir? parar de aceitar produ??o das ?reas residenciais. Quando isto acontecer, e se n?o tiver nenhum outro mercado vazio na ?rea, as pessoas come?ar?o a ficar desempregadas.</p>
+	<p style="hp">Um hospital perto da ?rea residencial, ir? aumentar o n?mero de produ??o de qualquer mercado local.</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="residential">Resid?ncia</a></li>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="market">Mercado</a></li>
+</Document>

Added: trunk/data/help/pt_BR/keys.xml
===================================================================
--- trunk/data/help/pt_BR/keys.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/keys.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,39 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+ 
+    <p style="htitle">Teclado</p>
+    <p style="hp">ESCAPE: troca para a ferramenta de pesquisa</p>
+    <p style="hp">b alterna entre a ferramenta atual e o modo demoli??o</p>
+    <p style="hp">h para esconder constru??es grandes. Pressione h novamente para mostr?-las.</p>
+    <p style="hp">v para alternar entre os modos de coberturas do Mini-Mapa</p>
+    <p style="hp">KP_PLUS: aumentar</p>
+    <p style="hp">KP_MINUS diminuir</p>
+    <p style="hp">KP_ENTER tamanho normal</p>
+    <p style="hp">KP5 coloca o meio do mapa no centro da tela</p>  
+    <p style="hp">KP9 rolar a tela para o norte</p>
+    <p style="hp">KP1 rolar a tela para o sul</p>
+    <p style="hp">KP7 rolar a tela para o oeste</p>
+    <p style="hp">KP3 rolar a tela para o leste</p>
+    <p style="hp">KP2 rolar a tela para sudeste</p> 
+    <p style="hp">KP4 rolar a tela para sudoeste</p> 
+    <p style="hp">KP6 rolar a tela para nordeste</p> 
+    <p style="hp">KP8 rolar a tela para noroeste</p> 
+    <p style="hp">mesmo com o cursor</p>
+    <p style="hp">use shift + dire??o para rolar rapidamente</p>
+    <p style="hp">F12 salvar r?pido</p> 
+    <p style="hp">F9  abrir r?pido</p> 
+
+    <p style="htitle">Mouse</p>
+    <p style="hp">direito:</p>
+    <p style="hp">Segure a tela com o bot?o direito do mouse.</p>
+    <p style="hp">clique com o direito na tela centraliza ao t?tulo sob o cursor.</p>
+    <p style="hp">meio:</p>
+    <p style="hp">clique com o do meio mostra informa??es sobre a ?rea sob o cursor.</p>
+    <p style="hp">esquerdo:</p>
+    <p style="hp">Clique no Mini-Mapa mostra a ?rea selecionada na tela.</p>
+    <p style="hp">Executa uma a??o dependendo da ferramenta selecionada. Demolir, mostra Informa??es, contruir edif?cio.</p>
+    <p style="hp">roda:</p>
+    <p style="hp"> up: aumentar</p>
+    <p style="hp">down: diminuir </p>
+</Document>
+

Added: trunk/data/help/pt_BR/market.xml
===================================================================
--- trunk/data/help/pt_BR/market.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/market.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,35 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Mercado</p>
+	<p style="hp">Mercados s?o uma constru??o chave no Lincity.</p>
+	<p style="hp">Mercado ? provavelmente um mau nome para estas ?reas. Eles s?o mais como centros de trabalho, shoppings armazens e mercados todos em um s?. Eles compram e vendem alimento, produ??o, carv?o, bens, min?rio e a?o para as ?reas ao redor, e para tranportes como as estradas.</p>
+	<p style="hp"><b>Dentro da ?rea </b>de um mercado toda o com?rcio ? feito <b>sem a necessidade de transporte</b>, exceto quando ele ? explicitamente explicado na ajuda de constru??o. Utilize a <a href="msb-transport">?rea de cobertura de transporte e mercado </a> para checar se a constru??o est? dentro da ?rea de um mercado.</p>
+	<li>Pessoas podem obter alimento, bens e empregos dos mercados que est?o na dist?ncia de caminhada da ?rea residencial.</li>
+	<li>Todas as ?reas que requerem produ??o (empregados) obtida nos mercados.</li>
+	<li>Fazendas podem vender os alimentos diretamente para os mercados.</li>
+	<li>Moinhos, olarias e ferreiros vendem bens diretamente para os mercados pr?ximos, eles tamb?m pegam as mat?rias prima dos mesmos mercados.</li>
+	<p style="hp">Se n?o tiver mercado dispon?vel, estas contru??es precisaram estar conectadas ao <a href="transport"> transporte</a>.</p>
+	<p style="hp">A segunda aba do mini-mapa mostra o <b>estoque total dos mercados</b>, e como este evolui com uma barra de progresso. Nesta conjun??o com mini-mapas (mini ?cones logo abaixo) ajudar? muito voc? a ter uma boa vis?o de recursos espec?ficos (alimento, emprego ...).</p>
+
+	<p style="hsubtitle">Controlar quais mercados podem comprar e vender</p>
+	<p style="hp">Voc? pode controlar a fun??o do mercado selecionando o que pode vender e comprar do transporte. Clique duas vezes no mercado (n?o no bot?o de sele??o) e na dire??o do topo esquerdo uma janela aparecer? permitindo voc? a selecionar o que ser? comercializado. O padr?o ? comercializar qualquer coisa.</p>
+
+	<p style="hp">Este ? um mercado</p>
+	<img src="images/tiles/market-empty.png" halign="center"/>
+	<p style="hp">e este seu ?cone</p>
+	<img src="images/gui/buttonpanel/industry/market.png" halign="center"/>
+	<p style="hp">Isto significa que o com?rcio ? permitido.</p>
+	<img src="images/gui/checkbox/checkbox_checked.png" halign="center"/>
+	<p style="hp">Isto significa que o com?rcio <b>n?o</b> ? permitido.</p>
+	<img src="images/gui/checkbox/checkbox.png" halign="center"/>
+	<p style="hp">Os n?meros entre as palavras Comprar e Vender s?o a referencia no mapa para este mercado.</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="food">Alimento</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+	<li><a href="coal">Carv?o</a></li>
+	<li><a href="goods">Bens</a></li>
+	<li><a href="ore">Min?rio</a></li>
+	<li><a href="steel">A?o</a></li>
+	<li><a href="transport">Transporte</a></li>
+</Document>

Added: trunk/data/help/pt_BR/medium.xml
===================================================================
--- trunk/data/help/pt_BR/medium.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/medium.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,12 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Acelera??o m?dia</p>
+	<img src="images/gui/speed/normal.png"/>
+	<p style="hp">Este ? o bot?o da acelera??o m?dia. Ele faz com que o jogo rode em acelera??o m?dia. Em computadores lentos os bot?es de acelera??o podem n?o ter efeito.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="slow">Acelera??o lenta</a></li>
+	<li><a href="fast">Acelera??o r?pida</a></li>
+</Document>
+
+

Added: trunk/data/help/pt_BR/mill.xml
===================================================================
--- trunk/data/help/pt_BR/mill.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/mill.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,22 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Moinho</p>
+	<p style="hp">Os moinhos transformam alimento, carv?o e produ??o em bens. Alimento?... bem, algod?o e l? s?o contados como alimento neste jogo.</p>
+	<p style="hp">Os moinhos utilizam bastante alimento, ent?o voc? pode facilmente obte-los dos estoques de alimentos caso n?o queira que fiquem armazenados. (Isto ? um pequeno problema quando voc? tem os moinhos de vento, ja que eles energizam as fazendas fazendo com que elas se tornem mais eficientes)</p>
+	<p style="hp">Os moinhos n?o precisam estar conectados ao transporte. Neste caso, eles devem estar pr?ximos de um mercado com carv?o, produ??o e alimentos. Voc? pode saber quando os moinhos est?o em funcionamento pela fuma?a e vapores vindo do mesmo.</p>
+	
+	<p style="hp">Este ? um moinho</p>
+	<img src="images/tiles/mill1.png" halign="center"/>
+	<p style="hp">Este ? um moinho fora de funcionamento</p>
+	<img src="images/tiles/mill0.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/parks/mills.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="goods">Bens</a></li>
+	<li><a href="food">Alimento</a></li>
+	<li><a href="coal">Carv?o</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="windmill">Moinho de vento</a></li>
+</Document>

Added: trunk/data/help/pt_BR/mini-screen.xml
===================================================================
--- trunk/data/help/pt_BR/mini-screen.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/mini-screen.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,20 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Mini-mapa</p>
+	<p style="hp">O mini-mapa mostra, em uma escala reduzida, o conjunto da sua ?rea do jogo. Os mini-bot?es a seguir, quando clicados, mostram informa??es como os n?veis de polui??o de toda a sua ?rea do jogo.</p>
+	<p style="hp">Clique com o bot?o direito em cada um dos bot?es a seguir no mini-mapa para ativar as p?ginas de ajuda.</p>
+	<p style="hp">A borda em branco mostra a ?rea coberta pela tela principal.</p>
+	<p style="hp">O bot?o grande "cobertura" mostra a ?rea de cobertura do conte?do no mini-mapa da tela principal</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="msb-coal">?rea de cobertura do carv?o</a></li>
+	<li><a href="msb-cricket">?rea de cobertura de esportes</a></li>
+	<li><a href="msb-fire">?rea de cobertura dos bombeiros</a></li>
+	<li><a href="msb-health">?rea de cobertura dos hospitais</a></li>
+	<li><a href="msb-normal">Utiliza??o do terreno</a></li>
+	<li><a href="msb-pol">?rea de cobertura da polui??o</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+	<li><a href="msb-starve">?rea de cobertura dos famintos</a></li>
+	<li><a href="msb-transport">?rea de cobertura do transporte</a></li>
+	<li><a href="msb-ub40">?rea de cobertura do desemprego</a></li>
+</Document>

Added: trunk/data/help/pt_BR/monument.xml
===================================================================
--- trunk/data/help/pt_BR/monument.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/monument.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,20 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Monumento</p>
+	<p style="hp">Os monumentos fornecem um ponto focal para o aprendizado e inspira??o dos inventores.	Cada monumento que voc? construir ir? aumentar a taxa de crescimento de tecnologia, mas a efetividade cai para zero a medida que voc? for para 40% de n?vel tecnol?gico.</p>
+	<p style="hp">Para construir um monumento voc? precisa de produ??o. <b>Muita</b> produ??o. Por esta raz?o eles s?o ?teis para controlar o desemprego. Mas ? apenas uma solu??o de curto prazo para o problema do desemprego ja que os monumentos n?o utilizam produ??o ap?s serem totalmente constru?dos.</p>
+	<p style="hp">Voc? pode descobrir quanto foi construido clicando no monumento e olhando para a janela de status (topo esquerdo do centro). Al?m disso o gr?fico muda enquanto ele ? construido. Existem 6 gr?ficos que mostram o est?gio da constru??o de 0% ? 100%</p>
+	<p style="hp"><b>Dica</b>: Como parar a constru??o de um monumento que esta utilizando muita produ??o de uma ?rea e com isso atrapalhando outras ?reas de produ??o: construa o monumento longe de outras ?reas.</p>
+
+	<p style="hp">Este ? um monumento</p>
+	<img src="images/tiles/monument5.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/parks/monument.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="market">Mercado</a></li>
+	<li><a href="ore">Min?rio</a></li>
+	<li><a href="commune">Comuna</a></li>
+	<li><a href="steel">A?o</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/msb-coal.xml
===================================================================
--- trunk/data/help/pt_BR/msb-coal.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/msb-coal.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,21 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">?rea de cobertura do carv?o</p>
+	<img src="images/gui/mapview/roundbuttons/round_coal.png" halign="center"/>
+	<p style="hp">A mini tela de carv?o mostra as reservas de carv?o em sua cidade. As jazidas de carv?o s?o exibidas como branco em um fundo preto. Voc? vai precisar construir uma mina de carv?o perto de uma dessas jazidas para extrair o carv?o.</p>
+	<p style="hp">A primeira vez que voc? perguntar por esta informa??o, voc? poder? ter uma an?lize do carv?o o que custar? uma milh?o. Ap?s isso a informa??o ficar? livre para futuras visualiza??es.</p>
+	<p style="hp">Clique esquerdo no mini-mapa para reposicionar a janela principal. Clique esquerdo no t?tulo do mini-mapa para escolher uma mini tela diferente. Alterne entre os modos de corbertura pressionando 'v' ou com um clique com o bot?o do meio no t?tulo do mini-mapa.</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="mini-screen">Mini-mapa</a></li>
+	<li><a href="msb-cricket">?rea de cobertura de esportes</a></li>
+	<li><a href="msb-fire">?rea de cobertura dos bombeiros</a></li>
+	<li><a href="msb-health">?rea de cobertura dos hospitais</a></li>
+	<li><a href="msb-normal">Utiliza??o do terreno</a></li>
+	<li><a href="msb-pol">?rea de cobertura da polui??o</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+	<li><a href="msb-starve">?rea de cobertura dos famintos</a></li>
+	<li><a href="msb-transport">?rea de cobertura do transporte</a></li>
+	<li><a href="msb-ub40">?rea de cobertura do desemprego</a></li>
+</Document>
+

Added: trunk/data/help/pt_BR/msb-cricket.xml
===================================================================
--- trunk/data/help/pt_BR/msb-cricket.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/msb-cricket.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,21 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">?rea de cobertura de esportes</p>
+	<img src="images/gui/mapview/roundbuttons/round_sport.png" halign="center"/>
+	<p style="hp">?reas que est?o cobertas por esporte s?o exibidas em verde escuro.</p>
+	<p style="hp">?reas que est?o longe de uma quadra de basquete s?o mostradas como normal.</p>
+	<p style="hp">Lembre-se, as quadras de basquete levam tr?s meses para ficarem ativas.</p>
+	<p style="hp">Clique esquerdo no mini-mapa para reposicionar a janela principal. Clique esquerdo no t?tulo do mini-mapa para escolher uma mini tela diferente. Alterne entre os modos de corbertura pressionando 'v' ou com um clique com o bot?o do meio no t?tulo do mini-mapa.</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="mini-screen">Mini-mapa</a></li>
+	<li><a href="msb-coal">?rea de cobertura do carv?o</a></li>
+	<li><a href="msb-fire">?rea de cobertura dos bombeiros</a></li>
+	<li><a href="msb-health">?rea de cobertura dos hospitais</a></li>
+	<li><a href="msb-normal">Utiliza??o do terreno</a></li>
+	<li><a href="msb-pol">?rea de cobertura da polui??o</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+	<li><a href="msb-starve">?rea de cobertura dos famintos</a></li>
+	<li><a href="msb-transport">?rea de cobertura do transporte</a></li>
+	<li><a href="msb-ub40">?rea de cobertura do desemprego</a></li>
+</Document>

Added: trunk/data/help/pt_BR/msb-fire.xml
===================================================================
--- trunk/data/help/pt_BR/msb-fire.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/msb-fire.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,21 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">?rea de cobertura dos bombeiros</p>
+	<img src="images/gui/mapview/roundbuttons/round_fire.png" halign="center"/>
+	<p style="hp">?reas que est?o pr?ximas de um bombeiro s?o mostradas em verde escuro.</p>
+	<p style="hp">As ?reas n?o pr?ximas de um bombeiro s?o exibidas como normal.</p>
+	<p style="hp">Lembre-se, os bombeiros levam tr?s meses para ficarem ativos.</p>
+	<p style="hp">Clique esquerdo no mini-mapa para reposicionar a janela principal. Clique esquerdo no t?tulo do mini-mapa para escolher uma mini tela diferente. Alterne entre os modos de corbertura pressionando 'v' ou com um clique com o bot?o do meio no t?tulo do mini-mapa.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="mini-screen">Mini-mapa</a></li>
+	<li><a href="msb-coal">?rea de cobertura do carv?o</a></li>
+	<li><a href="msb-cricket">?rea de cobertura de esportes</a></li>
+	<li><a href="msb-health">?rea de cobertura dos hospitais</a></li>
+	<li><a href="msb-normal">Utiliza??o do terreno</a></li>
+	<li><a href="msb-pol">?rea de cobertura da polui??o</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+	<li><a href="msb-starve">?rea de cobertura dos famintos</a></li>
+	<li><a href="msb-transport">?rea de cobertura do transporte</a></li>
+	<li><a href="msb-ub40">?rea de cobertura do desemprego</a></li>
+</Document>

Added: trunk/data/help/pt_BR/msb-health.xml
===================================================================
--- trunk/data/help/pt_BR/msb-health.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/msb-health.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,33 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">?rea de cobertura dos hospitais</p>
+	<img src="images/gui/mapview/roundbuttons/round_health.png" halign="center"/>
+	<p style="hp">?reas que est?o pr?ximas de um hospital s?o mostradas em verde escuro.</p>
+	<p style="hp">As ?reas n?o pr?ximas de um hospital s?o exibidas como normal.</p>
+	<p style="hp">Lembre-se, os hospitais levam tr?s meses para ficarem ativos.</p>
+	<p style="hp">Clique esquerdo no mini-mapa para reposicionar a janela principal. Clique esquerdo no t?tulo do mini-mapa para escolher uma mini tela diferente. Alterne entre os modos de corbertura pressionando 'v' ou com um clique com o bot?o do meio no t?tulo do mini-mapa.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="mini-screen">Mini-mapa</a></li>
+	<li><a href="msb-coal">?rea de cobertura do carv?o</a></li>
+	<li><a href="msb-cricket">?rea de cobertura de esportes</a></li>
+	<li><a href="msb-fire">?rea de cobertura dos bombeiros</a></li>
+	<li><a href="msb-normal">Utiliza??o do terreno</a></li>
+	<li><a href="msb-pol">?rea de cobertura da polui??o</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+	<li><a href="msb-starve">?rea de cobertura dos famintos</a></li>
+	<li><a href="msb-transport">?rea de cobertura do transporte</a></li>
+	<li><a href="msb-ub40">?rea de cobertura do desemprego</a></li>
+</Document>
+
+
+
+<!--
+
+text -1 270 Left click on the mini screen 
+text -1 280 to reposition the main window.
+text -1 300 Left click on the mini screen title 
+text -1 310 to choose a different mini screen view.
+text -1 330 Toggle overlay mode by pressing 'v' 
+text -1 340 or middle click on the mini screen title (X only)
+-->

Added: trunk/data/help/pt_BR/msb-normal.xml
===================================================================
--- trunk/data/help/pt_BR/msb-normal.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/msb-normal.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,19 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Utiliza??o do terreno</p>
+	<img src="images/gui/mapview/roundbuttons/round_resident.png" halign="center"/>
+	<p style="hp">A mini tela de uso do terreno mostra constru??es, estradas, ?gua e espa?os verdes na cidade.</p>
+	<p style="hp">Clique esquerdo no mini-mapa para reposicionar a janela principal. Clique esquerdo no t?tulo do mini-mapa para escolher uma mini tela diferente. Alterne entre os modos de corbertura pressionando 'v' ou com um clique com o bot?o do meio no t?tulo do mini-mapa.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="mini-screen">Mini-mapa</a></li>
+	<li><a href="msb-coal">?rea de cobertura do carv?o</a></li>
+	<li><a href="msb-cricket">?rea de cobertura de esportes</a></li>
+	<li><a href="msb-fire">?rea de cobertura dos bombeiros</a></li>
+	<li><a href="msb-health">?rea de cobertura dos hospitais</a></li>
+	<li><a href="msb-pol">?rea de cobertura da polui??o</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+	<li><a href="msb-starve">?rea de cobertura dos famintos</a></li>
+	<li><a href="msb-transport">?rea de cobertura do transporte</a></li>
+	<li><a href="msb-ub40">?rea de cobertura do desemprego</a></li>
+</Document>

Added: trunk/data/help/pt_BR/msb-pol.xml
===================================================================
--- trunk/data/help/pt_BR/msb-pol.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/msb-pol.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,21 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">?rea de cobertura da polui??o</p>
+	<img src="images/gui/mapview/roundbuttons/round_pollution.png" halign="center"/>
+	<p style="hp">A mini tela da polui??o mostra os n?veis de polui??o pela cidade.</p>
+	<p style="hp">A polui??o vai ficando mais forte conforme vai de: Verde claro -> Verde escuro -> Verde mais escuro -> Vermelho escuro -> Vermelho claro -> Vermelho brilhante.</p>
+	<p style="hp">Lugares com ?reas residenciais mostradas em vermelho causam doen?as e tornam a ?rea menos desej?vel de se viver.</p>
+	<p style="hp">Clique esquerdo no mini-mapa para reposicionar a janela principal. Clique esquerdo no t?tulo do mini-mapa para escolher uma mini tela diferente. Alterne entre os modos de corbertura pressionando 'v' ou com um clique com o bot?o do meio no t?tulo do mini-mapa.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="mini-screen">Mini-mapa</a></li>
+	<li><a href="msb-coal">?rea de cobertura do carv?o</a></li>
+	<li><a href="msb-cricket">?rea de cobertura de esportes</a></li>
+	<li><a href="msb-fire">?rea de cobertura dos bombeiros</a></li>
+	<li><a href="msb-health">?rea de cobertura dos hospitais</a></li>
+	<li><a href="msb-normal">Utiliza??o do terreno</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+	<li><a href="msb-starve">?rea de cobertura dos famintos</a></li>
+	<li><a href="msb-transport">?rea de cobertura do transporte</a></li>
+	<li><a href="msb-ub40">?rea de cobertura do desemprego</a></li>
+</Document>

Added: trunk/data/help/pt_BR/msb-power.xml
===================================================================
--- trunk/data/help/pt_BR/msb-power.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/msb-power.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,22 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">?rea de cobertura el?trica</p>
+	<img src="images/gui/mapview/roundbuttons/round_electrics.png" halign="center"/>
+	<p style="hp">?reas que tem o moinho de vento como gerador de energia s?o mostradas em verde escuro.</p>
+	<p style="hp">As ?reas pr?ximas de um principal gerador de energia s?o mostradas em verde claro.</p>
+	<p style="hp">As ?reas sem suprimento de energia s?o mostradas como normal.</p>
+	<p style="hp">Este bot?o utiliza energia. Tente n?o deix?-lo ligado por muito tempo.</p>
+	<p style="hp">Clique esquerdo no mini-mapa para reposicionar a janela principal. Clique esquerdo no t?tulo do mini-mapa para escolher uma mini tela diferente. Alterne entre os modos de corbertura pressionando 'v' ou com um clique com o bot?o do meio no t?tulo do mini-mapa.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="mini-screen">Mini-mapa</a></li>
+	<li><a href="msb-coal">?rea de cobertura do carv?o</a></li>
+	<li><a href="msb-cricket">?rea de cobertura de esportes</a></li>
+	<li><a href="msb-fire">?rea de cobertura dos bombeiros</a></li>
+	<li><a href="msb-health">?rea de cobertura dos hospitais</a></li>
+	<li><a href="msb-normal">Utiliza??o do terreno</a></li>
+	<li><a href="msb-pol">?rea de cobertura da polui??o</a></li>
+	<li><a href="msb-starve">?rea de cobertura dos famintos</a></li>
+	<li><a href="msb-transport">?rea de cobertura do transporte</a></li>
+	<li><a href="msb-ub40">?rea de cobertura do desemprego</a></li>
+</Document>

Added: trunk/data/help/pt_BR/msb-starve.xml
===================================================================
--- trunk/data/help/pt_BR/msb-starve.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/msb-starve.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,20 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">?rea de cobertura dos famintos</p>
+	<img src="images/gui/mapview/roundbuttons/round_food.png" halign="center"/>
+	<p style="hp">A mini tela de famintos mostra somente ?reas residenciais.</p>
+	<p style="hp">Verde brilhante significa que n?o h? alimento suficiente na ?rea residencial. O verde mais escuro e o vermelho brilhante mostra um grave crescimento de famintos em cada ?rea residencial exibida.</p>
+	<p style="hp">Clique esquerdo no mini-mapa para reposicionar a janela principal. Clique esquerdo no t?tulo do mini-mapa para escolher uma mini tela diferente. Alterne entre os modos de corbertura pressionando 'v' ou com um clique com o bot?o do meio no t?tulo do mini-mapa.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="mini-screen">Mini-mapa</a></li>
+	<li><a href="msb-coal">?rea de cobertura do carv?o</a></li>
+	<li><a href="msb-cricket">?rea de cobertura de esportes</a></li>
+	<li><a href="msb-fire">?rea de cobertura dos bombeiros</a></li>
+	<li><a href="msb-health">?rea de cobertura dos hospitais</a></li>
+	<li><a href="msb-normal">Utiliza??o do terreno</a></li>
+	<li><a href="msb-pol">?rea de cobertura da polui??o</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+	<li><a href="msb-transport">?rea de cobertura do transporte</a></li>
+	<li><a href="msb-ub40">?rea de cobertura do desemprego</a></li>
+</Document>

Added: trunk/data/help/pt_BR/msb-transport.xml
===================================================================
--- trunk/data/help/pt_BR/msb-transport.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/msb-transport.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,19 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">?rea de cobertura do transporte</p>
+	<img src="images/gui/mapview/roundbuttons/round_road.png" halign="center"/>
+	<p style="hp">A mini tela dos transportes mostra a quantidade de bens nas <a href="track">pistas</a>, <a href="road">estradas </a> e <a href="rail">trilhos</a> na cidade.</p>
+	<p style="hp">As cores azuladas indicam constru??es que est?o dentro da ?rea de um <a href="market">mercado</a>.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="mini-screen">Mini-mapa</a></li>
+	<li><a href="msb-coal">?rea de cobertura do carv?o</a></li>
+	<li><a href="msb-cricket">?rea de cobertura de esportes</a></li>
+	<li><a href="msb-fire">?rea de cobertura dos bombeiros</a></li>
+	<li><a href="msb-health">?rea de cobertura dos hospitais</a></li>
+	<li><a href="msb-normal">Utiliza??o do terreno</a></li>
+	<li><a href="msb-pol">?rea de cobertura da polui??o</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+	<li><a href="msb-starve">?rea de cobertura dos famintos</a></li>
+	<li><a href="msb-ub40">?rea de cobertura do desemprego</a></li>
+</Document>

Added: trunk/data/help/pt_BR/msb-ub40.xml
===================================================================
--- trunk/data/help/pt_BR/msb-ub40.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/msb-ub40.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,20 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">?rea de cobertura do desemprego</p>
+	<img src="images/gui/mapview/roundbuttons/round_ub40.png" halign="center"/>
+	<p style="hp">A mini tela do desemprego mostra somente ?reas residenciais.</p>
+	<p style="hp">Verde brilhante significa que n?o existem desempregados na ?rea residencial. Verde mais escuro e o vermelho brilhante mostram um grande crescimento de desempregados nas ?reas residenciais mostradas.</p>
+	<p style="hp">Clique esquerdo no mini-mapa para reposicionar a janela principal. Clique esquerdo no t?tulo do mini-mapa para escolher uma mini tela diferente. Alterne entre os modos de corbertura pressionando 'v' ou com um clique com o bot?o do meio no t?tulo do mini-mapa.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="mini-screen">Mini-mapa</a></li>
+	<li><a href="msb-coal">?rea de cobertura do carv?o</a></li>
+	<li><a href="msb-cricket">?rea de cobertura de esportes</a></li>
+	<li><a href="msb-fire">?rea de cobertura dos bombeiros</a></li>
+	<li><a href="msb-health">?rea de cobertura dos hospitais</a></li>
+	<li><a href="msb-normal">Utiliza??o do terreno</a></li>
+	<li><a href="msb-pol">?rea de cobertura da polui??o</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+	<li><a href="msb-starve">?rea de cobertura dos famintos</a></li>
+	<li><a href="msb-transport">?rea de cobertura do transporte</a></li>
+</Document>

Added: trunk/data/help/pt_BR/ore.xml
===================================================================
--- trunk/data/help/pt_BR/ore.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/ore.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,14 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Min?rio</p>
+	<p style="hp">Min?rio ? uma das mat?rias primas b?sicas do jogo. Comunas, minas de min?rios e recicladores produzem min?rio.</p>
+	<p style="hp">Olarias, ind?strias pequenas e ind?strias pesadas utilizam min?rios.</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="commune">Comuna</a></li>
+	<li><a href="oremine">Mina de min?rio</a></li>
+	<li><a href="recycle">Centro de reciclagem</a></li>
+	<li><a href="pottery">Olaria</a></li>
+	<li><a href="indistryl">Ind?stria leve</a></li>
+	<li><a href="indistryh">Ind?stria pesada</a></li>
+</Document>

Added: trunk/data/help/pt_BR/oremine.xml
===================================================================
--- trunk/data/help/pt_BR/oremine.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/oremine.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,18 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Mina de min?rio</p>
+	<p style="hp">Minas de min?rios provem min?rios para a gera??o de bens e a?o. Voc? pode construir uma mina de min?rio em qualquer lugar. O min?rio sob a ?rea ? consumido vagarosamente; voc? n?o pode demolir e construir outra esperando obter mais min?rio.</p>
+	<p style="hp">Quando uma mina se exaurir ela se tornar? um lago. Se voc? quiser recuperar esta terra voc? dever? demolir 16 ?reas de ?gua!</p>
+	<p style="hp">O gr?fico mostra as minas de min?rio que est?o sendo fortemente trabalhadas para se exaurirem brevemente.</p>
+	<p style="hp">O transporte se conecta ao topo esquerdo da mina de min?rio.</p>
+	
+	<p style="hp">Esta ? uma mina de min?rio</p>
+	<img src="images/tiles/oremine1.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/mining/oremine.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="ore">Min?rio</a></li>
+	<li><a href="goods">Bens</a></li>
+	<li><a href="steel">A?o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/other-costs.xml
===================================================================
--- trunk/data/help/pt_BR/other-costs.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/other-costs.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,16 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Outros custos</p>
+	<p style="hp">Esta ? a janela de outros custos.</p>
+	<p style="hp">Ela mostra o detalhamento dos 'outros custos' que aparecem na janela de finan?as.</p>
+	<p style="hp">Custos de Vantagens</p>
+	<p style="hp">Custos com escolas</p>
+	<p style="hp">Custos de mortes n?o naturais</p>
+	<p style="hp">Custos com os moinhos de vento</p>
+	<p style="hp">Custos com sa?de</p>
+	<p style="hp">Custos com os foguetes</p>
+	<p style="hp">Custos com bombeiros</p>
+	<p style="hp">Custos com esportes</p>
+	<p style="hp">Custos com reciclagem</p>
+	<p style="hp">Clique esquerdo nesta janela ir? alternar atrav?s das janelas de finan?as, outros custos e habita??o.</p>
+</Document>

Added: trunk/data/help/pt_BR/park.xml
===================================================================
--- trunk/data/help/pt_BR/park.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/park.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,21 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Parque</p>
+	<p style="hp">Parques s?o muito simples: eles limpam a polui??o.</p>
+	<p style="hp">Algumas ?reas produzem polui??o. Elas s?o as estradas, estradas de ferro, minas de carv?o e ind?strias leves e pesadas. Algumas produzem mais que outras.</p>
+	<p style="hp">Voc? pode utilizar os parques para protejer as ?reas residenciais ou para fazer com que a polui??o n?o escape das ?reas de origem.</p>
+	<p style="hp">O vento vem <b>do</b> sudoeste, logo construa seus parques de acordo.</p>
+	
+	<p style="hp">Este ? um parque</p>
+	<img src="images/tiles/parkland-plane.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/parks/tree.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="pollution">Polui??o</a></li>
+	<li><a href="road">Estrada</a></li>
+	<li><a href="rail">Estrada de ferro</a></li>
+	<li><a href="coalmine">Mina de carv?o</a></li>
+	<li><a href="industryh">Ind?stria pesada</a></li>
+	<li><a href="industryl">Ind?stria leve</a></li>
+</Document>

Added: trunk/data/help/pt_BR/pause.xml
===================================================================
--- trunk/data/help/pt_BR/pause.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/pause.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,6 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Bot?o pausar</p>
+	<p style="hp">Este ? o bot?o de pausa. Ele pausa o jogo.</p>
+	<p style="hp">Voc? pode voltar ao jogo apenas clicando nele novamente.</p>
+</Document>

Added: trunk/data/help/pt_BR/pbar.xml
===================================================================
--- trunk/data/help/pt_BR/pbar.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/pbar.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,8 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">PBar</p>
+	<p style="hp">Esta ? a segunda aba da mini-janela</p>
+	<p style="hp">Ela mostra o estoque total de todos os mercados, e como eles est?o mudando.</p>
+	<p style="hp">O n?mero indica a quantidade total.</p>
+	<p style="hp">A barra verde no lado direito indica um aumento. A barra vermelha no lado esquerdo indica uma redu??o. O tamanho da barra indica o montante da altera??o.</p>
+</Document>

Added: trunk/data/help/pt_BR/pollution.xml
===================================================================
--- trunk/data/help/pt_BR/pollution.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/pollution.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,25 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Polui??o</p>
+	<p style="hp">Muitas ?reas geram alguma polui??o. As ?reas a seguir s?o as que causam mais polui??o:</p>
+	<li>Ind?stria pesada.</li>
+	<li>Ind?stria leve.</li>
+	<li>Usinas el?tricas carvoeiras.</li>
+	<li>Minas de carv?o.</li>
+	<li>Mercados que est?o cheio de res?duos.</li>
+	<li>Estradas/Trilhos, particularmente quando cheio de res?duos.</li>
+	<p style="hp">As pessoas n?o gostam de viver em ?reas poluidas. Elas ir?o embora, ou at? ficar?o doentes e morrer?o.</p>
+	<p style="hp">O vento que prevalece ? o vindo do Sudoeste. Ent?o a polui??o tende a ir para a dire??o Nordeste.</p>
+	<p style="hp">Voc? pode construir estrat?gicamente para que as pessoas n?o fiquem expostas a polui??o. Mas isso nem sempre ? poss?vel. Neste caso ent?o os parques podem formar uma boa barreira. Quanto mais parques, mais forte ser? a prote??o.</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="industryh">Ind?stria pesada</a></li>
+	<li><a href="industryl">Ind?stria leve</a></li>
+	<li><a href="powerscoal">Usina el?trica carvoeira</a></li>
+	<li><a href="coalmine">Mina de carv?o</a></li>
+	<li><a href="market">Mercado</a></li>
+	<li><a href="rail">Estrada de ferro</a></li>
+	<li><a href="road">Estrada</a></li>
+	<li><a href="park">Parque</a></li>
+	<li><a href="msb-pol">?rea de cobertura da polui??o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/port.xml
===================================================================
--- trunk/data/help/pt_BR/port.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/port.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,26 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Porto</p>
+	<p style="hp">Os portos permitem voc? a importar e exportar bens, a?o, min?rio, carv?o e alimento. As importa??es custam dinheiro e as exporta??es d?o dinheiro para voc?.</p>
+	<p style="hp">Para ser utilizado o porto deve estar conectado ao transporte. Voc? pode escolher o que importar clicando duplamente no porto. Isso abre um menu com caixas para voc? selecionar o que importar e exportar.</p>
+	<p style="hp">Eles <b>devem</b> estar conectados a todos os rios pelo lado direito.</p>
+	<p style="hp">Nada ser? importado ou exportado at? que voc? tenha selecionado a caixa apropriada.
+	</p>
+	<p style="hp">A ?rea de exporta??o exportar? tanto quanto for necess?rio. Se voc? precisa exportar, mas quer restringir a quantidade, voc? pode querer utilizar um tipo de transporte com menor capacidade, utilize um bom peda?o ou passe o produto atrav?s de um mercado. Voc? precisara experimentar para ter a melhor configura??o de transporte.</p>
+	<p style="hp">Nota: Exportadores descontam grandes exporta??es.</p>
+
+	<p style="hp">Este ? um porto</p>
+	<img src="images/tiles/ex_port.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/transport/port.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+    <li><a href="export">Importa??o e exporta??o</a></li>
+	<li><a href="rivers">Rios/?gua</a></li>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="market">Mercado</a></li>
+	<li><a href="coal">Carv?o</a></li>
+	<li><a href="ore">Min?rio</a></li>
+	<li><a href="goods">Bens</a></li>
+	<li><a href="steel">A?o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/pottery.xml
===================================================================
--- trunk/data/help/pt_BR/pottery.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/pottery.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,18 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Olaria</p>
+	<p style="hp">As olarias utilizam min?rio, carv?o e produ??o para produzir bens. Elas n?o precisam estar conectadas ao transporte mas devem, certamente, estar pr?ximas de um mercado com min?rio, carv?o e produ??o a estar h?bil de receber bens.</p>
+	<p style="hp">Voc? pode descobrir se as olarias est?o em funcionamento pelas fornalhas produzindo fuma?a. Se o forno n?o estiver fazendo fuma?a, ent?o voc? estar? produzindo menos de 100% de sa?da poss?vel.</p>
+	
+	<p style="hp">Esta ? uma olaria</p>
+	<img src="images/tiles/pottery0.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/industry/pottery.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="ore">Min?rio</a></li>
+	<li><a href="coal">Carv?o</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+	<li><a href="market">Mercado</a></li>
+</Document>

Added: trunk/data/help/pt_BR/powerline.xml
===================================================================
--- trunk/data/help/pt_BR/powerline.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/powerline.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,19 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Linha de transmiss?o</p>
+	<p style="hp">As linhas de transmiss?o transmitem a energia das usinas solares e carvoeiras para as sub-esta??es. As linhas de transmiss?o se conectam ao topo esquerdo do canto de cada um dos tr?s tipos de ?cones, usinas solares e carvoeiras e as sub-esta??es.</p>
+	<p style="hp">As linhas de transmiss?o cruzam <b>sob</b> pistas, estradas, estradas de ferro e rios (todos na largura de 1). Se a linha de transmiss?o estiver ou do lado de um transporte ou de um rio, elas atuar?o como se estivessem unidas. Algumas vezes voc? dever? demolir um peda?o do rio para cruz?-lo - isto ? muito caro! As linhas de transmiss?o s?o unidas quando elas est?o em linha reta.</p>
+
+	<p style="hp">Esta ? uma linha de transmiss?o</p>
+	<img src="images/tiles/powerlvd.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/power/powerlines.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone de cobertura no mapa</p>
+	<img src="images/gui/mapview/roundbuttons/round_electrics.png" halign="center"/>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="substation">Sub-esta??o</a></li>
+	<li><a href="powerssolar">Usina el?trica solar</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+</Document>
+

Added: trunk/data/help/pt_BR/powerscoal.xml
===================================================================
--- trunk/data/help/pt_BR/powerscoal.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/powerscoal.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,18 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Usina el?trica carvoeira</p>
+	<p style="hp">Usinas de energia carvoeira produzem eletricidade que s?o colocadas nas linhas de transmiss?o conectadas.</p>
+	<p style="hp">As linhas de transmiss?o se conectam ao topo esquerdo da usina, o transporte se conecta logo a pr?xima posi??o. Veja o exemplo.</p>
+	<p style="hp">A efici?ncia da transforma??o de carv?o em eletricidade aumenta conforme o n?vel tecnol?gico - de quando a usina for <b>construida</b>. Voc? pode querer demolir uma usina antiga e trocar por uma mais nova, e mais eficiente, quando seu n?vel tecnol?gico tiver aumentado significantemente.</p>
+	
+	<p style="hp">Esta ? uma usina de energia carvoeira</p>
+	<img src="images/tiles/powerscoal-empty.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/power/coalpower.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="tech-level">N?vel tecnol?gico</a></li>
+	<li><a href="powerline">Linha de transmiss?o</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+</Document>

Added: trunk/data/help/pt_BR/powerssolar.xml
===================================================================
--- trunk/data/help/pt_BR/powerssolar.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/powerssolar.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,17 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Usina el?trica solar</p>
+	<p style="hp">Usinas el?tricas solares distribuem sua energia em pacotes nas linhas de transmiss?o. O montante de energia que elas produzem aumenta conforme o n?vel de tecnologia que elas tinham quando foram <b>constru?das</b>.</p>
+	
+	<p style="hp">Esta ? uma usina el?trica solar</p>
+	<img src="images/tiles/powerssolar.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/power/solarpower.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="substation">Sub-esta??o</a></li>
+	<li><a href="powerline">Linha de transmiss?o</a></li>
+	<li><a href="residential">?rea residencial</a></li>
+	<li><a href="tech-level">N?vel tecnol?gico</a></li>
+	<li><a href="msb-power">?rea de cobertura el?trica</a></li>
+</Document>

Added: trunk/data/help/pt_BR/query.xml
===================================================================
--- trunk/data/help/pt_BR/query.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/query.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,11 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Pesquisa</p>
+	<p style="hp">Para exibir informa??es sobre uma contru??o utilize esta ferramenta e clique na Constru??o em quest?o.</p>
+	<p style="hp">A informa??o ? mostrada embaixo no canto direito, ao inv?s de no mini-mapa.</p>
+	<p style="hp">N?o existe custo para utilizar esta ferramenta.</p>
+	<img src="images/gui/buttonpanel/base/pointer.png" halign="center"/>
+	<p style="hsubtitle">Veja tamb?m:</p>
+    <li><a href="keys">Comandos de teclado</a></li>
+	<li><a href="help">?ndice</a></li>
+</Document>

Added: trunk/data/help/pt_BR/rail.xml
===================================================================
--- trunk/data/help/pt_BR/rail.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/rail.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,15 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Estrada de ferro</p>
+	<p style="hp">Estradas de ferro transportam mais que as estradas. Elas produzem um pouco menos de polui??o que as estradas. Elas s?o muito caras para comprar e a manuten??o tamb?m. Elas valem o pre?o quando voc? tem muitas coisas para transportar e a longa dist?ncia.</p>
+
+	<p style="hp">Esta ? uma estrada de ferro</p>
+	<img src="images/tiles/railud.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/transport/rails2.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="commune">Comuna</a></li>
+	<li><a href="pollution">Polui??o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/recycle.xml
===================================================================
--- trunk/data/help/pt_BR/recycle.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/recycle.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,18 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Centro de reciclagem</p>
+	<p style="hp">Bens utilizados produzem res?duos.</p>
+	<p style="hp">Os centros de reciclagem transformam os bens usados em min?rio. Eles devem estar conectados ao transporte no topo esquerdo. Produ??o e dinheiro s?o utilizados para coletar os res?duos e converter eles em min?rio novo.</p>
+	<p style="hp">? poss?vel ter uma economia sustent?vel, (ex. n?o ? mais necess?rio extrair min?rios, etc) com menos de 100% de efici?ncia dos centros de reciclagem se voc? tiver alguns moinhos para completar com o 'resto' de res?duos.</p>
+	
+	
+	<p style="hp">Este ? um centro de reciclagem</p>
+	<img src="images/tiles/recycle-centre.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/mining/recycling.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="goods">Bens</a></li>
+	<li><a href="ore">Min?rio</a></li>
+	<li><a href="transport">Transporte</a></li>
+</Document>

Added: trunk/data/help/pt_BR/residential.xml
===================================================================
--- trunk/data/help/pt_BR/residential.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/residential.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,22 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">?rea residencial</p>
+	<p style="hp">Isto ? onde as pessoas vivem. Para encorajar as pessoas a viverem nestas ?reas elas devem poder se alimentar. Isso tamb?m ajuda a prov?-los com trabalho e bens para comprar. Eles devem estar pr?ximos de um mercado ou conectados ao transporte. Existem 3 tipos de ?reas residenciais: moradias de Baixa, M?dia e Alta densidade. E estas tem diferentes taxas de natalidade e mortalidade associadas. Isto da a voc? algum controle sobre sua popula??o.</p>
+	<p style="hp">Mais tarde no jogo, se voc? tiver tecnologia suficiente, voc? poder? construir moradias mais 'modernas', at? mesmo blocos de pr?dios.</p>
+
+	<p style="hp">Esta ? uma moradia de baixa densidade (alta tecnologia)</p>
+	<img src="images/tiles/reslowhi.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/residence/residence-hightec-lo.png" halign="center"/>
+	<p style="hp">Esta ? uma moradia de m?dia densidade (alta tecnologia)</p>
+	<img src="images/tiles/resmedhi.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/residence/residence-hightec-med.png" halign="center"/>
+	<p style="hp">Esta ? uma moradia de alta densidade (alta tecnologia)</p>
+	<img src="images/tiles/reshihi.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/residence/residence-hightec-high.png" halign="center"/>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="market">Mercado</a></li>
+</Document>

Added: trunk/data/help/pt_BR/river.xml
===================================================================
--- trunk/data/help/pt_BR/river.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/river.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,9 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Rios/?gua</p>
+	<p style="hp">Os rios est?o aqui para geralmente ficarem no seu caminho. Eles s?o caros para serem aterrados, demolidos ou contruir pontes sob eles. O ?nico uso ? que os portos devem estar conectados aos rios.</p>
+	<p style="hp">Existem dois tipos de meios aqu?ticos. Lagos s?o os que <b>n?o</b> est?o conectados ao sistema h?drico; rios s?o os que <b>est?o</b> conectados ao sistema h?drico. O rio ? definido como toda a ?gua que esta presente no in?cio do jogo. Por exemplo, quando uma mina de min?rio esgota seu suprimento e se torna ?gua, ela se torna uma parte do rio se estiver conectada ao rio. Do contr?rio ela se torna um lago.</p>
+	<p style="hp">Se voc? demolir algum rio para criar um caminho, digo, transporte, voc? tera criado uma ponte. Ambos os lados desta ponte ainda ser?o parte do sistema h?drico. Esta ? uma das raz?es do porque ? t?o caro 'demoli-los'.</p>
+	<p style="hp">Uma vez que esta parte de ?gua for parte do sistema h?drico ela <b>n?o poder?</b> ser revertida para um lago. A ?gua que ? parte de um rio ? indicada como <b>naveg?vel</b> pela <a href="query">ferramenta de pesquisa</a>.</p>
+	<p style="hp">As linhas de transmiss?o podem transportar a energia sob <b>uma</b> parte do rio da mesma forma que podem passar sob o transporte.</p>
+</Document>

Added: trunk/data/help/pt_BR/road.xml
===================================================================
--- trunk/data/help/pt_BR/road.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/road.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,15 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Estrada</p>
+	<p style="hp">Estradas transportam mais que as pistas, mas n?o tanto quanto as estradas de ferro. Elas produzem mais polui??o que as estradas de ferro tamb?m. Elas s?o mais baratas para construir e manter do que as estradas de ferro - existem motivos para isso!</p>
+	
+	<p style="hp">Esta ? uma estrada</p>
+	<img src="images/tiles/roadud.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/transport/road.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="commune">Comuna</a></li>
+	<li><a href="pollution">Polui??o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/rocket.xml
===================================================================
--- trunk/data/help/pt_BR/rocket.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/rocket.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,22 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Base de lan?amento</p>
+	<p style="hp">Os foguetes permitem voc? a enviar sua popula??o para outro planeta, e com isso finalizar o jogo.</p>
+	<p style="hp">Voc? deve ter cinco lan?amentos n?o tripulados e bem sucedidos antes de iniciar a evacua??o. Cada foguete evacuado com sucesso leva 1000 pessoas.</p>
+	<p style="hp">Se algum lan?amento falhar, voc? dever? lan?ar mais 5 foguetes n?o tripulados antes de poder evacuar mais pessoas.</p>
+	<p style="hp">O n?vel tecnol?gico na ?poca do lan?amento ? a probabilidade de um lan?amento bem sucedido. Isso quer dizer que se seu n?vel tecnol?gico for, digamos, 80%, ent?o voc? ter? somente quatro chances em cinco de sucesso. 100% ou mais significa que o lan?amento sempre ser? bem sucedido. (Alguns dos <i>5 primeiros</i> podem ainda falhar.) Voc? deve construir uma nova base de lan?amento para cada foguete que voc? construir.</p>
+	<p style="hp">As bases de lan?amento n?o precisam estar conectadas ao transporte, elas podem pegar o que precisam dos mercados locais. Elas utilizam grandes quantidades de a?o, bens, produ??o e dinheiro para a constru??o. Quando o foguete for constru?do voc? receber? uma mensagem perguntando se voc? quer lan?ar o foguete na hora ou depois. Se voc? escolher lan?ar depois, ent?o voc? poder? lan??-lo quando quiser clicando na ?rea. Voc? pode ter quantos foguetes quiser esperando para o lan?amento.</p>
+	<p style="hp">Quando um foguete for constru?do, mas esperando ser lan?ado, ele n?o mais utilizar? a?o, bens ou produ??o, mas continuar? ainda custando muito dinheiro.</p>
+	
+	<p style="hp">Esta ? uma base de lan?amento</p>
+	<img src="images/tiles/rocket5.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/transport/rocket.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="market">Mercado</a></li>
+	<li><a href="ore">Min?rio</a></li>
+	<li><a href="commune">Comuna</a></li>
+	<li><a href="steel">A?o</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/school.xml
===================================================================
--- trunk/data/help/pt_BR/school.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/school.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,20 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Escola</p>
+	<p style="hp">As escolas utilizam produ??o e bens para produzir tecnologia de forma parecida com as universidades. Elas utlizam um pouco menos de produ??o e bens que as universidades, mas produzem menos pontos de tecnologia. Entre as escolhas de ou colocar quatro ou cinco escolas em uma ?rea, ou uma simples universidade, as vezes (mas n?o sempre) ? melhor colocar uma universidade.</p>
+	<p style="hp">As escolas <b>n?o</b> precisam estar conectadas ao transporte, mas precisam estar pr?ximas de um mercado que possa supri-las com produ??o e bens para seu funcionamento.</p>
+	<p style="hp">As escolas custam dinheiro para funcionarem. Voc? pode ver o custo total do <b>?ltimo</b> ano clicando no bot?o do dinheiro. O valor 'scl' ? o custo de escola.</p>
+	<p style="hp">Voc? pode ver uma escola em funcionamento da forma usual, clicando nela, e algumas vezes a anima??o estar? em movimento.</p>
+	
+	<p style="hp">Esta ? uma escola</p>
+	<img src="images/tiles/school0.png" halign="center"/>
+	<p style="hp">e este seu ?cone</p>
+	<img src="images/gui/buttonpanel/misc/book.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="market">Mercado</a></li>
+	<li><a href="university">Universidade</a></li>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="goods">Bens</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+</Document>

Added: trunk/data/help/pt_BR/slow.xml
===================================================================
--- trunk/data/help/pt_BR/slow.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/slow.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,10 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Acelera??o lenta</p>
+	<img src="images/gui/speed/normal.png"/>
+	<p style="hp">Este ? o bot?o de acelera??o lenta. Ele faz com que o jogo rode no modo lento. Em computadores lentos os bot?es de acelera??o podem n?o ter efeito.</p>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="medium">Acelera??o m?dia</a></li>
+	<li><a href="fast">Acelera??o r?pida</a></li>
+</Document>

Added: trunk/data/help/pt_BR/steel.xml
===================================================================
--- trunk/data/help/pt_BR/steel.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/steel.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,17 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">A?o</p>
+	<p style="hp">A?o ? geralmente produzido pelas ind?strias pesadas (sider?rgicas). Voc? deve ter alcan?ado um n?vel tecnol?gico suficiente para construir as sider?rgicas. Antes disso, as comunas n?o sua ?nica forma de obter a?o. As comunas produzem um pouco de a?o (a partir do min?rio), ent?o voc? vai precisar de um n?mero de comunas suficiente para produzir o a?o de que voc? necessita.</p>
+	<p style="hp">O a?o ? utilizado pelos ferreiros para produzirem bens. O a?o ? utilizado pelas ind?strias leves para a produ??o de ferramentas e produtos (bens). A ind?stria pequena trabalha sem a?o, mas sua produ??o ? muito reduzida.</p>
+	<p style="hp">Os foguetes utilizam muito a?o, principalmente para construir a base de lan?amento.</p>
+	<p style="hp">As estradas de ferro tamb?m utilizam a?o para a manuten??o.</p>
+	<p style="hp">A produ??o de a?o ? taxada com impostos.</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="commune">Comuna</a></li>
+	<li><a href="blacksmith">Ferreiro</a></li>
+	<li><a href="goods">Bens</a></li>
+	<li><a href="industryh">Ind?stria pesada</a></li>
+	<li><a href="industryl">Ind?stria leve</a></li>
+	<li><a href="rail">Estrada de ferro</a></li>
+</Document>

Added: trunk/data/help/pt_BR/substation.xml
===================================================================
--- trunk/data/help/pt_BR/substation.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/substation.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,18 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Sub-esta??o</p>
+	<p style="hp">Sub-esta??es recebem pacotes de energia das linhas de distribui??o e distribuidores de energia das redondezas. Voc? pode ver se, por exemplo, sua ?rea residencial energizada clicando no ?cone, e ent?o olhar a janela de estat?sticas no ponto do mapa.</p>
+	
+	<p style="hp">Esta ? uma sub-esta??o</p>
+	<img src="images/tiles/substation-G.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/power/substation.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="powerline">Linha de transmiss?o</a></li>
+	<li><a href="powerssolar">Usina el?trica solar</a></li>
+	<li><a href="commune">Comuna</a></li>
+	<li><a href="steel">A?o</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+</Document>
+

Added: trunk/data/help/pt_BR/sustain.xml
===================================================================
--- trunk/data/help/pt_BR/sustain.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/sustain.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,33 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Janela de progresso da sustentabilidade</p>
+	<p style="hp">Esta janela cont?m seis linhas coloridas. Quando elas todas alcan?am o lado direito da janela, voc? tem uma economia sustent?vel.</p>
+	<li>
+		<span color="orange">MIN</span> (laranja) voc? n?o esta escavando minas de min?rio ou carv?o, e 
+		n?o est? despejando detritos nos dep?sitos de lixo.
+	</li>
+	<li>
+		<span color="gray">PRT</span>	(cinza) voc? n?o esta importando ou exportando.
+	</li>
+	<li>
+		<span color="green">MNY</span> (verde) seu dinheiro esta est?vel ou aumentando, 
+		isso significa que voc? n?o pode construir qualquer coisa exceto o mais barato das ?reas.
+	</li>
+	<li>
+		<span color="blue">POP</span> (azul) sua popula??o esta est?vel dentro dos
+		2% de quando a contagem dos 180 anos come?ou. Se estiver fora
+		desta faixa, a nova popula??o ser? o novo valor e a contagem ser?
+		zerada. Al?m disso, sua popula??o deve ser de ao menos 5000.		
+	</li>
+	<li>
+		<span color="yellow">TEC</span> (amarelo) sua tecnologia esta aumentando ou 
+		diminuindo por um pouco. Se ela cair mais que 1%, o ano ? alterado para zero.
+		Do contr?rio, seu n?vel tecnol?gico deve ser ao menos 50%.
+	</li>
+	<li>
+		<span color="red">FIR</span> (vermelho) todas as ?reas incendi?veis tem
+		cobertura contra fogo. As seguintes ?reas *n?o* precisam ter cobertura:
+		monumentos, minas de min?rios, linhas de transmiss?o e foguetes.
+	</li>
+	<p style="hp">Anos requerido para a sustentabilidade: MIN=180 PRT=180 MNY=60 POP=60 TEC=120 FIR=60</p>
+</Document>

Added: trunk/data/help/pt_BR/tech-level.xml
===================================================================
--- trunk/data/help/pt_BR/tech-level.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/tech-level.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,17 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">N?vel tecnol?gico</p>
+	<p style="hp">O n?vel tecnol?gico de sua cidade determina um n?mero de coisas, como o que voc? pode construir e a efici?ncia de certos processos.</p>
+	<p style="hp">Para aumentar sua tecnologia, voc? deve construir (e suprir com os recursos apropriados) Monumentos, Escolas e Universidades.</p>
+	<p style="hp">Enquanto seu n?vel tecnol?gico estiver muito baixo voc? poder? construir apenas monumentos. E quando alguns destes estiverem por toda a parte, voc? ir? ent?o <i>inventar</i> a escola. As escolas produzem mais tecnologia que os monumentos.</p>
+	<p style="hp">Quando seu n?vel tecnol?gico alcan?ar um valor mais alto, voc? ir? <i>inventar</i> a universidade. Estas produzem muito mais tecnologia que as escolas, mas precisam de <b>muitos</b> recursos.</p>
+	<p style="hp">Quanto mais tecnologia voc? tiver, mais r?pido ser? o <i>desgaste</i>. Isso significa que quanto mais n?vel tecnol?gico voc? precisar, mais escolas e universidades voc? precisar? tamb?m.</p>
+	<p style="hp">Logo, cuidado caso voc? por alguma raz?o precise se livrar de tecnologia, digo, uma ou duas universidades (ou se elas tiverem com falta de recursos) e seu n?vel tecnol?gico vagarosamente come?ar? a <b>diminuir</b>.</p>
+	<p style="hp">A percentagem de chance de um lan?amento bem sucedido ? igual ao seu n?vel tecnol?gico.</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="monument">Monumento</a></li>
+	<li><a href="school">Escola</a></li>
+	<li><a href="university">Universidade</a></li>
+	<li><a href="rocket">Base de lan?amento</a></li>
+</Document>

Added: trunk/data/help/pt_BR/tip.xml
===================================================================
--- trunk/data/help/pt_BR/tip.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/tip.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,16 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Aterro (dep?sitos de lixo)</p>
+	<p style="hp">Os aterros disponibilizam um lugar para voc? colocar seu lixo. Se voc? acumular muito nos mercados, eles ser?o obrigados a queimar uma parte. Isso gera bastante polui??o ent?o voc? deve tomar cuidado com o acumulo de lixo.</p>
+	<p style="hp">Quando o aterro estiver cheio, ele vagarosamente se transformar? em uma colina, que ficar? coberta de grama quando estiver completa.</p>
+	<p style="hp">O transporte se conecta ao topo esquerdo do aterro como ? usualmente.</p>
+	<p style="hp">Voc? pode ver quando um aterro est? em funcionamento da forma usual, clicando nele, e algumas vezes vendo a anima??o em movimento.</p>
+	
+	<p style="hp">Este ? um aterro</p>
+	<img src="images/tiles/tip0.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/mining/recycling.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="market">Mercado</a></li>
+</Document>

Added: trunk/data/help/pt_BR/track.xml
===================================================================
--- trunk/data/help/pt_BR/track.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/track.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,14 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Pista</p>
+	<p style="hp">As pistas s?o os mais simples e baratos meios de transporte. Elas tamb?m tem menor capacidade. E tamb?m, elas n?o produzem polui??o.</p>
+	
+	<p style="hp">Esta ? uma pista</p>
+	<img src="images/tiles/trackud.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/transport/tracks.png" halign="center"/>
+	
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="commune">Comuna</a></li>
+</Document>

Added: trunk/data/help/pt_BR/transport.xml
===================================================================
--- trunk/data/help/pt_BR/transport.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/transport.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,31 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Transporte</p>
+	<p style="hp">Existem tr?s tipos de transporte no Lincity: pistas, estradas e estradas de ferro.</p>
+	<p style="hp">Existe uma quarta que consiste de 'pular sobre um campo' para alcan?ar um mercado. Esta ? uma forma muito curta de com?rcio e n?o ser? referida como transporte novamente. Contudo, ela muito importante, ent?o voc? poder? ler novamente em <a href="market"> mercados</a>.</p>
+
+	<p style="hp">Pistas, estradas e trilhos s?o utilizados para transportar, alimento, produ??o, bens, carv?o, min?rio, a?o e res?duos entre as ?reas. Transporte entre mercados, transporte para constru??es n?o pr?ximas de um mercado (isto geralmente ? uma m? id?ia) e transporte para constru??es que precisam:</p>
+	<li>Comunas apenas precisam estar adjacentes ao transporte</li>
+	<li>Ind?strias leves, minas de min?rio, aterros, portos, minas de carv?o, ind?strias pesadas e centros de reciclagem<b> precisam estar </b>conectadas ao transporte no topo esquerdo. Voc? ver? o "n?" do transporte, que mostra a conex?o.</li>
+	<li>Uma exce??o ? a usina el?trica carvoeira: o topo esquerdo ? usado para conex?o na linha de transmiss?o, ent?o o transporte se conecta perto.</li>
+	<p style="hp">Por exemplo, uma ind?stria pesada pode se conectar pela estrada na mina de carv?o, e pelos trilhos nos outros recursos como as minas de min?rio e mercados.</p>
+	<p style="hp">Para cruzar um rio com o transporte, simplesmente soterre o rio e construa uma estrada, pista ou trilho na ?rea. Veja isso como a constru??o de uma ponte. Isto custa muito porque aterrar ?gua ? muito caro.</p>
+	<p style="hp">Estradas e Trilhos geram custos anuais (para manuten??o) e polui??o (e mais polui??o se eles transportarem muitos res?duos).</p>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="track">Pista</a></li>
+	<li><a href="road">Estrada</a></li>
+	<li><a href="rail">Estrada de ferro</a></li>
+	<li><a href="commune">Comuna</a></li>
+	<li><a href="coalmine">Mina de carv?o</a></li>
+	<li><a href="powercoal">Usina el?trica carvoeira</a></li>
+	<li><a href="tip">Aterro (dep?sitos de lixo)</a></li>
+	<li><a href="recycle">Centro de reciclagem</a></li>
+	<li><a href="oremine">Mina de min?rio</a></li>
+	<li><a href="industryl">Ind?stria leve</a></li>
+	<li><a href="industryh">Ind?stria pesada</a></li>
+	<li><a href="port">Porto</a></li>
+	<li><a href="finance">Finan?as</a></li>
+	<li><a href="msb-transport">?reas de cobertura do mercado e transporte</a></li>
+
+</Document>

Added: trunk/data/help/pt_BR/tutorial-advanced.xml
===================================================================
--- trunk/data/help/pt_BR/tutorial-advanced.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/tutorial-advanced.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,18 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<Document style="helpdocument">
+<p style="htitle">Op??es avan?adas </p>
+<p style="hsubtitle">Mercados e Transportes </p>
+<p style="hp">Um duplo clique em um mercado na tela principal abre uma janela. Isto ? para controlar o <b> com?rcio entre os mercados e os transportes</b>. </p>
+<li>compra ? o que o mercado compra do transporte (ent?o o estoque de mercado ir? aumentar). </li>
+<li>venda ? o oposto. </li>
+
+<p style="hp">Esta op??o ? raramente utilizada, exceto quando voc? quiser prevenir alguma coisa de acontecer. </p>
+
+<p style="hsubtitle">Desenvolvimento sustent?vel</p>
+<p style="hp">A quarta aba da mini-janela mostra as barras de progresso do desenvolvimento sustent?vel. </p>
+<p style="hp">? fortemente recomendado salvar o jogo antes de voc? deix?-lo rodando por um longo tempo e ver se voc? alcan?ou um estado sustent?vel. Se alguma coisa acontecer de muito errado (fome por exemplo) voc? poder? reiniciar a partir do jogo salvo :-) </p>
+<p style="hp">Olhar para o estoque total dos mercados (a mini-janela com a barra de progresso) poder? prevenir grandes problemas. De tempos em tempos olhar a progress?o de sustentabilidade na mini-janela ECO poder? ser suficiente. </p>
+
+<li>Dica: Cuidado com as favelas e o desperd?cio nos mercados... </li>
+<p style="hp"></p>
+</Document>

Added: trunk/data/help/pt_BR/tutorial-aim.xml
===================================================================
--- trunk/data/help/pt_BR/tutorial-aim.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/tutorial-aim.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<Document style="helpdocument">
+<p style="htitle">Objetivo do jogo </p>
+<p style="hp">Existem 2 formas de "ganhar" o jogo:</p>
+<li>Alcan?ar a <a href="sustain">economia sustent?vel </a> (voc? pode ainda continuar jogando depois) </li>
+<li>Evacuar toda a popula??o com <a href="rocket">foguetes </a> para outro planeta, ent?o o jogo acaba. </li>
+<p style="hp"></p>
+
+<p style="hp">Atualmente (1.1.0) existe apenas uma forma de perder:</p>
+<li>Todo mundo morrer por fome ou polui??o. (voc? sabe que ? necess?rio ao menos 2 pessoas para criar uma popula??o ;-) </li>
+<p style="hp"></p>
+
+<p style="hp">Voc? vai precisar aumentar seu n?vel tecnol?gico para ter novas poss?veis constru??es e ind?strias. Voc? precisa gerenciar o crescimento da popula??o, tomar conta de v?rias coisas e da balan?a econ?mica. </p>
+<p style="hp"></p>
+
+<p style="hp">Veja tamb?m:</p>
+<li><a href="tutorial-basics">Primeiros passos</a></li>
+<li><a href="tutorial-advanced">Op??es avan?adas</a></li>
+<li><a href="tutorial-scenario">Cen?rio pr?-definido</a></li>
+
+</Document>
+

Added: trunk/data/help/pt_BR/tutorial-basics.xml
===================================================================
--- trunk/data/help/pt_BR/tutorial-basics.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/tutorial-basics.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,46 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<Document style="helpdocument">
+<p style="htitle">Primeiros passos </p>
+<p style="hp">Escolha "novo jogo " &gt; "cidade aleat?ria". Outros cen?rios s?o para jogadores mais ou menos experientes. </p>
+<p style="hp">Note que a cidade aleat?ria tem recursos b?sicos: </p>
+<li>Fazendas para abastecer os mercados com bens </li>
+<li>Comunas que produzem carv?o vegetal e uma pequena quantidade de min?rio e a?o </li>
+<li>?reas residenciais</li>
+<li>Olaria</li>
+<li>Pistas</li>
+
+<p style="hp">Clicar numa constru??o (na tela principal) mostra informa??es sobre ela na janela de informa??es embaixo ? direita. </p>
+
+<p style="hsubtitle">Mercado </p>
+<p style="hp">O mercado ? uma chave para a constru??o no Lincity. Eles s?o mandat?rios para todos os com?rcios pr?ximos. Voc? <b> deve </b> ler a ajuda em <a href="market">mercado </a> :-). <i>Certamente que, quando o mercado estiver vazio ele n?o poder? vender o item correspondente, e quando ele estiver cheio n?o poder? comprar mais. Isto pode ajuda-lo a entender porque algumas constru??es n?o funcionam (provavelmente elas n?o encontram o que precisam, ou elas n?o podem vender sua produ??o)</i> </p>
+
+<p style="hsubtitle">Transporte </p>
+<p style="hp">O <a href="transport">transporte </a>? necess?rio para com?rcio de longa dist?ncia, e para algumas atividades espec?ficas (neste caso descritas na ajuda correspondente, por exemplo as comunas). Como mercados eles tem uma capacidade limitada e podem ficar saturados.</p>
+<p style="hp">Se uma constru??o 'normal' n?o estiver na ?rea de um mercado, ent?o ela dever? estar conectada ao transporte. Mas lembre-se que as estradas e trilhos tem um custo anual, ent?o a menos que voc? realmente queira isolar uma constru??o (ex. um monumento) ? geralmente melhor (e mais barato) utilizar os mercados quando necess?rio. </p>
+
+<p style="hp">Na cidade inicial as pistas s?o necess?rias apenas para a produ??o das comunas. Outras atividades necessitam apenas do mercado. </p>
+
+<p style="hsubtitle">Dinheiro </p>
+<p style="hp">As produ??es s?o taxadas e com isso geram dinheiro pra voc?. No mini-mapa, a terceira aba ? a <a href="finance"> janela de Finan?as </a>. Tome o cuidade de n?o investir muito em pouco tempo: quando seu saldo estiver negativo, voc? n?o poder? construir algumas coisas, e voc? tem o custo anual devido aos d?bitos. Isto pode levar ? fal?ncia (veja no <a href="tutorial-scenario"> Cen?rio tempos dif?ceis </a>). </p>
+
+<p style="hsubtitle">Desenvolvendo a cidade </p>
+<p style="hp">Lembre-se as pessoas ou comem ou morrem. Para controlar o crescimento populacional, voc? tem que encontrar um equil?brio no tipo da <a href="residential"> ?rea residencial </a> que voc? construir (elas tem taxas de natalidade/mortalidade diferentes). A nova popula??o permitir? mais produ??o, mas tamb?m precisam de mais alimento, bens, produ??o ... </p>
+<p style="hp">Voc? dever? aumentar sua produ??o (adicionar olarias, ferreiros) e ao mesmo tempo cuidar do que eles necessitam. Ent?o dever? tamb?m adicionar comunas de acordo. </p>
+<p style="hp">Para ter novas constru??es voc? deve aumentar seu <a href="tech-level"> N?vel Tecnol?gico </a>.</p>
+
+<p style="hp">Em algum ponto voc? dever? escolher seu objetivo: a <a href="sustain"> Economia sustent?vel </a> ou a evacua??o com <a href="rocket"> foguetes </a>.</p>
+
+<p style="hp">Voc? dever? checar muito frequentemente o <a href="pbar"> estoque total dos mercados </a>. Tamb?m as mini-telas podem dar uma boa vis?o de sua economia, e para uma investiga??o precisa lembre que clicar numa constru??o (na tela principal) mostra informa??es sobre ela na janela de informa??es embaixo ? direita. </p>
+
+<li>Dica: Fa?a uma ou duas altera??es ent?o espere um pouco (veja a ajuda ;-) ou coloque o jogo na velocidade r?pida, e veja como seu indicadores econ?micos mudam. </li>
+<p style="hp"></p>
+<p style="hp">Divirta-se.</p>
+<p style="hp"></p>
+
+<p style="hp">Veja tamb?m:</p>
+<li><a href="tutorial-advanced">Tutorial op??es avan?adas</a></li>
+<li><a href="tutorial-scenario">Tutorial cen?rio pr?-definido</a></li>
+<li><a href="msb-starve">?rea de cobertura dos famintos</a></li>
+<li><a href="msb-ub40">?rea de cobertura do desemprego</a></li>
+
+</Document>

Added: trunk/data/help/pt_BR/tutorial-overview.xml
===================================================================
--- trunk/data/help/pt_BR/tutorial-overview.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/tutorial-overview.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,24 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<Document style="helpdocument">
+<p style="htitle">Vis?o geral</p>
+
+<p style="hp"><b>Topo esquerdo </b>cont?m ?cones com ferramentas (pesquisa e demoli??o) e todas as constru??es que voc? tem durante o jogo.</p>
+<li>Clique-Esquerdo num ?cone para abrir o desenhista e ver mais coisas.</li>
+<li>Clique-Direito num ?cone para ter a ajuda relativa.</li>
+<li>Esperar com o ponteiro do mouse abrir? um mini popup com mensagem de ajuda.</li>
+<p style="hp"></p>
+
+<p style="hp"><b>Abaixo esquerda </b>? o controle de acelera??o do jogo </p>
+<p style="hp"></p>
+
+<p style="hp"><b>Abaixo direita </b>cont?m todas as "ferramentas informativas": minimapa com 4 abas, e abaixo mini-?cones de v?rias informa??es. Clique neles para ver o que acontece.</p>
+<p style="hp"></p>
+
+<p style="hp">Tente o teclado e mouse (clique esquerdo, meio, direito e a rodinha...) , F1 para Ajuda.</p>
+
+<p style="hsubtitle">Veja tamb?m:</p>
+<li><a href="tutorial-basics">Primeiros passos</a></li>
+<li><a href="tutorial-advanced">Op??es avan?adas</a></li>
+<li><a href="tutorial-scenario">Cen?rio pr?-definido</a></li>
+
+</Document>

Added: trunk/data/help/pt_BR/tutorial-scenario.xml
===================================================================
--- trunk/data/help/pt_BR/tutorial-scenario.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/tutorial-scenario.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,11 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<Document style="helpdocument">
+<p style="htitle">Cen?rio pr?-definido</p>
+<p style="hp">Sob "novo jogo" </p>
+<p style="hsubtitle"> F?cil</p>
+<li>Bons tempos </li>
+<li>Praia (lembre-se que as pessoas comem ou morrem?;-) </li>
+<p style="hsubtitle">Dif?cil </p>
+<li>"Tempos dif?ceis": tente escapar da fal?ncia. Uma cuidadosa an?lise de toda a cidade e dr?sticos cortes de custo s?o necess?rios para ganhar dinheiro. ? d?ficil mas poss?vel, tamb?m ? poss?vel alcan?ar o desenvolvimento sustent?vel.</li>
+<p style="hp"></p>
+</Document>

Added: trunk/data/help/pt_BR/tutorial.xml
===================================================================
--- trunk/data/help/pt_BR/tutorial.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/tutorial.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,11 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<Document style="helpdocument">
+	<p style="htitle">Tutorial</p>
+
+	<li><a href="tutorial-aim">Objetivo do jogo</a></li>
+	<li><a href="tutorial-overview">Vis?o geral</a></li>
+	<li><a href="tutorial-basics">Primeiros passos</a></li>
+	<li><a href="tutorial-advanced">Op??es avan?adas</a></li>
+	<li><a href="tutorial-scenario">Cen?rio pr?-definido</a></li>
+</Document>
+

Added: trunk/data/help/pt_BR/university.xml
===================================================================
--- trunk/data/help/pt_BR/university.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/university.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,23 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Universidade</p>
+	<p style="hp">Universidades ajudam a aumentar o n?vel tecnol?gico. No processo elas consomem bens e produ??o. Elas produzem mais que as escolas por bens/produ??o gasto. Contudo elas consomem bastante bens e produ??o e tamb?m custam muito dinheiro para o funcionamento, ent?o voc? deve ter capacidade econ?mica e industrial para supr?-las.</p>
+	<p style="hp">Voc? vai precisar de um n?mero de universidades para alcan?ar um n?vel de tecnologia perto dos 100%</p>
+	<p style="hp">Universidades n?o precisam estar conectadas ao transporte; elas podem pegar tudo o que necessitam, dos mercados pr?ximos e com produ??o e bens suficiente dispon?veis.</p>
+
+	<p style="hsubtitle">NOTA</p>
+	<p style="hp">Voc? <b>deve</b> ter 5 escolas por universidade para ench?-la com estudantes.</p>
+
+	<p style="hp">Esta ? uma universidade</p>
+	<img src="images/tiles/university.png" halign="center"/>
+	<p style="hp">e este ? seu ?cone</p>
+	<img src="images/gui/buttonpanel/misc/university.png" halign="center"/>
+
+	<p style="hsubtitle">Veja tamb?m:</p>
+	<li><a href="market">Mercado</a></li>
+	<li><a href="transport">Transporte</a></li>
+	<li><a href="goods">Bens</a></li>
+	<li><a href="jobs">Produ??o</a></li>
+	<li><a href="schools">Escola</a></li>
+	<li><a href="tech-level">N?vel tecnol?gico</a></li>
+</Document>

Added: trunk/data/help/pt_BR/windmill.xml
===================================================================
--- trunk/data/help/pt_BR/windmill.xml	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/help/pt_BR/windmill.xml	2007-05-15 16:46:52 UTC (rev 1219)
@@ -0,0 +1,15 @@
+<?xml version="1.0"?>
+<Document style="helpdocument">
+	<p style="htitle">Moinho de vento</p>
+	<p style="hp">Moinhos de vento geram energia para as resid?ncias e fazendas. Elas ajudam as fazendas a processarem o alimento mais eficientemente o que fazem as resid?ncias mais desej?veis.</p>
+	<p style="hp">Prover energia para as resid?ncias faz com que os moradores utilizem mais bens.</p>
+	<p style="hp">Os antigos moinhos <b>n?o</b> geram energia para as ind?strias. (Sider?rgicas podem receber energia de carv?o, ind?strias leves necessitam de eletricidade <i>real</i>, elas ainda funcionam sem energia no caso de falta)</p>
+	<p style="hp">Existem dois tipos de moinhos de vento.</p>
+	<img src="images/gui/buttonpanel/power/windmills.png" halign="center"/>
+	<p style="hp">O primeiro ? o antigo moinho de 'madeira'.</p>
+	<img src="images/tiles/windmill1w.png" halign="center"/>
+	<p style="hp">O segundo ? o 'moderno' tipo fazenda de ventos.</p>
+	<img src="images/tiles/windmill1g.png" halign="center"/>
+	<p style="hp">O tipo que voc? poder? construir vai depender do seu n?vel tecnol?gico.</p>
+	<p style="hp">Moinhos de alta tecnologia podem energizar linhas de transmiss?o.</p>
+</Document>

Modified: trunk/data/locale/gui/pt_BR.po
===================================================================
--- trunk/data/locale/gui/pt_BR.po	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/locale/gui/pt_BR.po	2007-05-15 16:46:52 UTC (rev 1219)
@@ -8,7 +8,7 @@
 "Project-Id-Version: lincity-ng 1.1.0rc2\n"
 "Report-Msgid-Bugs-To: \n"
 "POT-Creation-Date: Sat Jan 27 22:03:14 2007\n"
-"PO-Revision-Date: 2007-01-30 21:10-0300\n"
+"PO-Revision-Date: 2007-05-10 19:53-0300\n"
 "Last-Translator: Jose Carlos Medeiros <jose at psabs.com.br>\n"
 "Language-Team: Portuguese/Brazil <gnome-l10n-br at listas.cipsga.org.br>\n"
 "MIME-Version: 1.0\n"
@@ -51,15 +51,15 @@
 
 #: data/gui/bulldoze_monument_yn.xml
 msgid "Bulldozing a monument costs a lot of money."
-msgstr "Destruir um monumento custa muito dinheiro."
+msgstr "Demolir um monumento custa muito dinheiro."
 
 #: data/gui/bulldoze_river_yn.xml
 msgid "Bulldozing a section of river costs a lot of money."
-msgstr "Destruir uma parte do rio custa muito dinheiro."
+msgstr "Demolir uma parte do rio custa muito dinheiro."
 
 #: data/gui/bulldoze_shanty_yn.xml
 msgid "Bulldozing a shanty town costs a lot of money and may cause a fire."
-msgstr "Destruir uma favela custa muito dinheiro e pode causar um inc?ndio."
+msgstr "Demolir uma favela custa muito dinheiro e pode causar um inc?ndio."
 
 #: data/gui/tradedialog.xml data/gui/portdialog.xml
 msgid "Buy"
@@ -75,7 +75,7 @@
 
 #: data/gui/coalpowerup.xml
 msgid "Coal Fired Power Stations available"
-msgstr "Usina El?trica de Carv?o dispon?vel"
+msgstr "Usina El?trica Carvoeira dispon?vel"
 
 #: data/gui/coalmineup.xml
 msgid "Coal Mine available"
@@ -83,7 +83,7 @@
 
 #: data/gui/coal_survey_yn.xml
 msgid "Coal Survey"
-msgstr "An?lise do carv?o"
+msgstr "An?lise do Carv?o"
 
 #: data/gui/creditslist.xml
 msgid "Code"
@@ -123,7 +123,7 @@
 
 #: data/gui/firestationup.xml
 msgid "Fire Stations available"
-msgstr "Corpo de Bombeiro dispon?vel"
+msgstr "Bombeiros dispon?veis"
 
 #: data/gui/shfire-uc.xml data/gui/shfire-oc.xml
 msgid "Fire!"
@@ -131,11 +131,11 @@
 
 #: data/gui/pbar.xml data/gui/tradedialog.xml data/gui/portdialog.xml
 msgid "Food"
-msgstr "Comida"
+msgstr "Alimento"
 
 #: data/gui/options.xml
 msgid "Fullscreen"
-msgstr "Tela Inteira"
+msgstr "Tela cheia"
 
 #: data/gui/gamestats.xml
 msgid "Gamestats"
@@ -159,11 +159,11 @@
 
 #: data/gui/healthup.xml
 msgid "Health Centres available"
-msgstr "Centro de sa?de dispon?vel"
+msgstr "Hospitais dispon?veis"
 
 #: data/gui/hvindustryup.xml
 msgid "Heavy Industry available"
-msgstr "Ind?stria grande dispon?vel"
+msgstr "Ind?stria pesada dispon?vel"
 
 #: data/gui/import-exportup.xml
 msgid "Import/Export available"
@@ -171,7 +171,7 @@
 
 #: data/gui/pbar.xml data/gui/tradedialog.xml
 msgid "Jobs"
-msgstr "Trabalhos"
+msgstr "Produ??o"
 
 #: data/gui/launch-fail.xml data/gui/launch-fail.xml
 msgid "Launch Failure"
@@ -179,7 +179,7 @@
 
 #: data/gui/launch-good.xml data/gui/launch-good.xml
 msgid "Launch Successfull"
-msgstr "Sucesso no lan?amento"
+msgstr "Sucesso no Lan?amento"
 
 #: data/gui/launch_rocket_yn.xml
 msgid "Launch now?"
@@ -187,7 +187,7 @@
 
 #: data/gui/ltindustryup.xml
 msgid "Light Industry available"
-msgstr "Ind?stria pequena dispon?vel"
+msgstr "Ind?stria leve dispon?vel"
 
 #: data/gui/sustain.xml
 msgid "LinCity has determined that you have a sustainable economy."
@@ -267,7 +267,7 @@
 
 #: data/gui/speedpanel.xml
 msgid "Pause the game"
-msgstr "Pausar o Jogo"
+msgstr "Pausar o jogo"
 
 #: data/gui/pbar.xml
 msgid "Population"
@@ -291,7 +291,7 @@
 
 #: data/gui/railwayup.xml
 msgid "Railways available"
-msgstr "Estrada de Ferro dispon?vel"
+msgstr "Estrada de ferro dispon?vel"
 
 #: data/gui/recycleup.xml
 msgid "Recycling Centres available"
@@ -299,15 +299,15 @@
 
 #: data/gui/riverup.xml
 msgid "Rivers available"
-msgstr "Rio dispon?vel"
+msgstr "Rios dispon?veis"
 
 #: data/gui/roadup.xml
 msgid "Roads available"
-msgstr "Estrada dispon?vel"
+msgstr "Estradas dispon?veis"
 
 #: data/gui/rocketup.xml
 msgid "Rocket Launch Pad available"
-msgstr "?rea de lan?amento de foguetes dispon?vel"
+msgstr "Base de lan?amento dispon?vel"
 
 #: data/gui/launch_rocket_yn.xml
 msgid "Rocket Ready"
@@ -359,7 +359,7 @@
 
 #: data/gui/minimap.xml
 msgid "Show Income and Expenses. Click this tab again to cycle through views."
-msgstr "Exibir Rendimentos e Despesas. Clique nesta tab novamente para circular entre as visualiza??es."
+msgstr "Exibir Receitas e Despesas. Clique nesta tab novamente para circular entre as visualiza??es."
 
 #: data/gui/minimapswitchbuttons.xml
 msgid "Show coal depots"
@@ -459,7 +459,7 @@
 
 #: data/gui/coal_survey_yn.xml
 msgid "This will cost you 1 million once. After that it is free to call again."
-msgstr "Isto custar? 1 milh?o. Ap?s, estar? livre para chamar novamente."
+msgstr "Isto custar? 1 milh?o. Ap?s, estar? livre para usar novamente."
 
 #: data/gui/launch-gone.xml
 msgid "Total Evacuation Complete."
@@ -479,7 +479,7 @@
 
 #: data/gui/bulldoze_monument_yn.xml data/gui/bulldoze_river_yn.xml data/gui/bulldoze_shanty_yn.xml
 msgid "Want to bulldoze?"
-msgstr "Deseja destruir?"
+msgstr "Deseja demolir?"
 
 #: data/gui/bulldoze_monument_yn.xml data/gui/bulldoze_river_yn.xml data/gui/bulldoze_shanty_yn.xml
 msgid "Warning"
@@ -487,15 +487,15 @@
 
 #: data/gui/bulldoze_monument_yn.xml
 msgid "Warning: Bulldozing monuments is expensive"
-msgstr "Aten??o: Destruir monumentos ? muito caro"
+msgstr "Aten??o: Demolir monumentos ? muito caro"
 
 #: data/gui/bulldoze_shanty_yn.xml
 msgid "Warning: Bulldozing shanties is dangerous."
-msgstr "Aten??o: Destruir favelas ? perigoso."
+msgstr "Aten??o: Demolir favelas ? perigoso."
 
 #: data/gui/bulldoze_river_yn.xml
 msgid "Warning: Bulldozing water is expensive"
-msgstr "Aten??o: Destruir ?gua ? muito caro"
+msgstr "Aten??o: Demolir ?gua ? muito caro"
 
 #: data/gui/launch-gone.xml
 msgid "Well done you have evacuated all your people."
@@ -535,7 +535,7 @@
 
 #: data/gui/no-credit-solar-power.xml
 msgid "You have a budget deficit. The legislative council will not allow you to build solar power stations on credit."
-msgstr "Voc? tem um d?ficit no or?amento. O conselho legislativo n?o deixar? que voc? construa esta??es de energia solar ? cr?dito."
+msgstr "Voc? tem um d?ficit no or?amento. O conselho legislativo n?o deixar? que voc? construa usinas el?tricas solares ? cr?dito."
 
 #: data/gui/no-credit-university.xml
 msgid "You have a budget deficit. The legislative council will not allow you to build universities on credit."
@@ -547,83 +547,83 @@
 
 #: data/gui/blacksmithup.xml
 msgid "You have reached the tech level which enables you to build blacksmiths. Blacksmiths use jobs and steel to make goods."
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir ferreiros. Ferreiros utiliza trabalho e a?o para produzir bens."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir ferreiros. Ferreiros utiliza produ??o e a?o para produzir bens."
 
 #: data/gui/coalpowerup.xml
 msgid "You have reached the tech level which enables you to build coal fired power stations."
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir usinas el?tricas de carv?o."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir usinas el?tricas carvoeiras."
 
 #: data/gui/firestationup.xml
 msgid "You have reached the tech level which enables you to build fire stations. Fire stations prevent most fires from starting. If you haven't had any fires yet, you might not think you need them."
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir corpos de bombeiro. Corpo de bombeiro previne a maioria dos inc?ndios antes de come?ar. Se voc? n?o teve um inc?ndio ainda, n?o deve pensar que n?o precisa deles."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir Bombeiros. Bombeiro previne a maioria dos inc?ndios antes de come?ar. Se voc? n?o teve um inc?ndio ainda, n?o deve pensar que n?o precisa deles."
 
 #: data/gui/healthup.xml
 msgid "You have reached the tech level which enables you to build health centres. Heath centres reduce the number of people killed by pollution and increase overall productivity."
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir centros de sa?de. Centros de sa?de reduzem o n?mero de pessoas mortas pela polui??o e aumentam a produtividade."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir hospitais. Hospitais reduzem o n?mero de pessoas mortas pela polui??o e aumentam a produtividade."
 
 #: data/gui/hvindustryup.xml
 msgid "You have reached the tech level which enables you to build heavy industry (steel works). Heavy industry produces steel. "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir ind?strias grandes (oficina de a?o). Ind?strias grandes produzem a?o."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir ind?strias pesadas (sider?rgicas). Ind?strias pesadas produzem a?o."
 
 #: data/gui/ltindustryup.xml
 msgid "You have reached the tech level which enables you to build light industry. Light industry produces goods. "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir ind?strias pequenas. Ind?strias pequenas produzem bens."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir ind?strias leves. Ind?strias leves produzem bens."
 
 #: data/gui/millup.xml
 msgid "You have reached the tech level which enables you to build mills. Mills use jobs and food to make goods. Watch out, they can use a lot of food! "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir moinhos. Moinhos utilizam trabalho e comida para produzir bens. Aten?ao, eles podem utilizar bastante alimentos!"
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir moinhos. Moinhos utilizam produ??o e alimento para produzir bens. Aten?ao, eles podem utilizar bastante alimentos!"
 
 #: data/gui/mod_wind_up.xml
 msgid "You have reached the tech level which enables you to build modern, more efficient, windmills. "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir modernos, mais eficientes, moinhos de vento."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir modernos, e mais eficientes, moinhos de vento."
 
 #: data/gui/parkup.xml
 msgid "You have reached the tech level which enables you to build parks. Parks are used to absorb pollution. "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir parques. Parques s?o utilizados para absorver a polui??o."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir parques. Parques s?o utilizados para absorver a polui??o."
 
 #: data/gui/potteryup.xml
 msgid "You have reached the tech level which enables you to build potteries. Potteries use jobs and ore to make goods. (You need ore mines to get ore) "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir olarias. Olarias utilizam trabalho e min?rio para produzir bens. (Voc? necessita de minas para conseguir os min?rios)"
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir olarias. Olarias utilizam produ??o e min?rio para produzir bens. (Voc? necessita de minas para conseguir os min?rios)"
 
 #: data/gui/railwayup.xml
 msgid "You have reached the tech level which enables you to build railways. "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir estradas de ferro."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir estradas de ferro."
 
 #: data/gui/riverup.xml
 msgid "You have reached the tech level which enables you to build rivers. "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir rios."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir rios."
 
 #: data/gui/roadup.xml
 msgid "You have reached the tech level which enables you to build roads. See the help screen for more information."
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir estradas. Veja a tela de ajuda para maiores informa??es."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir estradas. Veja a tela de ajuda para maiores informa??es."
 
 #: data/gui/rocketup.xml
 msgid "You have reached the tech level which enables you to build rocket launch pads. Rockets enable you to evacuate your population and is a way to 'win' the game."
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir ?reas de lan?amentos de foguetes. Foguetes habilitam voc? a evacuar sua popula??o e ? um meio de 'ganhar' o jogo."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir bases de lan?amentos. Foguetes habilitam voc? a evacuar sua popula??o e ? um meio de 'ganhar' o jogo."
 
 #: data/gui/schoolup.xml
 msgid "You have reached the tech level which enables you to build schools. Schools use jobs and goods to increase tech level. "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir escolas. Escolas utilizam trabalho e bens para aumentar o n?vel tecnologico."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir escolas. Escolas utilizam produ??o e bens para aumentar o n?vel tecnol?gico."
 
 #: data/gui/solarpowerup.xml
 msgid "You have reached the tech level which enables you to build solar power stations. "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir usinas de energia solar."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir usinas el?tricas solares."
 
 #: data/gui/universityup.xml
 msgid "You have reached the tech level which enables you to build universities. Universities produces PhDs, which produce more technology. "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir universidades. Universidades produzem PhDs, que produzem mais tecnologia."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir universidades. Universidades produzem PhDs, que produzem mais tecnologia."
 
 #: data/gui/windmillup.xml
 msgid "You have reached the tech level which enables you to build windmills. "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a construir moinhos de vento."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir moinhos de vento."
 
 #: data/gui/coalmineup.xml
 msgid "You have reached the tech level which enables you to dig deep coal mines."
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a cavar profundamente as minas de carv?o."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a cavar profundamente nas minas de carv?o."
 
 #: data/gui/recycleup.xml
 msgid "You have reached the tech level which enables you to recycling centres. Recycling centres recycle used goods back into ore. "
-msgstr "Voc? alcan?ou o n?vel tecnologico que habilita a reciclar os centros. Reciclagem dos centros recicla bens utilizados em min?rios."
+msgstr "Voc? alcan?ou o n?vel tecnol?gico que habilita a construir centros de reciclagem. Centros de reciclagem transformam bens usados em min?rios."
 
 #: data/gui/launch-gone.xml data/gui/sustain.xml
 msgid "You have won the game."
@@ -635,7 +635,7 @@
 
 #: data/gui/cricketup.xml
 msgid "Your people have invented basketball. Basketball Courts use a few jobs and goods and make people in the surrounding areas (about 10 units in each direction) happier."
-msgstr "Seus habitantes inventaram o basquete. As quadras de basquete utilizam um pouco de trabalho e bens e fazem as pessoas ao redor (mais ou menos 10 pessoas em cada dire??o) mais felizes."
+msgstr "Seus habitantes inventaram o basquete. As quadras de basquete utilizam um pouca produ??o e bens e fazem as pessoas ao redor (mais ou menos 10 pessoas em cada dire??o) mais felizes."
 
 #: data/gui/launch-fail.xml
 msgid "Your rocket crashed shortly after launch. People no longer trust the technology for evacuation. You must launch five more unmanned rockets to restore confidence."

Modified: trunk/data/locale/pt_BR.po
===================================================================
--- trunk/data/locale/pt_BR.po	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/data/locale/pt_BR.po	2007-05-15 16:46:52 UTC (rev 1219)
@@ -9,7 +9,7 @@
 "Project-Id-Version: lincity-ng 1.1.0rc2\n"
 "Report-Msgid-Bugs-To: \n"
 "POT-Creation-Date: 2007-01-27 22:03+0100\n"
-"PO-Revision-Date: 2007-01-29 14:56-0300\n"
+"PO-Revision-Date: 2007-05-10 19:34-0300\n"
 "Last-Translator: Jose Carlos Medeiros <jose at psabs.com.br>\n"
 "Language-Team: Portuguese/Brazil <gnome-l10n-br at listas.cipsga.org.br>\n"
 "MIME-Version: 1.0\n"
@@ -64,11 +64,11 @@
 
 #: src/lincity/engine.cpp:691
 msgid "It's at a power line."
-msgstr "Isto ? uma linha de transmiss?o de for?a."
+msgstr "Isto ? uma linha de transmiss?o."
 
 #: src/lincity/engine.cpp:693
 msgid "It's at a solar power station."
-msgstr "Esta ? uma usina de energia solar."
+msgstr "Esta ? uma usina el?trica solar."
 
 #: src/lincity/engine.cpp:695
 msgid "It's at a substation."
@@ -96,11 +96,11 @@
 
 #: src/lincity/engine.cpp:707
 msgid "It's at a railway."
-msgstr "Isto ? uma via f?rrea."
+msgstr "Isto ? uma estrada de ferro."
 
 #: src/lincity/engine.cpp:709
 msgid "It's at a coal power station."
-msgstr "Isto ? uma usina de carv?o."
+msgstr "Isto ? uma usina el?trica carvoeira."
 
 #: src/lincity/engine.cpp:711
 msgid "It's at a road."
@@ -108,7 +108,7 @@
 
 #: src/lincity/engine.cpp:713
 msgid "It's at light industry."
-msgstr "Isto ? uma ind?stria pequena."
+msgstr "Isto ? uma ind?stria leve."
 
 #: src/lincity/engine.cpp:715
 msgid "It's at a university."
@@ -128,7 +128,7 @@
 
 #: src/lincity/engine.cpp:723
 msgid "It's at a steel works."
-msgstr "Isto ? uma oficina de a?o."
+msgstr "Isto ? uma sider?rgica."
 
 #: src/lincity/engine.cpp:725
 msgid "It's at a recycle centre."
@@ -136,11 +136,11 @@
 
 #: src/lincity/engine.cpp:727
 msgid "It's at a health centre."
-msgstr "Isto ? um centro de sa?de."
+msgstr "Isto ? um hospital."
 
 #: src/lincity/engine.cpp:729
 msgid "It's at a rocket site."
-msgstr "Isto ? uma ?rea de lan?amento."
+msgstr "Isto ? uma base de lan?amento."
 
 #: src/lincity/engine.cpp:731
 msgid "It's at a windmill."
@@ -164,11 +164,11 @@
 
 #: src/lincity/engine.cpp:741
 msgid "It's at a fire station!!!."
-msgstr "Isto ? um corpo de bombeiros!!!"
+msgstr "Isto ? um corpo de bombeiros!!!."
 
 #: src/lincity/engine.cpp:743
 msgid "It's at a sports field!!!."
-msgstr "Isto ? uma linha de transmiss?o de for?a!!!"
+msgstr "Isto ? uma ?rea de esportes!!!."
 
 #: src/lincity/engine.cpp:745
 msgid "It's at a shanty town."
@@ -189,7 +189,7 @@
 
 #: src/lincity/ldsvguts.cpp:134
 msgid "Saving scene"
-msgstr "Salvando cena"
+msgstr "Salvando cen?rio"
 
 #: src/lincity/ldsvguts.cpp:334
 #, c-format
@@ -198,7 +198,7 @@
 
 #: src/lincity/ldsvguts.cpp:352
 msgid "Loading scene"
-msgstr "Abrindo a cena"
+msgstr "Abrindo o cen?rio"
 
 #: src/lincity/lintypes.cpp:22
 msgid "Empty"
@@ -206,7 +206,7 @@
 
 #: src/lincity/lintypes.cpp:34
 msgid "Power line"
-msgstr "Linha de transmiss?o de for?a"
+msgstr "Linha de transmiss?o"
 
 #: src/lincity/lintypes.cpp:46
 msgid "Solar PS"
@@ -242,7 +242,7 @@
 
 #: src/lincity/lintypes.cpp:130
 msgid "Railway"
-msgstr "Via F?rrea"
+msgstr "Estrada de ferro"
 
 #: src/lincity/lintypes.cpp:142
 msgid "Coal PS"
@@ -255,7 +255,7 @@
 
 #: src/lincity/lintypes.cpp:166
 msgid "Lt. Industry"
-msgstr "Ind?stria peq."
+msgstr "Ind?stria leve"
 
 #: src/lincity/lintypes.cpp:178
 #: src/lincity/modules/university.cpp:67
@@ -273,7 +273,7 @@
 
 #: src/lincity/lintypes.cpp:214
 msgid "Rubbish tip"
-msgstr "Aterro"
+msgstr "Aterro de lixo"
 
 #: src/lincity/lintypes.cpp:226
 #: src/lincity/modules/port.cpp:173
@@ -283,7 +283,7 @@
 
 #: src/lincity/lintypes.cpp:238
 msgid "Hv. Industry"
-msgstr "Ind?stria grd"
+msgstr "Ind?stria pesada"
 
 #: src/lincity/lintypes.cpp:250
 msgid "Park"
@@ -292,7 +292,7 @@
 #: src/lincity/lintypes.cpp:262
 #: src/lincity-ng/MpsInterface.cpp:516
 msgid "Recycle"
-msgstr "Reciclagem"
+msgstr "Centro de reciclagem"
 
 #: src/lincity/lintypes.cpp:274
 #: src/lincity/modules/water.cpp:19
@@ -301,11 +301,11 @@
 
 #: src/lincity/lintypes.cpp:286
 msgid "Health centre"
-msgstr "Centro de sa?de"
+msgstr "Hospital"
 
 #: src/lincity/lintypes.cpp:298
 msgid "Rocket pad"
-msgstr "?rea de lan?amento"
+msgstr "Base de lan?amento"
 
 #: src/lincity/lintypes.cpp:310
 #: src/lincity/modules/windmill.cpp:73
@@ -335,7 +335,7 @@
 #: src/lincity/lintypes.cpp:370
 #: src/lincity/modules/pottery.cpp:119
 msgid "Pottery"
-msgstr "Cer?mica"
+msgstr "Olaria"
 
 #: src/lincity/lintypes.cpp:382
 msgid "Fire sta'n"
@@ -348,7 +348,7 @@
 
 #: src/lincity/lintypes.cpp:407
 msgid "Burnt"
-msgstr "Queimat?rio"
+msgstr "Queimado"
 
 #: src/lincity/lintypes.cpp:420
 msgid "Shanty town"
@@ -435,7 +435,7 @@
 
 #: src/lincity/modules/health_centre.cpp:66
 msgid "Health Centre"
-msgstr "Centro de Sa?de"
+msgstr "Hospital"
 
 #: src/lincity/modules/health_centre.cpp:68
 #: src/lincity/modules/rocket_pad.cpp:169
@@ -463,7 +463,7 @@
 #: src/lincity/modules/firestation.cpp:122
 #: src/lincity/modules/school.cpp:55
 msgid "Jobs"
-msgstr "Trabalhos"
+msgstr "Produ??o"
 
 #: src/lincity/modules/health_centre.cpp:71
 #: src/lincity/modules/rocket_pad.cpp:172
@@ -485,7 +485,7 @@
 
 #: src/lincity/modules/rocket_pad.cpp:163
 msgid "Rocket Pad"
-msgstr "?rea do lan?amento"
+msgstr "Base do lan?amento"
 
 #: src/lincity/modules/rocket_pad.cpp:166
 msgid "Completion"
@@ -704,15 +704,15 @@
 
 #: src/lincity/modules/residence.cpp:299
 msgid "poor"
-msgstr "pobres"
+msgstr "pobre"
 
 #: src/lincity/modules/residence.cpp:300
 msgid "Job"
-msgstr "Trabalho"
+msgstr "Produ??o"
 
 #: src/lincity/modules/monument.cpp:63
 msgid "Wisdom Bestowed"
-msgstr "Reconhecimento adquirido"
+msgstr "Reconhecimento Adquirido"
 
 #: src/lincity/modules/monument.cpp:67
 #, c-format
@@ -766,7 +766,7 @@
 #: src/lincity/modules/mill.cpp:110
 #: src/lincity/modules/track.cpp:41
 msgid "Food"
-msgstr "Comida"
+msgstr "Alimento"
 
 #: src/lincity/modules/port.cpp:198
 #: src/lincity-ng/MpsInterface.cpp:532
@@ -810,7 +810,7 @@
 
 #: src/lincity/modules/light_industry.cpp:354
 msgid "Light"
-msgstr "Pequena"
+msgstr "Leve"
 
 #: src/lincity/modules/university.cpp:69
 msgid "Tech Produced"
@@ -843,7 +843,7 @@
 
 #: src/lincity/modules/firestation.cpp:119
 msgid "Fire Station"
-msgstr "Corpo de Bombeiros"
+msgstr "Bombeiro"
 
 #: src/lincity/modules/organic_farm.cpp:183
 msgid "Organic Farm"
@@ -867,7 +867,7 @@
 
 #: src/lincity-ng/Dialog.cpp:173
 msgid "Launchsite"
-msgstr "Terreno Inicial"
+msgstr "?rea da base"
 
 #: src/lincity-ng/Dialog.cpp:341
 #: src/lincity-ng/Dialog.cpp:342
@@ -882,7 +882,7 @@
 #: src/lincity-ng/Dialog.cpp:348
 #, c-format
 msgid "Initial loaded scene - %s"
-msgstr "Cena inicial aberta - %s"
+msgstr "Cen?rio inicial aberto - %s"
 
 #: src/lincity-ng/Dialog.cpp:353
 #, c-format
@@ -892,7 +892,7 @@
 #: src/lincity-ng/Dialog.cpp:357
 #, c-format
 msgid "Population  %d  of which  %d  are not housed."
-msgstr "A popula??o ? de  %d  dos quais  %d  s?o sem teto."
+msgstr "A popula??o ? de  %d  dos quais  %d  s?o desabrigados."
 
 #: src/lincity-ng/Dialog.cpp:362
 #, c-format
@@ -902,7 +902,7 @@
 #: src/lincity-ng/Dialog.cpp:367
 #, c-format
 msgid "Date %s %04d  Money %8d   Tech-level %5.1f (%5.1f)"
-msgstr "Data %s %04d  Dinheiro %8d  N?vel Tecnologico %5.1f (%5.1f)"
+msgstr "Data %s %04d  Dinheiro %8d  N?vel tecnol?gico %5.1f (%5.1f)"
 
 #: src/lincity-ng/Dialog.cpp:374
 #, c-format
@@ -967,16 +967,16 @@
 #: src/lincity-ng/Dialog.cpp:444
 #, c-format
 msgid ".   Light inds %4d      Heavy inds %4d        Recyclers %4d"
-msgstr ".    Ind?stias peq %4d      Ind?strias grd %4d  Centros de reciclagem %4d"
+msgstr ".    Ind?strias lev %4d      Ind?strias pes %4d  Centros de reciclagem %4d"
 
 #: src/lincity-ng/Dialog.cpp:449
 #, c-format
 msgid "Health centres %4d            Tips %4d         Shanties %4d"
-msgstr "Centros de sa?de %4d         Aterros %4d         Favelas %4d"
+msgstr "Hospitais %4d         Aterros %4d         Favelas %4d"
 
 #: src/lincity-ng/GameView.cpp:236
 msgid "Minimap: outline map"
-msgstr "Minimapa: mapa do esbo?o"
+msgstr "Mini-mapa: mapa do esbo?o"
 
 #: src/lincity-ng/GameView.cpp:239
 msgid "Minimap: unemployment"
@@ -992,7 +992,7 @@
 
 #: src/lincity-ng/GameView.cpp:248
 msgid "Minimap: power supply"
-msgstr "Minimapa: Linha de transmiss?o"
+msgstr "Minimapa: linha de transmiss?o"
 
 #: src/lincity-ng/GameView.cpp:251
 msgid "Minimap: firedepartment cover"
@@ -1008,7 +1008,7 @@
 
 #: src/lincity-ng/GameView.cpp:260
 msgid "Minimap: coal depots"
-msgstr "Minimapa: Dep?sitos de carv?o"
+msgstr "Minimapa: dep?sitos de carv?o"
 
 #: src/lincity-ng/GameView.cpp:263
 msgid "Minimap: traffic density"
@@ -1016,11 +1016,11 @@
 
 #: src/lincity-ng/GameView.cpp:1515
 msgid "Estimated Bulldoze Cost: "
-msgstr "Custo Estimado de Destrui??o:"
+msgstr "Custo Estimado de Demoli??o:"
 
 #: src/lincity-ng/GameView.cpp:1517
 msgid "Bulldoze Cost: "
-msgstr "Custo de Destrui??o:"
+msgstr "Custo de Demoli??o:"
 
 #: src/lincity-ng/GameView.cpp:1520
 #: src/lincity-ng/GameView.cpp:1551
@@ -1038,15 +1038,15 @@
 
 #: src/lincity-ng/GameView.cpp:1544
 msgid "Bulldozer: remove building -price varies-"
-msgstr "Niveladora: remover contru??o -valor vari?vel-"
+msgstr "Demolidora: remover contru??o -valor vari?vel-"
 
 #: src/lincity-ng/GameView.cpp:1551
 msgid ": Cost to build "
-msgstr ": Custo de contru??o "
+msgstr ": Custo de constru??o "
 
 #: src/lincity-ng/GameView.cpp:1552
 msgid ", to bulldoze "
-msgstr ", para destruir "
+msgstr ", para demolir "
 
 #: src/lincity-ng/GameView.cpp:1552
 #: src/lincity-ng/GameView.cpp:1555
@@ -1119,7 +1119,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:412
 msgid "Bulldoze Cost"
-msgstr "Destruir Custa"
+msgstr "Demolir Custa"
 
 #: src/lincity-ng/MpsInterface.cpp:418
 msgid "N/A"
@@ -1131,7 +1131,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:440
 msgid "Income"
-msgstr "Rendimento"
+msgstr "Receita"
 
 #: src/lincity-ng/MpsInterface.cpp:452
 msgid "Export"
@@ -1139,7 +1139,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:456
 msgid "Expenses"
-msgstr "Gastos"
+msgstr "Despesas"
 
 #: src/lincity-ng/MpsInterface.cpp:460
 msgid "Unemp."
@@ -1147,7 +1147,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:464
 msgid "Transport"
-msgstr "Transportador"
+msgstr "Transporte"
 
 #: src/lincity-ng/MpsInterface.cpp:468
 msgid "Imports"
@@ -1179,7 +1179,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:502
 msgid "Univers."
-msgstr "Universidades"
+msgstr "Univer."
 
 #: src/lincity-ng/MpsInterface.cpp:504
 msgid "Deaths"
@@ -1215,7 +1215,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:536
 msgid "Unn Dths"
-msgstr "Unn Dths"
+msgstr "Mort. Desc."
 
 #: src/lincity-ng/MpsInterface.cpp:537
 msgid "Unemployment"
@@ -1236,7 +1236,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:542
 msgid "Cases"
-msgstr "Acontecimentos"
+msgstr "Casos"
 
 #: src/lincity-ng/EconomyGraph.cpp:121
 msgid "Mining"
@@ -1280,7 +1280,7 @@
 
 #: src/lincity-ng/ButtonPanel.cpp:199
 msgid "Bulldozer"
-msgstr "Niveladora"
+msgstr "Demolidor"
 
 #: src/lincity-ng/ButtonPanel.cpp:201
 msgid "Residential: 50 denizens, low birthrate, high deathrate"

Modified: trunk/src/lincity-ng/PbarInterface.cpp
===================================================================
--- trunk/src/lincity-ng/PbarInterface.cpp	2007-05-12 19:59:30 UTC (rev 1218)
+++ trunk/src/lincity-ng/PbarInterface.cpp	2007-05-15 16:46:52 UTC (rev 1219)
@@ -31,9 +31,37 @@
 void
 update_pbar (int pbar_num, int value, int month_flag)
 {
-  (void) month_flag;
-  //  TRACE;
-  //  cdebug(pbar_num<<":"<<value<<":"<<month_flag);
+    // copy of update_pbar from src/oldgui/pbar.cpp 
+    // store values for savegame TODO: use them so we have pbars at once 
+    int i;
+
+    struct pbar_st * pbar = &pbars[pbar_num];
+
+    if (month_flag) {
+	pbar->oldtot = pbar->tot;
+
+	/* If the dataset isn't full, just add it and forget month_flag */
+	if (pbar->data_size < PBAR_DATA_SIZE) {
+	    pbar->data_size++;
+	    month_flag = 0;
+	}
+    }
+
+    pbar->tot = 0;
+
+    for (i = 0; i < (pbar->data_size - 1); i++) {
+	if (month_flag) 
+	    pbar->tot += (pbar->data[i] = pbar->data[i+1]);
+	else
+	    pbar->tot += pbar->data[i];
+    }
+
+
+    pbar->tot += pbar->data[i] = value;
+    pbar->diff = pbar->tot - pbar->oldtot;
+
+
+  // new: update bars
   if(LCPBarInstance)
     LCPBarInstance->setValue(pbar_num,value);
 }



From wolfgangb at mail.berlios.de  Sat May 26 01:27:40 2007
From: wolfgangb at mail.berlios.de (wolfgangb at BerliOS)
Date: Sat, 26 May 2007 01:27:40 +0200
Subject: [Lincity-ng-commit] r1220 - trunk/data/locale
Message-ID: <200705252327.l4PNRejI028290@sheep.berlios.de>

Author: wolfgangb
Date: 2007-05-26 01:27:39 +0200 (Sat, 26 May 2007)
New Revision: 1220

Modified:
   trunk/data/locale/pt_BR.po
Log:
Updated pt_BR translation by Jose Carlos Medeiros


Modified: trunk/data/locale/pt_BR.po
===================================================================
--- trunk/data/locale/pt_BR.po	2007-05-15 16:46:52 UTC (rev 1219)
+++ trunk/data/locale/pt_BR.po	2007-05-25 23:27:39 UTC (rev 1220)
@@ -9,7 +9,7 @@
 "Project-Id-Version: lincity-ng 1.1.0rc2\n"
 "Report-Msgid-Bugs-To: \n"
 "POT-Creation-Date: 2007-01-27 22:03+0100\n"
-"PO-Revision-Date: 2007-05-10 19:34-0300\n"
+"PO-Revision-Date: 2007-01-29 14:56-0300\n"
 "Last-Translator: Jose Carlos Medeiros <jose at psabs.com.br>\n"
 "Language-Team: Portuguese/Brazil <gnome-l10n-br at listas.cipsga.org.br>\n"
 "MIME-Version: 1.0\n"
@@ -45,7 +45,7 @@
 #: src/lincity/engine.cpp:158
 #: src/lincity/engine.cpp:189
 msgid "This area was once a landfill"
-msgstr "Este lugar tinha apenas um monte de lixo"
+msgstr "Este lugar foi antes um aterro"
 
 #: src/lincity/engine.cpp:159
 #: src/lincity/engine.cpp:190
@@ -64,11 +64,11 @@
 
 #: src/lincity/engine.cpp:691
 msgid "It's at a power line."
-msgstr "Isto ? uma linha de transmiss?o."
+msgstr "Isto ? uma linha de transmiss?o de energia."
 
 #: src/lincity/engine.cpp:693
 msgid "It's at a solar power station."
-msgstr "Esta ? uma usina el?trica solar."
+msgstr "Esta ? uma usina de energia solar."
 
 #: src/lincity/engine.cpp:695
 msgid "It's at a substation."
@@ -96,11 +96,11 @@
 
 #: src/lincity/engine.cpp:707
 msgid "It's at a railway."
-msgstr "Isto ? uma estrada de ferro."
+msgstr "Isto ? uma via f?rrea."
 
 #: src/lincity/engine.cpp:709
 msgid "It's at a coal power station."
-msgstr "Isto ? uma usina el?trica carvoeira."
+msgstr "Isto ? uma usina de for?a a carv?o."
 
 #: src/lincity/engine.cpp:711
 msgid "It's at a road."
@@ -128,7 +128,7 @@
 
 #: src/lincity/engine.cpp:723
 msgid "It's at a steel works."
-msgstr "Isto ? uma sider?rgica."
+msgstr "Isto ? uma oficina de a?o."
 
 #: src/lincity/engine.cpp:725
 msgid "It's at a recycle centre."
@@ -136,11 +136,11 @@
 
 #: src/lincity/engine.cpp:727
 msgid "It's at a health centre."
-msgstr "Isto ? um hospital."
+msgstr "Isto ? um centro de sa?de."
 
 #: src/lincity/engine.cpp:729
 msgid "It's at a rocket site."
-msgstr "Isto ? uma base de lan?amento."
+msgstr "Isto ? uma ?rea de lan?amento de foguetes."
 
 #: src/lincity/engine.cpp:731
 msgid "It's at a windmill."
@@ -164,11 +164,11 @@
 
 #: src/lincity/engine.cpp:741
 msgid "It's at a fire station!!!."
-msgstr "Isto ? um corpo de bombeiros!!!."
+msgstr "Isto ? um corpo de bombeiros!!!"
 
 #: src/lincity/engine.cpp:743
 msgid "It's at a sports field!!!."
-msgstr "Isto ? uma ?rea de esportes!!!."
+msgstr "Isto ? uma quadra de esportes!!!"
 
 #: src/lincity/engine.cpp:745
 msgid "It's at a shanty town."
@@ -189,7 +189,7 @@
 
 #: src/lincity/ldsvguts.cpp:134
 msgid "Saving scene"
-msgstr "Salvando cen?rio"
+msgstr "Salvando cena"
 
 #: src/lincity/ldsvguts.cpp:334
 #, c-format
@@ -198,7 +198,7 @@
 
 #: src/lincity/ldsvguts.cpp:352
 msgid "Loading scene"
-msgstr "Abrindo o cen?rio"
+msgstr "Abrindo a cena"
 
 #: src/lincity/lintypes.cpp:22
 msgid "Empty"
@@ -206,11 +206,11 @@
 
 #: src/lincity/lintypes.cpp:34
 msgid "Power line"
-msgstr "Linha de transmiss?o"
+msgstr "Linha de transmiss?o de energia"
 
 #: src/lincity/lintypes.cpp:46
 msgid "Solar PS"
-msgstr "Solar PS"
+msgstr "EE Solar"
 
 #: src/lincity/lintypes.cpp:58
 #: src/lincity/modules/substation.cpp:91
@@ -242,11 +242,11 @@
 
 #: src/lincity/lintypes.cpp:130
 msgid "Railway"
-msgstr "Estrada de ferro"
+msgstr "Via F?rrea"
 
 #: src/lincity/lintypes.cpp:142
 msgid "Coal PS"
-msgstr "Carv?o PS"
+msgstr "EE a Carv?o"
 
 #: src/lincity/lintypes.cpp:154
 #: src/lincity/modules/road.cpp:47
@@ -273,7 +273,7 @@
 
 #: src/lincity/lintypes.cpp:214
 msgid "Rubbish tip"
-msgstr "Aterro de lixo"
+msgstr "Aterro"
 
 #: src/lincity/lintypes.cpp:226
 #: src/lincity/modules/port.cpp:173
@@ -292,7 +292,7 @@
 #: src/lincity/lintypes.cpp:262
 #: src/lincity-ng/MpsInterface.cpp:516
 msgid "Recycle"
-msgstr "Centro de reciclagem"
+msgstr "Reciclagem"
 
 #: src/lincity/lintypes.cpp:274
 #: src/lincity/modules/water.cpp:19
@@ -301,11 +301,11 @@
 
 #: src/lincity/lintypes.cpp:286
 msgid "Health centre"
-msgstr "Hospital"
+msgstr "Centro de sa?de"
 
 #: src/lincity/lintypes.cpp:298
 msgid "Rocket pad"
-msgstr "Base de lan?amento"
+msgstr "?rea de lan?amento"
 
 #: src/lincity/lintypes.cpp:310
 #: src/lincity/modules/windmill.cpp:73
@@ -335,7 +335,7 @@
 #: src/lincity/lintypes.cpp:370
 #: src/lincity/modules/pottery.cpp:119
 msgid "Pottery"
-msgstr "Olaria"
+msgstr "Cer?mica"
 
 #: src/lincity/lintypes.cpp:382
 msgid "Fire sta'n"
@@ -344,11 +344,11 @@
 #: src/lincity/lintypes.cpp:394
 #: src/lincity/modules/cricket.cpp:99
 msgid "Sports field"
-msgstr "?rea de esportes"
+msgstr "Quadra de esportes"
 
 #: src/lincity/lintypes.cpp:407
 msgid "Burnt"
-msgstr "Queimado"
+msgstr "Escombros"
 
 #: src/lincity/lintypes.cpp:420
 msgid "Shanty town"
@@ -435,7 +435,7 @@
 
 #: src/lincity/modules/health_centre.cpp:66
 msgid "Health Centre"
-msgstr "Hospital"
+msgstr "Centro de Sa?de"
 
 #: src/lincity/modules/health_centre.cpp:68
 #: src/lincity/modules/rocket_pad.cpp:169
@@ -463,7 +463,7 @@
 #: src/lincity/modules/firestation.cpp:122
 #: src/lincity/modules/school.cpp:55
 msgid "Jobs"
-msgstr "Produ??o"
+msgstr "Trabalhos"
 
 #: src/lincity/modules/health_centre.cpp:71
 #: src/lincity/modules/rocket_pad.cpp:172
@@ -485,7 +485,7 @@
 
 #: src/lincity/modules/rocket_pad.cpp:163
 msgid "Rocket Pad"
-msgstr "Base do lan?amento"
+msgstr "?rea do lan?amento"
 
 #: src/lincity/modules/rocket_pad.cpp:166
 msgid "Completion"
@@ -528,7 +528,7 @@
 #: src/lincity/modules/windmill.cpp:92
 #: src/lincity/modules/substation.cpp:99
 msgid "Grid Status"
-msgstr "Status da Grade"
+msgstr "Status da Rede"
 
 #: src/lincity/modules/windmill.cpp:95
 #: src/lincity/modules/substation.cpp:102
@@ -546,7 +546,7 @@
 #: src/lincity/modules/power_line.cpp:53
 #: src/lincity/modules/solar_power.cpp:60
 msgid "Grid ID"
-msgstr "Grade ID"
+msgstr "ID de Rede"
 
 #: src/lincity/modules/water.cpp:22
 #: src/lincity/modules/commune.cpp:151
@@ -580,7 +580,7 @@
 
 #: src/lincity/modules/recycle.cpp:170
 msgid "Center"
-msgstr "Centrar"
+msgstr "Centralizar"
 
 #: src/lincity/modules/recycle.cpp:173
 #: src/lincity/modules/heavy_industry.cpp:346
@@ -704,15 +704,15 @@
 
 #: src/lincity/modules/residence.cpp:299
 msgid "poor"
-msgstr "pobre"
+msgstr "pobres"
 
 #: src/lincity/modules/residence.cpp:300
 msgid "Job"
-msgstr "Produ??o"
+msgstr "Trabalho"
 
 #: src/lincity/modules/monument.cpp:63
 msgid "Wisdom Bestowed"
-msgstr "Reconhecimento Adquirido"
+msgstr "Reconhecimento adquirido"
 
 #: src/lincity/modules/monument.cpp:67
 #, c-format
@@ -721,7 +721,7 @@
 
 #: src/lincity/modules/heavy_industry.cpp:323
 msgid "Heavy"
-msgstr "Grande"
+msgstr "Pesada"
 
 #: src/lincity/modules/heavy_industry.cpp:324
 #: src/lincity/modules/light_industry.cpp:355
@@ -747,7 +747,7 @@
 
 #: src/lincity/modules/heavy_industry.cpp:331
 msgid "Grid"
-msgstr "Grade"
+msgstr "Rede"
 
 #: src/lincity/modules/heavy_industry.cpp:339
 #: src/lincity/modules/light_industry.cpp:362
@@ -766,7 +766,7 @@
 #: src/lincity/modules/mill.cpp:110
 #: src/lincity/modules/track.cpp:41
 msgid "Food"
-msgstr "Alimento"
+msgstr "Comida"
 
 #: src/lincity/modules/port.cpp:198
 #: src/lincity-ng/MpsInterface.cpp:532
@@ -826,7 +826,7 @@
 
 #: src/lincity/modules/tip.cpp:113
 msgid "Tons"
-msgstr "Tons"
+msgstr "Toneladas"
 
 #: src/lincity/modules/tip.cpp:114
 msgid "Percent"
@@ -835,7 +835,7 @@
 #: src/lincity/modules/tip.cpp:117
 #, c-format
 msgid "% Filled"
-msgstr "% FCompleto"
+msgstr "% Completo"
 
 #: src/lincity/modules/commune.cpp:149
 msgid "Activity"
@@ -843,7 +843,7 @@
 
 #: src/lincity/modules/firestation.cpp:119
 msgid "Fire Station"
-msgstr "Bombeiro"
+msgstr "Corpo de Bombeiros"
 
 #: src/lincity/modules/organic_farm.cpp:183
 msgid "Organic Farm"
@@ -867,12 +867,12 @@
 
 #: src/lincity-ng/Dialog.cpp:173
 msgid "Launchsite"
-msgstr "?rea da base"
+msgstr "Terreno Inicial"
 
 #: src/lincity-ng/Dialog.cpp:341
 #: src/lincity-ng/Dialog.cpp:342
 msgid "----- IN TEST MODE -------"
-msgstr "----- NO MODO TESTE -------"
+msgstr "----- EM MODO TESTE -------"
 
 #: src/lincity-ng/Dialog.cpp:344
 #, c-format
@@ -882,7 +882,7 @@
 #: src/lincity-ng/Dialog.cpp:348
 #, c-format
 msgid "Initial loaded scene - %s"
-msgstr "Cen?rio inicial aberto - %s"
+msgstr "Cena inicial aberta - %s"
 
 #: src/lincity-ng/Dialog.cpp:353
 #, c-format
@@ -892,7 +892,7 @@
 #: src/lincity-ng/Dialog.cpp:357
 #, c-format
 msgid "Population  %d  of which  %d  are not housed."
-msgstr "A popula??o ? de  %d  dos quais  %d  s?o desabrigados."
+msgstr "A popula??o ? de  %d  dos quais  %d  s?o sem teto."
 
 #: src/lincity-ng/Dialog.cpp:362
 #, c-format
@@ -902,7 +902,7 @@
 #: src/lincity-ng/Dialog.cpp:367
 #, c-format
 msgid "Date %s %04d  Money %8d   Tech-level %5.1f (%5.1f)"
-msgstr "Data %s %04d  Dinheiro %8d  N?vel tecnol?gico %5.1f (%5.1f)"
+msgstr "Data %s %04d  Dinheiro %8d  N?vel Tecnologico %5.1f (%5.1f)"
 
 #: src/lincity-ng/Dialog.cpp:374
 #, c-format
@@ -947,7 +947,7 @@
 #: src/lincity-ng/Dialog.cpp:423
 #, c-format
 msgid ".Fire stations %4d           Parks %4d    Sports fields %4d"
-msgstr ".Bombeiros %4d            Parques %4d  ?rea de Esporte %4d"
+msgstr ".Bombeiros %4d            Parques %4d  Quadras de Esporte %4d"
 
 #: src/lincity-ng/Dialog.cpp:428
 #, c-format
@@ -967,16 +967,16 @@
 #: src/lincity-ng/Dialog.cpp:444
 #, c-format
 msgid ".   Light inds %4d      Heavy inds %4d        Recyclers %4d"
-msgstr ".    Ind?strias lev %4d      Ind?strias pes %4d  Centros de reciclagem %4d"
+msgstr ".    Ind?stias peq %4d      Ind?strias grd %4d  Centros de reciclagem %4d"
 
 #: src/lincity-ng/Dialog.cpp:449
 #, c-format
 msgid "Health centres %4d            Tips %4d         Shanties %4d"
-msgstr "Hospitais %4d         Aterros %4d         Favelas %4d"
+msgstr "Centros de sa?de %4d         Aterros %4d         Favelas %4d"
 
 #: src/lincity-ng/GameView.cpp:236
 msgid "Minimap: outline map"
-msgstr "Mini-mapa: mapa do esbo?o"
+msgstr "Minimapa: mapa do esbo?o"
 
 #: src/lincity-ng/GameView.cpp:239
 msgid "Minimap: unemployment"
@@ -992,7 +992,7 @@
 
 #: src/lincity-ng/GameView.cpp:248
 msgid "Minimap: power supply"
-msgstr "Minimapa: linha de transmiss?o"
+msgstr "Minimapa: fornecimento de energia"
 
 #: src/lincity-ng/GameView.cpp:251
 msgid "Minimap: firedepartment cover"
@@ -1008,7 +1008,7 @@
 
 #: src/lincity-ng/GameView.cpp:260
 msgid "Minimap: coal depots"
-msgstr "Minimapa: dep?sitos de carv?o"
+msgstr "Minimapa: Dep?sitos de carv?o"
 
 #: src/lincity-ng/GameView.cpp:263
 msgid "Minimap: traffic density"
@@ -1016,11 +1016,11 @@
 
 #: src/lincity-ng/GameView.cpp:1515
 msgid "Estimated Bulldoze Cost: "
-msgstr "Custo Estimado de Demoli??o:"
+msgstr "Custo Estimado de Destrui??o:"
 
 #: src/lincity-ng/GameView.cpp:1517
 msgid "Bulldoze Cost: "
-msgstr "Custo de Demoli??o:"
+msgstr "Custo de Destrui??o:"
 
 #: src/lincity-ng/GameView.cpp:1520
 #: src/lincity-ng/GameView.cpp:1551
@@ -1038,15 +1038,15 @@
 
 #: src/lincity-ng/GameView.cpp:1544
 msgid "Bulldozer: remove building -price varies-"
-msgstr "Demolidora: remover contru??o -valor vari?vel-"
+msgstr "Niveladora: remover contru??o -valor vari?vel-"
 
 #: src/lincity-ng/GameView.cpp:1551
 msgid ": Cost to build "
-msgstr ": Custo de constru??o "
+msgstr ": Custo de contru??o "
 
 #: src/lincity-ng/GameView.cpp:1552
 msgid ", to bulldoze "
-msgstr ", para demolir "
+msgstr ", para destruir "
 
 #: src/lincity-ng/GameView.cpp:1552
 #: src/lincity-ng/GameView.cpp:1555
@@ -1119,7 +1119,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:412
 msgid "Bulldoze Cost"
-msgstr "Demolir Custa"
+msgstr "Destruir Custa"
 
 #: src/lincity-ng/MpsInterface.cpp:418
 msgid "N/A"
@@ -1131,7 +1131,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:440
 msgid "Income"
-msgstr "Receita"
+msgstr "Rendimento"
 
 #: src/lincity-ng/MpsInterface.cpp:452
 msgid "Export"
@@ -1139,7 +1139,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:456
 msgid "Expenses"
-msgstr "Despesas"
+msgstr "Gastos"
 
 #: src/lincity-ng/MpsInterface.cpp:460
 msgid "Unemp."
@@ -1147,7 +1147,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:464
 msgid "Transport"
-msgstr "Transporte"
+msgstr "Transportador"
 
 #: src/lincity-ng/MpsInterface.cpp:468
 msgid "Imports"
@@ -1159,7 +1159,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:477
 msgid "Net"
-msgstr "Rede"
+msgstr "L?quido"
 
 #: src/lincity-ng/MpsInterface.cpp:489
 msgid "Other Costs"
@@ -1171,7 +1171,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:498
 msgid "Interest"
-msgstr "Interesse"
+msgstr "J?ros"
 
 #: src/lincity-ng/MpsInterface.cpp:500
 msgid "Schools"
@@ -1179,7 +1179,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:502
 msgid "Univers."
-msgstr "Univer."
+msgstr "Universidades"
 
 #: src/lincity-ng/MpsInterface.cpp:504
 msgid "Deaths"
@@ -1215,7 +1215,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:536
 msgid "Unn Dths"
-msgstr "Mort. Desc."
+msgstr "Unn Dths"
 
 #: src/lincity-ng/MpsInterface.cpp:537
 msgid "Unemployment"
@@ -1236,7 +1236,7 @@
 
 #: src/lincity-ng/MpsInterface.cpp:542
 msgid "Cases"
-msgstr "Casos"
+msgstr "Acontecimentos"
 
 #: src/lincity-ng/EconomyGraph.cpp:121
 msgid "Mining"
@@ -1280,7 +1280,7 @@
 
 #: src/lincity-ng/ButtonPanel.cpp:199
 msgid "Bulldozer"
-msgstr "Demolidor"
+msgstr "Niveladora"
 
 #: src/lincity-ng/ButtonPanel.cpp:201
 msgid "Residential: 50 denizens, low birthrate, high deathrate"
@@ -1308,13 +1308,13 @@
 
 #: src/lincity-ng/ButtonPanel.cpp:215
 msgid " [Click right for help.]"
-msgstr " [Clique com o direito para ajuda.]"
+msgstr " [Clique com o bot?o direito para ajuda.]"
 
 #: src/lincity-ng/ButtonPanel.cpp:243
 #: src/lincity-ng/ButtonPanel.cpp:277
 #, c-format
 msgid "%s (Techlevel %.1f required.)"
-msgstr "%s (N?vel Tecn. %.1f requerido.)"
+msgstr "%s (N?vel Tecno. %.1f requerido.)"
 
 #: src/lincity-ng/ScreenInterface.cpp:258
 msgid "MM"



